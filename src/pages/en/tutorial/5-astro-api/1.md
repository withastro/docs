---
layout: ~/layouts/TutorialLayout.astro
title:  Create a blog post archive
setup: |
  import Box from '~/components/tutorial/Box.astro';
  import Checklist from '~/components/Checklist.astro';
  import Goals from '~/components/tutorial/Goals.astro';
  import PreCheck from '~/components/tutorial/PreCheck.astro';
---

Now that you have a few blog posts to link to, let's configure the Blog page to create a list of them automatically!

<PreCheck>
  - Access data from all your posts at once using `Astro.glob()`
  - Display a dynamically generated list of posts on your Blog page
  - Refactor to use a `<BlogPost />` component for each list item
</PreCheck>

## Dynamically display a list of posts

1. Add the following code to `blog.astro` to return information about all your Markdown files. `Astro.glob()` will return an array of objects, one for each blog post.

  ```astro title="src/pages/blog.astro" ins={3}
  ---
  import BaseLayout from '../layouts/BaseLayout.astro'
  const allPosts = await Astro.glob('../pages/posts/*.md');
  title = "My Astro Learning Blog"
  ---
  <BaseLayout title={title}>
    <p>This is where I will post about my journey learning Astro.</p>
    <ul>
      <li><a href="/posts/post-1/">Post 1</a></li>
      <li><a href="/posts/post-2/">Post 2</a></li>
      <li><a href="/posts/post-3/">Post 3</a></li>
    </ul>
  </BaseLayout>
    ```


2. To generate the entire list of posts dynamically, using the post titles and URLs, replace your individual `<li>` tags with the following Astro code:

    ```astro title="src/pages/blog.astro" del={9,10,11} ins={13}
    ---
    import BaseLayout from '../layouts/BaseLayout.astro'
    const allPosts = await Astro.glob('../pages/posts/*.md');
    pageTitle = "My Astro Learning Blog"
    ---
    <BaseLayout pageTitle={pageTitle}>
      <p>This is where I will post about my journey learning Astro.</p>
      <ul>
        <li><a href="/posts/post-1/">Post 1</a></li>
        <li><a href="/posts/post-2/">Post 2</a></li>
        <li><a href="/posts/post-3/">Post 3</a></li>

        {allPosts.map((post) => <li><a href={post.url}>{post.frontmatter.title}</a></li>)}
      </ul>
    </BaseLayout>
    ```

    Your entire list of blog posts is now being generated dynamically, by mapping over the array returned by `Astro.glob()`.

3. Add a new blog post by creating a new `post-4.md` file in `src/pages/posts/` and adding some Markdown content. Be sure to include at least the frontmatter properties used below.

  ```markdown
  ---
  layout: ../../layouts/MarkdownPostLayout.astro
  title: My Fourth Blog Post
  author: Astro Learner
  description: "This post will show up on its own!"
  image: 
    url: "https://astro.build/assets/hero_NkT0b.avif"
    alt: "Earth seen from space."
  pubDate: 2022-08-08
  tags: ["astro", "successes"]
  ---
  This post should show up with my other blog posts automatically, because `Astro.glob()` is returning a list of all my posts in order to create my list.
  ```

4. Revisit your blog page in your browser preview at `localhost:3000/blog` and look for an updated list with four items, including your new blog post!

## Challenge: Create a BlogPost component

Try on your own to make the all necessary changes to your Astro project so that you can instead use the following code to generate your list of blog posts:

```astro title="src/pages/blog.astro" del={2} ins={3}
<ul>
  {allPosts.map((post) => <li><a href={post.url}>{post.frontmatter.title}</a></li>)}
  {allPosts.map((post) => <BlogPost url={post.url} title={post.frontmatter.title} />)}
</ul>
```

<details>
<summary>Expand to see the steps</summary>

1. Create a new component in `src/components/`.

    <details>
    <summary>Show the filename</summary>
    ```
    BlogPost.astro
    ```
    </details>

2. Write the line of code in your component so that it will be able to receive a `title` and `url` as `Astro.props`.

    <details>
    <summary>Show the code</summary>
    ```astro
    ---
    // src/components/BlogPost.astro
    const { title, url } = Astro.props
    ---
    ```
    </details>

3. Add the templating used to create each item in your blog post list.

    <details>
    <summary>Show the code</summary>
    ```astro
    <!-- src/components/BlogPost.astro -->
    <li><a href={url}>{title}</a></li>
    ```
    </details>

4. Import the new component into your Blog page.

    <details>
    <summary>Show the code</summary>
    ```astro title="src/pages/blog.astro" ins={3}
    ---
    import BaseLayout from '../layouts/BaseLayout.astro'
    import BlogPost from '../components/BlogPost.astro'
    const allPosts = await Astro.glob('../pages/posts/*.md');
    pageTitle = "My Astro Learning Blog"
    ---
    ```
    </details>

5. Check Yourself: see the finished component code.

    <details>
    <summary>Show the code</summary>
    ```astro title="src/components/BlogPost.astro"
    ---
    const { title, url } = Astro.props
    ---
    <li><a href={url}>{title}</a></li>
    ```
    ```astro title="src/pages/blog.astro" ins={3,10}
    ---
    import BaseLayout from '../layouts/BaseLayout.astro'
    import BlogPost from '../components/BlogPost.astro'
    const allPosts = await Astro.glob('../pages/posts/*.md');
    pageTitle = "My Astro Learning Blog"
    ---
    <BaseLayout pageTitle={pageTitle}>
      <p>This is where I will post about my journey learning Astro.</p>
      <ul>
        {allPosts.map((post) => <BlogPost url={post.url} title={post.frontmatter.title} />)}
      </ul>
    </BaseLayout>
    ```
    </details>
</details>

## Before you go

### Test your knowledge

Given the following line of code: 

```astro
---
const myPosts = await Astro.glob('../pages/posts/*.md');
---
```

Write the syntax that represents:

1. The title of the third blog post returned.  

    || `myPosts[2].frontmatter.title` ||

2. The text "First Post!!" linking to the URL of the first blog post returned. 

    || `<a href={myPosts[0].url}>First Post!!</a>` ||

3. Returning a `<LastUpdated />` component for each item in `myPosts`, passing the blog post's `pubDate` as props.

    || `myPosts.map((post) => <LastUpdated date={post.frontmatter.pubDate} />)` ||


### Checklist for moving on

<Checklist key="glob">
- [ ] I can use `Astro.glob()` to return an array of all `.md` files in a specified directory.
- [ ] I can access the data returned by `Astro.glob()` to dynamically display values from my Markdown files.
- [ ] I can replace HTML templating with a custom component, and pass values received from `Astro.glob()` to it as props.
</Checklist>

### Resources

- [`Astro.glob()` API documentation](/en/reference/api-reference/#astroglob)
