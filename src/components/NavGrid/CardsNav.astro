---
import type { ComponentProps } from 'astro/types';
import Badge from '~/components/Badge.astro';
import Card from './Card.astro';
import Grid from './Grid.astro';

export interface Props {
	size?: 'small' | 'default' | 'large';
	links: {
		title: string;
		description?: string;
		href: string;
		logo?: ComponentProps<typeof Card>['logo'];
		/** Map of tag IDs to translated tag display text, e.g. `{ static: 'Statisch' }`. */
		tags?: Record<string, string>;
		/** The language of the content if it differs from the main page language. */
		lang?: string;
	}[];
	class?: string;
}

const { links, size, class: classes } = Astro.props as Props;

const currentPage = new URL(Astro.request.url).pathname;
---

<section class:list={['cards-nav', classes, 'not-content']}>
	<slot />
	<Grid {size}>
		{
			links.map(({ description, href, logo, title, tags, lang }) => (
				<Card
					{...{ minimal: size === 'small', logo, href, lang }}
					current={currentPage.includes(href)}
					class={Object.keys(tags || {}).join(' ')}
				>
					<Fragment slot="title" set:html={title} />
					<Fragment slot="details">
						{description && <p class="description">{description}</p>}
						{tags && (
							<div class="tags sl-flex">
								{Object.values(tags).map((tag) => (
									<Badge class="neutral-badge" text={tag} />
								))}
							</div>
						)}
					</Fragment>
				</Card>
			))
		}
	</Grid>
</section>

<style>
	.description {
		color: var(--sl-color-gray-2);
		font-size: var(--sl-text-body-sm);
		text-wrap: pretty;
	}

	.tags {
		gap: 0.5rem;
	}
</style>
