---
type: integration
title: '@astrojs/vercel'
description: Pelajari cara menggunakan adapter @astrojs/vercel untuk menerapkan (deploy) proyek Astro Anda.
sidebar:
  label: Vercel
githubIntegrationURL: 'https://github.com/withastro/astro/tree/main/packages/integrations/vercel/'
category: adapter
i18nReady: true
---
import PackageManagerTabs from '~/components/tabs/PackageManagerTabs.astro';
import Since from '~/components/Since.astro';
import ReadMore from '~/components/ReadMore.astro'
import { Steps } from '@astrojs/starlight/components';

Adapter ini memungkinkan Astro untuk menerapkan [rute dan fitur yang dirender on‑demand](/id/guides/on-demand-rendering/) ke [Vercel](https://www.vercel.com/), termasuk [pulau server](/id/guides/server-islands/), [actions](/id/guides/actions/), dan [sessions](/id/guides/sessions/).

Jika Anda menggunakan Astro sebagai static site builder, Anda hanya memerlukan adapter ini bila menggunakan layanan Vercel tambahan (misalnya [Vercel Web Analytics](https://vercel.com/docs/analytics), [Vercel Image Optimization](https://vercel.com/docs/image-optimization)). Jika tidak, Anda tidak memerlukan adapter untuk menerapkan situs statis Anda.

Pelajari cara menerapkan situs Astro Anda di [panduan deployment Vercel kami](/id/guides/deploy/vercel/).

## Mengapa Astro Vercel?

[Vercel](https://www.vercel.com/) adalah platform deployment yang memungkinkan Anda meng-host situs dengan menghubungkan langsung ke repository GitHub Anda. Adapter ini menyempurnakan proses build Astro untuk menyiapkan proyek Anda agar siap dideploy melalui Vercel.

## Instalasi

Astro menyertakan perintah `astro add` untuk mengotomatisasi pemasangan integrasi resmi. Jika Anda mau, Anda dapat [menginstal integrasi secara manual](#manual-install) sebagai gantinya.

Tambahkan adapter Vercel untuk mengaktifkan rendering on‑demand di proyek Astro Anda dengan perintah `astro add` berikut. Ini akan menginstal `@astrojs/vercel` dan melakukan perubahan yang diperlukan pada file `astro.config.mjs` Anda dalam satu langkah.

<PackageManagerTabs>
  <Fragment slot="npm">
  ```sh
  npx astro add vercel
  ```
  </Fragment>
  <Fragment slot="pnpm">
  ```sh
  pnpm astro add vercel
  ```
  </Fragment>
  <Fragment slot="yarn">
  ```sh
  yarn astro add vercel
  ```
  </Fragment>
</PackageManagerTabs>


Sekarang, Anda dapat mengaktifkan [rendering on‑demand per halaman](/id/guides/on-demand-rendering/#enabling-on-demand-rendering), atau menetapkan konfigurasi output build ke `output: 'server'` untuk [merender server semua halaman secara default](/id/guides/on-demand-rendering/#server-mode).

### Instalasi Manual

Pertama, tambahkan adapter `@astrojs/vercel` ke dependensi proyek Anda menggunakan manajer paket pilihan Anda:

<PackageManagerTabs>
  <Fragment slot="npm">
  ```sh
  npm install @astrojs/vercel
  ```
  </Fragment>
  <Fragment slot="pnpm">
  ```sh
  pnpm add @astrojs/vercel
  ```
  </Fragment>
  <Fragment slot="yarn">
  ```sh
  yarn add @astrojs/vercel
  ```
  </Fragment>
</PackageManagerTabs>

Lalu, tambahkan adapter ke file `astro.config.*` Anda:

```js title="astro.config.mjs" ins={2, 6}
import { defineConfig } from 'astro/config';
import vercel from '@astrojs/vercel';

export default defineConfig({
  // ...
  adapter: vercel(),
});
```

## Penggunaan

<ReadMore>Pelajari lebih lanjut tentang [mendeploy proyek Anda ke Vercel](/id/guides/deploy/vercel/).</ReadMore>

Anda dapat mendeploy melalui CLI (`vercel deploy`) atau dengan menghubungkan repo baru Anda di [Vercel Dashboard](https://vercel.com/). Atau, Anda bisa membuat build produksi secara lokal:

```sh
astro build
vercel deploy --prebuilt
```

## Konfigurasi

Untuk mengonfigurasi adapter ini, berikan sebuah objek ke pemanggilan fungsi `vercel()` di `astro.config.mjs`:

### `webAnalytics`

<p>

**Type:** `VercelWebAnalyticsConfig`<br/>
**Available for:** Serverless, Static<br/>
<Since v="3.8.0" pkg="@astrojs/vercel" />
</p>

Dengan `@vercel/analytics@1.3.x` atau sebelumnya, Anda dapat menetapkan `webAnalytics: { enabled: true }` di konfigurasi Astro Anda untuk menyuntikkan skrip pelacakan Vercel ke semua halaman Anda.

Untuk `@vercel/analytics@1.4.0` dan yang lebih baru, gunakan komponen Analytics milik Vercel untuk mengaktifkan [Vercel Web Analytics](https://vercel.com/docs/concepts/analytics).

```js title="astro.config.mjs" ins={7-9}
import { defineConfig } from 'astro/config';
import vercel from '@astrojs/vercel';

export default defineConfig({
  // ...
  adapter: vercel({
    webAnalytics: {
      enabled: true,
    },
  }),
});
```

### `imagesConfig`

<p>

**Type:** `VercelImageConfig`<br/>
**Available for:** Serverless, Static<br />
<Since v="3.3.0" pkg="@astrojs/vercel" />
</p>

Opsi konfigurasi untuk [Vercel's Image Optimization API](https://vercel.com/docs/concepts/image-optimization). Lihat dokumentasi konfigurasi gambar Vercel untuk daftar lengkap parameter yang didukung.

Properti `domains` dan `remotePatterns` akan otomatis diisi menggunakan [pengaturan `image` yang sesuai di Astro](/id/reference/configuration-reference/#image-options).

```js title="astro.config.mjs" ins={8-10}
import { defineConfig } from 'astro/config';
import vercel from '@astrojs/vercel';

export default defineConfig({
  // ...
  output: 'static',
  adapter: vercel({
    imagesConfig: {
      sizes: [320, 640, 1280],
    },
  }),
});
```

### `imageService`

<p>

**Type:** `boolean`<br/>
**Available for:** Serverless, Static<br />
<Since v="3.3.0" pkg="@astrojs/vercel" />
</p>

Saat diaktifkan, sebuah [Image Service](/id/reference/image-service-reference/) yang didukung oleh Vercel Image Optimization API akan dikonfigurasi otomatis dan digunakan di produksi. Saat development, layanan gambar yang ditentukan oleh [`devImageService`](#devimageservice) akan digunakan sebagai gantinya.

```js title="astro.config.mjs" ins={8}
import { defineConfig } from 'astro/config';
import vercel from '@astrojs/vercel';

export default defineConfig({
  // ...
  output: 'static',
  adapter: vercel({
    imageService: true,
  }),
});
```

```astro title="src/pages/index.astro"
---
import { Image } from 'astro:assets';
import astroLogo from '../assets/logo.png';
---

<!-- Komponen ini -->
<Image src={astroLogo} alt="Logo super saya!" />

<!-- akan menjadi HTML berikut -->
<img
  src="/_vercel/image?url=_astro/logo.hash.png&w=...&q=..."
  alt="Logo super saya!"
  loading="lazy"
  decoding="async"
  width="..."
  height="..."
/>
```

### `devImageService`

<p>

**Type:** `'sharp' | string`<br/>
**Default:** `sharp`<br />
**Available for:** Serverless, Static<br />
<Since v="3.8.0" pkg="@astrojs/vercel" />
</p>

Mengizinkan Anda mengonfigurasi layanan gambar mana yang digunakan saat development ketika [imageService](#imageservice) diaktifkan. Ini berguna bila Anda tidak dapat memasang dependensi Sharp di mesin pengembangan Anda, namun layanan lain seperti Squoosh memungkinkan Anda melihat pratinjau gambar. Build tidak terpengaruh dan selalu menggunakan Vercel Image Optimization.

Anda juga dapat menetapkannya ke nilai apa pun untuk menggunakan layanan gambar kustom alih‑alih yang bawaan Astro.

```js title="astro.config.mjs" ins={7-8}
import { defineConfig } from 'astro/config';
import vercel from '@astrojs/vercel';

export default defineConfig({
  // ...
  adapter: vercel({
    imageService: true,
    devImageService: 'sharp',
  }),
});
```

### `isr`

<p>

**Type:** `boolean | VercelISRConfig`<br/>
**Default:** `false`<br />
**Available for:** Serverless<br />
<Since v="7.2.0" pkg="@astrojs/vercel" />
</p>

Memungkinkan proyek Anda dideploy sebagai fungsi [ISR (Incremental Static Regeneration)](https://vercel.com/docs/incremental-static-regeneration) yang menyimpan cache halaman yang dirender on‑demand seperti halaman yang diprerender setelah permintaan pertama.

Untuk mengaktifkan fitur ini, setel `isr` ke true pada konfigurasi adapter Vercel di `astro.config.mjs`:

```js title="astro.config.mjs" ins={7}
import { defineConfig } from 'astro/config';
import vercel from '@astrojs/vercel';

export default defineConfig({
  // ...
  adapter: vercel({
    isr: true,
  }),
});
```

Perhatikan bahwa permintaan fungsi ISR tidak menyertakan search params, mirip dengan [permintaan](/id/reference/api-reference/#request) pada mode statis.

#### Invalidasi cache ISR

Secara default, fungsi ISR menyimpan cache selama masa deploy Anda. Anda dapat mengontrol caching lebih lanjut dengan menetapkan waktu kedaluwarsa, atau mengecualikan rute tertentu dari caching sepenuhnya.

##### Invalidasi berbasis waktu

Anda dapat mengubah lamanya waktu cache rute dengan mengonfigurasi nilai `expiration` dalam detik:

```js title="astro.config.mjs" {7-10}
import { defineConfig } from 'astro/config';
import vercel from '@astrojs/vercel';

export default defineConfig({
  // ...
  adapter: vercel({
    isr: {
      // menyimpan cache semua halaman pada permintaan pertama selama 1 hari
      expiration: 60 * 60 * 24,
    },
  }),
});
```

##### Mengecualikan path dari caching

Untuk menerapkan [Draft mode](https://vercel.com/docs/build-output-api/v3/features#draft-mode) Vercel, atau [On‑Demand Incremental Static Regeneration (ISR)](https://vercel.com/docs/build-output-api/v3/features#on-demand-incremental-static-regeneration-isr), Anda dapat membuat bypass token dan memberikannya ke konfigurasi `isr` bersama dengan rute mana pun yang harus dikecualikan dari cache:

```js title="astro.config.mjs" {6-15}
import { defineConfig } from 'astro/config';
import vercel from '@astrojs/vercel';

export default defineConfig({
    adapter: vercel({
        isr: {
            // String acak rahasia yang Anda buat sendiri.
            bypassToken: "005556d774a8",
            // Path yang selalu disajikan segar.
            exclude: [
              '/preview', 
              '/auth/[page]',
              /^\/api\/.+/ // Ekspresi reguler didukung sejak @astrojs/vercel@v8.1.0
            ]
        }
    })
})
```

### `includeFiles`

<p>

**Type:** `string[]`<br/>
**Available for:** Serverless
</p>

Gunakan properti ini untuk memaksa file dibundel bersama fungsi Anda. Ini membantu saat Anda menemukan file yang hilang.

```js title="astro.config.mjs" ins={7}
import { defineConfig } from 'astro/config';
import vercel from '@astrojs/vercel';

export default defineConfig({
  // ...
  adapter: vercel({
    includeFiles: ['./my-data.json'],
  }),
});
```

### `excludeFiles`

<p>

**Type:** `string[]`<br/>
**Available for:** Serverless
</p>

Gunakan properti ini untuk mengecualikan file apa pun dari proses bundling yang seharusnya disertakan.

```js title="astro.config.mjs" ins={7}
import { defineConfig } from 'astro/config';
import vercel from '@astrojs/vercel';

export default defineConfig({
  // ...
  adapter: vercel({
    excludeFiles: ['./src/some_big_file.jpg'],
  }),
});
```

### `maxDuration`

<p>

**Type:** `number`<br/>
**Available for:** Serverless
</p>

Gunakan properti ini untuk memperpanjang atau membatasi durasi maksimum (dalam detik) fungsi Serverless dapat berjalan sebelum timeout. Lihat [dokumentasi Vercel](https://vercel.com/docs/functions/serverless-functions/runtimes#maxduration) untuk batas default dan maksimum pada paket akun Anda.

```js title="astro.config.mjs" ins={7}
import { defineConfig } from 'astro/config';
import vercel from '@astrojs/vercel';

export default defineConfig({
// ...
  adapter: vercel({
    maxDuration: 60
  }),
});
```

### `skewProtection`

<p>

**Type:** `boolean`<br/>
**Available for:** Serverless<br />
<Since pkg="@astrojs/vercel" v="7.6.0" />
</p>

Gunakan properti ini untuk mengaktifkan [Vercel Skew protection](https://vercel.com/docs/deployments/skew-protection) (tersedia untuk akun Vercel Pro dan Enterprise).

```js title="astro.config.mjs" ins={7}
import { defineConfig } from 'astro/config';
import vercel from '@astrojs/vercel';

export default defineConfig({
// ...
  adapter: vercel({
    skewProtection: true
  }),
});
```

### Menjalankan middleware Astro pada Vercel Edge Functions

Adapter `@astrojs/vercel` dapat membuat sebuah [edge function](https://vercel.com/docs/functions/edge-functions) dari middleware Astro di basis kode Anda. Saat `edgeMiddleware` diaktifkan, edge function akan menjalankan kode middleware Anda untuk semua permintaan termasuk aset statis, halaman yang diprerender, dan halaman yang dirender on‑demand.

Untuk halaman yang dirender on‑demand, objek `context.locals` diserialisasi menggunakan JSON dan dikirim dalam header ke serverless function yang melakukan rendering. Sebagai langkah keamanan, serverless function akan menolak melayani permintaan dengan respons `403 Forbidden` kecuali berasal dari edge function yang dihasilkan.

Ini adalah fitur opsional. Untuk mengaktifkannya, setel `edgeMiddleware` ke `true`:

```js title="astro.config.mjs" "edgeMiddleware: true"
import { defineConfig } from 'astro/config';
import vercel from '@astrojs/vercel';

export default defineConfig({
  // ...
  adapter: vercel({
    edgeMiddleware: true,
  }),
});
```

Edge middleware memiliki akses ke [`RequestContext`](https://vercel.com/docs/functions/edge-middleware/middleware-api#requestcontext) milik Vercel sebagai `ctx.locals.vercel.edge`. Jika Anda menggunakan TypeScript, Anda dapat [mendapatkan tipe yang tepat](/id/guides/typescript/#extending-global-types) dengan memperbarui `src/env.d.ts` untuk menggunakan `EdgeLocals`:

```ts
type EdgeLocals = import('@astrojs/vercel').EdgeLocals

declare namespace App {
  interface Locals extends EdgeLocals {
    // ...
  }
}
```

### Sessions

[Sessions API](/id/guides/sessions/) Astro memungkinkan Anda dengan mudah menyimpan data pengguna antar permintaan. Ini dapat digunakan untuk hal seperti data & preferensi pengguna, keranjang belanja, dan kredensial autentikasi. Tidak seperti penyimpanan cookie, tidak ada batasan ukuran data, dan dapat dipulihkan di perangkat berbeda. 

Saat menggunakan sessions di Vercel, Anda perlu [mengonfigurasi driver](/id/reference/configuration-reference/#sessiondriver) untuk penyimpanan session. Anda dapat memasang penyedia penyimpanan dari [Vercel marketplace](https://vercel.com/marketplace?category=storage).

Sebagai contoh, jika Anda telah memasang [integrasi Redis](https://vercel.com/marketplace?category=storage&search=redis) dan menautkan database ke situs Anda:

<Steps>

1. Instal paket `ioredis`:
   <PackageManagerTabs>
     <Fragment slot="npm">
     ```sh
     npm install ioredis
     ```
     </Fragment>
     <Fragment slot="pnpm">
     ```sh
     pnpm install ioredis
     ```
     </Fragment>
     <Fragment slot="yarn">
     ```sh
     yarn add ioredis
     ```
     </Fragment>
   </PackageManagerTabs>

2. Gunakan [Vercel CLI](https://vercel.com/docs/cli) untuk memuat variabel lingkungan Anda:
   ```sh
   vercel env pull .env.local
   ```
   Ini akan membuat file `.env.local` di root proyek Anda dengan variabel lingkungan yang diperlukan untuk tersambung ke database Redis saat mengembangkan secara lokal.

3. Konfigurasikan driver session:

    ```js title="astro.config.mjs" ins={6-11}
    import { defineConfig } from 'astro/config';
    import vercel from '@astrojs/vercel';

    export default defineConfig({
      adapter: vercel(),
      session: {
        driver: 'redis',
        options: {
          url: process.env.REDIS_URL,
        },
      },
    });
    ```

</Steps>

## Dukungan Versi Node.js

Adapter `@astrojs/vercel` mendukung versi Node.js tertentu untuk mendeploy proyek Astro Anda di Vercel. Untuk melihat versi Node.js yang didukung di Vercel, buka tab pengaturan pada sebuah proyek dan gulir ke bagian "Node.js Version".

Lihat [dokumentasi Vercel](https://vercel.com/docs/functions/serverless-functions/runtimes/node-js#default-and-available-versions) untuk informasi lebih lanjut.

## Fitur eksperimental

Fitur berikut juga tersedia untuk digunakan, namun mungkin mengalami perubahan yang tidak kompatibel di pembaruan mendatang. Harap ikuti [`CHANGELOG` @astrojs/vercel](https://github.com/withastro/astro/tree/main/packages/integrations/vercel/CHANGELOG.md) dengan saksama untuk pembaruan jika Anda menggunakan fitur ini di proyek Anda.

### `experimentalStaticHeaders`

<p>
**Type:** `boolean`<br/>
**Default:** `false`<br />
**Available for:** Serverless <br/>
<Since pkg="@astrojs/vercel" v="8.2.0" />
</p>

Mengaktifkan penentuan header kustom untuk halaman yang diprerender dalam konfigurasi Vercel.

Jika diaktifkan, adapter akan menyimpan [static headers di file `vercel.json` Vercel](https://vercel.com/docs/project-configuration#headers) saat disediakan oleh fitur Astro, seperti Content Security Policy.

Sebagai contoh, saat [Content Security Policy eksperimental](/id/reference/experimental-flags/csp/) diaktifkan, `experimentalStaticHeaders` dapat digunakan untuk menambahkan header CSP ke konfigurasi Vercel Anda, alih‑alih membuat elemen `<meta>`:

```js title="astro.config.mjs" {9}
import { defineConfig } from 'astro/config';
import vercel from '@astrojs/vercel';

export default defineConfig({
  experimental: {
    csp: true
  },
  adapter: vercel({
    experimentalStaticHeaders: true 
  })
});
```

[astro-integration]: /id/guides/integrations-guide/