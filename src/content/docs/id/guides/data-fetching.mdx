---
title: Pengambilan data
description: Pelajari cara mengambil data jarak jauh dengan Astro menggunakan API fetch.
i18nReady: true
---
`.astro` dapat mengambil data jarak jauh untuk membantu Anda menghasilkan halaman.

## `fetch()` di Astro

Semua [komponen Astro](/id/basics/astro-components/) memiliki akses ke [fungsi global `fetch()`](https://developer.mozilla.org/en-US/docs/Web/API/fetch) di skrip komponennya untuk melakukan permintaan HTTP ke API menggunakan URL penuh (mis. `https://example.com/api`).
Selain itu, Anda dapat membangun URL ke halaman dan endpoint proyek Anda yang dirender onâ€‘demand di server menggunakan [`new URL("/api", Astro.url)`](/id/reference/api-reference/#url).

Pemanggilan fetch ini akan dieksekusi saat proses build, dan datanya akan tersedia bagi templat komponen untuk menghasilkan HTML dinamis. Jika mode [SSR](/id/guides/on-demand-rendering/) diaktifkan, setiap pemanggilan fetch akan dieksekusi pada saat runtime.

ðŸ’¡ Manfaatkan [**top-level `await`**](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await#top_level_await) di dalam skrip komponen Astro Anda.

ðŸ’¡ Teruskan data yang diambil ke komponen Astro maupun komponen framework sebagai props.

```astro /await fetch\(.*?\);/
---
// src/components/User.astro
import Contact from "../components/Contact.jsx";
import Location from "../components/Location.astro";

const response = await fetch("https://randomuser.me/api/");
const data = await response.json();
const randomUser = data.results[0];
---
<!-- Data yang diambil saat build dapat dirender sebagai HTML -->
<h1>User</h1>
<h2>{randomUser.name.first} {randomUser.name.last}</h2>

<!-- Data yang diambil saat build dapat diteruskan ke komponen sebagai props -->
<Contact client:load email={randomUser.email} />
<Location city={randomUser.location.city} />
```

:::note
Ingat, semua data di komponen Astro diambil saat komponen dirender.

Situs Astro yang ter-deploy akan mengambil data **sekali, saat proses build**. Di mode dev, Anda akan melihat pengambilan data ketika komponen direfresh. Jika Anda perlu mengambil ulang data berkaliâ€‘kali di sisi klien, gunakan [komponen framework](/id/guides/framework-components/) atau [skrip sisi klien](/id/guides/client-side-scripts/) di dalam komponen Astro.
:::

## `fetch()` di Komponen Framework

Fungsi `fetch()` juga tersedia secara global untuk [komponen framework](/id/guides/framework-components/):

```tsx title="src/components/Movies.tsx" /await fetch\(.*?\)/
import type { FunctionalComponent } from 'preact';

const data = await fetch('https://example.com/movies.json').then((response) => response.json());

// Komponen yang dirender saat build juga akan melakukan log ke CLI.
// Saat dirender dengan direktif `client:*`, komponen juga akan melakukan log ke konsol browser.
console.log(data);

const Movies: FunctionalComponent = () => {
  // Tampilkan hasil ke halaman
  return <div>{JSON.stringify(data)}</div>;
};

export default Movies;
```

## Kueri GraphQL

Astro juga dapat menggunakan `fetch()` untuk mengkueri server GraphQL dengan kueri GraphQL yang valid.

```astro title="src/components/Film.astro" "await fetch"
---
const response = await fetch(
  "https://swapi-graphql.netlify.app/.netlify/functions/index",
  {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      query: \`
        query getFilm ($id:ID!) {
          film(id: $id) {
            title
            releaseDate
          }
        }
      \`,
      variables: {
        id: "ZmlsbXM6MQ==",
      },
    }),
  }
);


const json = await response.json();
const { film } = json.data;
---
<h1>Mengambil informasi tentang Star Wars: A New Hope</h1>
<h2>Judul: {film.title}</h2>
<p>Tahun: {film.releaseDate}</p>
```

## Mengambil data dari Headless CMS

Komponen Astro dapat mengambil data dari CMS favorit Anda lalu merendernya sebagai konten halaman. Dengan menggunakan [rute dinamis](/id/guides/routing/#dynamic-routes), komponen bahkan dapat menghasilkan halaman berdasarkan konten CMS Anda.

Lihat [Panduan CMS](/id/guides/cms/) kami untuk detail lengkap mengintegrasikan Astro dengan headless CMS seperti Storyblok, Contentful, dan WordPress.

## Sumber daya komunitas

- [Membuat aplikasi fullstack dengan Astro + GraphQL](https://robkendal.co.uk/blog/how-to-build-astro-site-with-graphql/)
