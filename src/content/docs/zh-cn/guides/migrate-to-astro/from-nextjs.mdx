---
title: ä» Next.js è¿ç§»
description: å°†ç°æœ‰çš„ Next.js é¡¹ç›®è¿ç§»åˆ° Astro çš„æç¤º
type: migration
stub: false
framework: Next.js
i18nReady: true
---
import AstroJSXTabs from '~/components/tabs/AstroJSXTabs.astro'
import PackageManagerTabs from '~/components/tabs/PackageManagerTabs.astro'

è¿™é‡Œæœ‰ä¸€äº›å…³é”®çš„æ¦‚å¿µå’Œè¿ç§»ç­–ç•¥æ¥å¸®åŠ©ä½ å¼€å§‹ã€‚å¯ä»¥é€šè¿‡æ–‡æ¡£å…¶ä»–å†…å®¹å’Œæˆ‘ä»¬çš„ [Discord ç¤¾åŒº](https://astro.build/chat)æ¥ç»§ç»­å®Œæˆè¿ç§»ï¼

## Next.js å’Œ Astro çš„ä¸»è¦ç›¸ä¼¼ä¹‹å¤„

Next.js å’Œ Astro æœ‰ä¸€äº›ç›¸ä¼¼ä¹‹å¤„ï¼Œå¯ä»¥å¸®åŠ©ä½ è¿ç§»ä½ çš„é¡¹ç›®ï¼š

- [`.astro` æ–‡ä»¶çš„è¯­æ³•ç±»ä¼¼äº JSX](/zh-cn/core-concepts/astro-syntax/#astro-å’Œ-jsx-é—´çš„å·®å¼‚)ã€‚ç¼–å†™ Astro åº”è¯¥ä¼šæ„Ÿè§‰å¾ˆç†Ÿæ‚‰ã€‚
- Astro é¡¹ç›®ä¹Ÿå¯ä»¥æ˜¯ SSG æˆ–[å…·æœ‰é¡µé¢é¢„æ¸²æŸ“åŠŸèƒ½çš„ SSR](/zh-cn/guides/server-side-rendering/)ã€‚
- Astro ä½¿ç”¨åŸºäºæ–‡ä»¶çš„è·¯ç”±ï¼Œå¹¶[å…è®¸ç‰¹å®šå‘½åçš„é¡µé¢åˆ›å»ºåŠ¨æ€è·¯ç”±](/zh-cn/core-concepts/routing/#åŠ¨æ€è·¯ç”±)ã€‚
- Astro æ˜¯[åŸºäºç»„ä»¶](/zh-cn/core-concepts/astro-components/)çš„ï¼Œæ ‡ç­¾åœ¨è¿ç§»å‰åä¼šå¾ˆç›¸ä¼¼ã€‚
- Astro å…·æœ‰é’ˆå¯¹ [Reactã€Preact å’Œ Solid çš„å®˜æ–¹é›†æˆ](/zh-cn/guides/integrations-guide/react/)ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ç°æœ‰çš„ JSX ç»„ä»¶ã€‚è¯·æ³¨æ„ï¼Œåœ¨ Astro ä¸­ï¼Œè¿™äº›æ–‡ä»¶**å¿…é¡»**å…·æœ‰ `.jsx` æˆ– `.tsx` æ‰©å±•åã€‚
- Astro æ”¯æŒ[å®‰è£… NPM åŒ…](/zh-cn/guides/imports/#npm-åŒ…)ï¼ŒåŒ…æ‹¬ React åº“ã€‚è®¸å¤šç°æœ‰çš„ä¾èµ–å°†åœ¨ Astro ä¸­èµ·ä½œç”¨ã€‚

## Next.js å’Œ Astro çš„ä¸»è¦ä¸åŒä¹‹å¤„

å½“ä½ åœ¨ Astro ä¸­é‡å»ºä½ çš„ Next.js ç½‘ç«™æ—¶ï¼Œä½ ä¼šå‘ç°ä¸€äº›é‡è¦çš„åŒºåˆ«ï¼š

- Next.js æ˜¯ä¸€ä¸ª React å•é¡µé¢åº”ç”¨ï¼Œä½¿ç”¨ `index.js` ä½œä¸ºé¡¹ç›®çš„ rootã€‚Astro æ˜¯ä¸€ä¸ªå¤šé¡µé¢çš„ç½‘ç«™ï¼Œ`index.astro` æ˜¯ä½ çš„ä¸»é¡µã€‚

- [`.astro` ç»„ä»¶](/zh-cn/core-concepts/astro-components/)ï¼šä¸æ˜¯ä½œä¸ºè¿”å›é¡µé¢æ¨¡æ¿çš„å¯¼å‡ºå‡½æ•°å»ç¼–å†™çš„ã€‚ç›¸åï¼Œä¼šæŠŠä½ çš„ä»£ç åˆ†æˆä¸€ä¸ª JavaScript çš„"ä»£ç æ …æ "å’Œä¸€ä¸ªä¸“é—¨ç”¨äºç”Ÿæˆ HTML çš„ä¸»ä½“ã€‚

- [å†…å®¹ä¼˜å…ˆ](/zh-cn/concepts/why-astro/)ï¼šAstro æ—¨åœ¨å±•ç¤ºä½ çš„å†…å®¹ï¼Œå¹¶å…è®¸ä½ ä»…åœ¨éœ€è¦æ—¶é€‰æ‹©åŠ å…¥äº¤äº’æ€§ã€‚å·²æœ‰çš„ Next.js åº”ç”¨ç¨‹åºå¯èƒ½æ˜¯ä¸ºé‡å®¢æˆ·ç«¯äº¤äº’æ€§è€Œæ„å»ºçš„ï¼Œå¹¶ä¸”åŒ…å«ä¸€äº›ä½¿ç”¨ `.astro` ç»„ä»¶éš¾ä»¥å¤åˆ¶ã€æ›´å…·æŒ‘æˆ˜æ€§çš„åŠŸèƒ½ï¼Œå¯èƒ½éœ€è¦é«˜çº§ Astro æŠ€æœ¯æ¥å¤„ç†ï¼Œä¾‹å¦‚ä»ªè¡¨ç›˜ã€‚

## è½¬æ¢ä½ çš„ Next.js é¡¹ç›®

å°½ç®¡æ¯ä¸ªé¡¹ç›®åœ¨è¿ç§»çš„å®é™…è¿‡ç¨‹ä¸­éƒ½ä¼šæœ‰äº›ä¸åŒï¼Œä½†åœ¨ä» Next.js è½¬æ¢åˆ° Astro æ—¶ï¼Œæœ‰ä¸€äº›å¸¸è§çš„æ“ä½œå¯ä»¥å‚è€ƒã€‚

### åˆ›å»ºä¸€ä¸ªæ–°çš„ Astro é¡¹ç›®
é€šè¿‡ä½ çš„åŒ…ç®¡ç†å™¨æ‰§è¡Œå‘½ä»¤ `create astro` æ¥å¯åŠ¨ Astro çš„ CLI å‘å¯¼ï¼Œæˆ–ä» [Astro Theme Showcase](https://astro.build/themes) é€‰æ‹©ä¸€ä¸ªç¤¾åŒºä¸»é¢˜ã€‚

ä½ å¯ä»¥åœ¨ `create astro` å‘½ä»¤ä¸­ä¼ é€’ä¸€ä¸ª `--template` å‚æ•°ï¼Œç”¨æˆ‘ä»¬çš„å®˜æ–¹å¯åŠ¨å™¨ï¼ˆå¦‚ `docs`ã€`blog`ã€`portfolio`ï¼‰å¯åŠ¨ä¸€ä¸ªæ–°çš„ Astro é¡¹ç›®ã€‚æˆ–è€…ï¼Œä½ å¯ä»¥[ä» GitHub ä¸Šä»»ä½•ç°æœ‰çš„ Astro ä»“åº“å¼€å§‹ä¸€ä¸ªæ–°é¡¹ç›®](/zh-cn/install/auto/#å…¥é—¨æ¨¡æ¿)ã€‚

  <PackageManagerTabs>
    <Fragment slot="npm">
    ```shell
    # å¯åŠ¨ Astro CLI å®‰è£…å‘å¯¼
    npm create astro@latest

    # é€šè¿‡å®˜æ–¹ç¤ºä¾‹æ¥åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®
    npm create astro@latest -- --template <example-name>
    ```
    </Fragment>
    <Fragment slot="pnpm">
    ```shell
    # å¯åŠ¨ Astro CLI å®‰è£…å‘å¯¼
    pnpm create astro@latest

    # é€šè¿‡å®˜æ–¹ç¤ºä¾‹æ¥åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®
    pnpm create astro@latest --template <example-name>
    ```
    </Fragment>
    <Fragment slot="yarn">
    ```shell
    # å¯åŠ¨ Astro CLI å®‰è£…å‘å¯¼
    yarn create astro@latest

    # é€šè¿‡å®˜æ–¹ç¤ºä¾‹æ¥åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®
    yarn create astro@latest --template <example-name>
    ```
    </Fragment>
  </PackageManagerTabs>

ç„¶åï¼ŒæŠŠç°æœ‰çš„ Next é¡¹ç›®æ–‡ä»¶å¤åˆ¶åˆ°ä½ çš„æ–° Astro é¡¹ç›®ä¸­ï¼Œæ”¾åœ¨`src`ä»¥å¤–çš„å•ç‹¬æ–‡ä»¶å¤¹ä¸­ã€‚

:::tip
è®¿é—® https://astro.new äº†è§£å®˜æ–¹å¯åŠ¨æ¨¡æ¿çš„å®Œæ•´åˆ—è¡¨ï¼Œä»¥åŠåœ¨ StackBlitzã€CodeSandbox æˆ– Gitpod ä¸­æ‰“å¼€ä¸€ä¸ªæ–°é¡¹ç›®çš„é“¾æ¥ã€‚
:::

### å®‰è£…é›†æˆ (å¯é€‰)

åœ¨å°† Next é¡¹ç›®è½¬æ¢ä¸º Astro æ—¶ï¼Œä½ å¯èƒ½ä¼šå‘ç°å®‰è£…ä¸€äº› [Astro å¯é€‰é›†æˆ](/zh-cn/guides/integrations-guide/) æ˜¯æœ‰ç”¨çš„ã€‚

- **@astrojs/react**ï¼šåœ¨ä½ çš„æ–° Astro ç½‘ç«™ä¸Šé‡ç”¨ä¸€äº›ç°æœ‰çš„ React UI ç»„ä»¶ï¼Œæˆ–è€…ç»§ç»­ç”¨ React ç»„ä»¶æ¥ç¼–å†™ã€‚

- **@astrojs/mdx**ï¼šå°†ç°æœ‰çš„ Next é¡¹ç›®ä¸­çš„ MDX æ–‡ä»¶å¯¼å…¥ï¼Œæˆ–åœ¨æ–°çš„ Astro ç«™ç‚¹ä¸­ä½¿ç”¨ MDXã€‚

### å°†æºç æ”¾åœ¨ `src` ç›®å½•å†…

æŒ‰ç…§ [Astro çš„é¡¹ç›®ç»“æ„](/zh-cn/core-concepts/project-structure/)ï¼š

1. **ä¿æŒ** Next çš„ `public/` æ–‡ä»¶å¤¹ä¸åŠ¨ã€‚
   
    Astro ä½¿ç”¨ `public/` ç›®å½•æ¥å­˜æ”¾é™æ€èµ„äº§ï¼Œå°±åƒ Next ä¸€æ ·ã€‚è¿™ä¸ªæ–‡ä»¶å¤¹å’Œå®ƒçš„å†…å®¹éƒ½ä¸éœ€è¦æ”¹å˜ã€‚

2. **å¤åˆ¶æˆ–ç§»åŠ¨** Next çš„å…¶ä»–æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼ˆå¦‚ `pages`ï¼Œ`styles` ç­‰ï¼‰åˆ° Astro çš„ `src/` æ–‡ä»¶å¤¹ï¼Œå½“ä½ åœ¨é‡æ„ç½‘ç«™æ—¶ï¼Œéµå¾ª [Astro çš„é¡¹ç›®ç»“æ„](/zh-cn/core-concepts/project-structure/)ã€‚

    åƒ Next ä¸€æ ·ï¼ŒAstro çš„ `src/pages/` æ–‡ä»¶å¤¹æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶å¤¹ï¼Œç”¨äºåŸºäºæ–‡ä»¶çš„è·¯ç”±ã€‚æ‰€æœ‰å…¶ä»–æ–‡ä»¶å¤¹éƒ½æ˜¯å¯é€‰çš„ï¼Œä½ å¯ä»¥ä»¥ä»»ä½•æ–¹å¼ç»„ç»‡ä½ çš„ `src/` æ–‡ä»¶å¤¹çš„å†…å®¹ã€‚Astro é¡¹ç›®ä¸­å…¶ä»–å¸¸è§çš„æ–‡ä»¶å¤¹åŒ…æ‹¬ `src/layouts/`ã€`src/components`ã€`src/styles` å’Œ `src/scripts`ã€‚


### Astro çš„é…ç½®æ–‡ä»¶

Astro åœ¨ä½ é¡¹ç›®çš„æ ¹ç›®å½•æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå«åš [`astro.config.mjs`](/zh-cn/guides/configuring-astro/)ã€‚è¿™ä»…ç”¨äºé…ç½®ä½ çš„ Astro é¡¹ç›®å’Œä»»ä½•å·²å®‰è£…çš„é›†æˆï¼ŒåŒ…æ‹¬ [SSR é€‚é…å™¨](/zh-cn/guides/deploy/)ã€‚

### æç¤ºï¼šå°† JSX æ–‡ä»¶è½¬æ¢ä¸º `.astro` æ–‡ä»¶

è¿™é‡Œæœ‰ä¸€äº›å°† `Next.js` ç»„ä»¶è½¬æ¢ä¸º `.astro` ç»„ä»¶çš„æç¤ºï¼š

1. ä½¿ç”¨ç°æœ‰ Next.js ç»„ä»¶å‡½æ•°è¿”å›çš„ JSX ä½œä¸ºä½ çš„ HTML æ¨¡æ¿çš„åŸºç¡€ã€‚

2. è°ƒæ•´ [Next æˆ– JSX è¯­æ³•ä¸º Astro](#å‚è€ƒå°†-nextjs-è¯­æ³•è½¬æ¢ä¸º-astro-è¯­æ³•) æˆ– HTML ç½‘é¡µæ ‡å‡†ã€‚ä¾‹å¦‚ï¼Œè¿™åŒ…æ‹¬ `<Link>`ã€`<Script>`ã€`{children}` å’Œ `className`ã€‚

1. å°†ä»»ä½•å¿…è¦çš„ JavaScriptï¼ŒåŒ…æ‹¬å¯¼å…¥è¯­å¥ï¼Œç§»åˆ°["ä»£ç æ …æ "ï¼ˆ`---`ï¼‰](/zh-cn/core-concepts/astro-components/#ç»„ä»¶è„šæœ¬)ã€‚æ³¨æ„ï¼š[æ¡ä»¶æ¸²æŸ“å†…å®¹](/zh-cn/core-concepts/astro-syntax/#åŠ¨æ€-html)çš„ JavaScript é€šå¸¸ç›´æ¥å†™åœ¨ Astro çš„ HTML æ¨¡æ¿å†…ã€‚

4. ä½¿ç”¨ [`Astro.props`](/zh-cn/reference/api-reference/#astroprops) æ¥è®¿é—®ä¹‹å‰ä¼ é€’ç»™ä½ çš„ Next å‡½æ•°çš„ä»»ä½•é¢å¤– propsã€‚

4. å†³å®šæ˜¯å¦éœ€è¦å°†æ‰€æœ‰å¯¼å…¥çš„ç»„ä»¶éƒ½è½¬æ¢ä¸º Astroã€‚å®‰è£…äº†å®˜æ–¹é›†æˆåï¼Œ[ä½ å¯ä»¥åœ¨ Astro æ–‡ä»¶ä¸­ä½¿ç”¨ç°æœ‰çš„ React ç»„ä»¶](/zh-cn/core-concepts/framework-components/)ã€‚ä½†æ˜¯ï¼Œå¦‚æœå®ƒä»¬ä¸éœ€è¦äº¤äº’ï¼Œä½ å¯èƒ½éœ€è¦å°†å®ƒä»¬è½¬æ¢ä¸º `.astro` ç»„ä»¶ï¼

4. ç”¨å¯¼å…¥è¯­å¥æˆ– [`Astro.glob()`](/zh-cn/reference/api-reference/#astroglob) ä»£æ›¿ `getStaticProps()` æ¥æŸ¥è¯¢ä½ çš„æœ¬åœ°æ–‡ä»¶ã€‚ä½¿ç”¨ `fetch()` æ¥è·å–å¤–éƒ¨æ•°æ®ã€‚

å‚è€ƒ [`Next.js` æ–‡ä»¶é€æ­¥è½¬æ¢çš„ä¾‹å­](#ç¤ºä¾‹æ•°æ®è¯·æ±‚)ã€‚

#### æ¯”è¾ƒï¼šJSX vs Astro

æ¯”è¾ƒä»¥ä¸‹ Next ç»„ä»¶å’Œç›¸åº”çš„ Astro ç»„ä»¶ï¼š

<AstroJSXTabs>
  <Fragment slot="jsx">
    ```jsx title="StarCount.jsx"
    import Header from "./header";
    import Footer from './footer';
    import "./layout.css";

    export async function getStaticProps() {
        const res = await fetch('https://api.github.com/repos/withastro/astro')
        const json = await res.json()
        return {
            props: { message: json.message, stars: json.stargazers_count || 0 },
        }
    }

    const Component = ({ stars, message }) => {
        
        return (
            <>
                <Header />
                <p style={{
                    backgroundColor: `#f4f4f4`,
                    padding: `1em 1.5em`,
                    textAlign: `center`,
                    marginBottom: `1em`
                }}>Astro has {stars} ğŸ§‘â€ğŸš€</p>
                <Footer />
            </>
        )
    }

    export default Component;
    ```
  </Fragment>
  <Fragment slot="astro">
    ```astro title="StarCount.astro"
    ---
    import Header from "./header";
    import Footer from "./footer";
    import "./layout.css";

    const res = await fetch('https://api.github.com/repos/withastro/astro')
    const json = await res.json()
    const message = json.message;
    const stars = json.stargazers_count || 0;
    ---
    <Header />
    <p class="banner">Astro has {stars} ğŸ§‘â€ğŸš€</p>
    <Footer />

    <style>
      .banner {
        background-color: #f4f4f4; 
        padding: 1em 1.5em;
        text-align: center;
        margin-bottom: 1em;
      }
    <style>
    ```
  </Fragment>
</AstroJSXTabs>

### è¿ç§»å¸ƒå±€æ–‡ä»¶

ä½ å¯èƒ½ä¼šå‘ç°ä»æŠŠä½ çš„ Next.js å¸ƒå±€å’Œæ¨¡æ¿è½¬æ¢ä¸º [Astro å¸ƒå±€ç»„ä»¶](/zh-cn/core-concepts/layouts/)å¼€å§‹ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚

Next æœ‰ä¸¤ç§ä¸åŒçš„æ–¹æ³•æ¥åˆ›å»ºå¸ƒå±€æ–‡ä»¶ï¼Œæ¯ç§æ–¹æ³•å¤„ç†å¸ƒå±€çš„æ–¹å¼éƒ½ä¸ Astro ä¸åŒï¼š

- `pages` ç›®å½•

- [`/app` ç›®å½• (beta ç‰ˆæœ¬)](https://beta.nextjs.org/docs/routing/pages-and-layouts#layouts)

æ¯ä¸ª Astro é¡µé¢éƒ½æ˜ç¡®è¦æ±‚æœ‰ `<html>`ã€`<head>` å’Œ `<body>` æ ‡ç­¾ï¼Œæ‰€ä»¥åœ¨ä¸åŒçš„é¡µé¢ä¸­é‡å¤ä½¿ç”¨ä¸€ä¸ªå¸ƒå±€æ–‡ä»¶æ˜¯å¾ˆå¸¸è§çš„ã€‚Astro ä½¿ç”¨ä¸€ä¸ª [`<slot />`](/zh-cn/core-concepts/astro-components/#æ’æ§½) ä½œä¸ºé¡µé¢å†…å®¹ï¼Œä¸éœ€è¦å¯¼å…¥è¯­å¥ã€‚æ³¨æ„æ ‡å‡†çš„ HTML æ¨¡æ¿ï¼Œä»¥åŠå¯¹ `<head>` çš„ç›´æ¥è®¿é—®ï¼š

```astro title="src/layouts/Layout.astro"
---
---
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<title>Astro</title>
	</head>
	<body>
    <!-- ç”¨ä½ ç°æœ‰çš„å¸ƒå±€æ¨¡æ¿æ¥åŒ…è£¹æ’æ§½å…ƒç´  -->
		<slot />
	</body>
</html>
```

#### è¿ç§» Next.js çš„ `page` ç›®å½•

ä½ çš„ Next é¡¹ç›®å¯èƒ½æœ‰ä¸€ä¸ª `pages/_document.jsx` æ–‡ä»¶ï¼Œå®ƒå¯¼å…¥äº†ä¸€äº› React ç»„ä»¶æ¥å®šåˆ¶ä½ çš„åº”ç”¨ç¨‹åºçš„ `<head>`ï¼š

```jsx title="pages/_document.jsx"
import Document, { Html, Head, Main, NextScript } from "next/document";

export default class MyDocument extends Document {
  render() {
    return (
      <Html lang="en">
        <Head>
          <link rel="icon" href="/favicon.ico" />
        </Head>
        <body>
          <Main />
          <NextScript />
        </body>
      </Html>
    );
  }
}
```

1. å¼€å‘ä¸€ä¸ªæ–°çš„åªè¿”å› JSX çš„ Astro å¸ƒå±€æ–‡ä»¶ã€‚

2. ç”¨ `<html>`ã€`<head>`ã€`<slot>` å’Œå…¶ä»– HTML æ ‡ç­¾æ›¿æ¢ React ç»„ä»¶ã€‚ã€‚


```astro title="src/layouts/Document.astro"
<html lang="en">
	<head>
	    <link rel="icon" href="/favicon.ico" />
	</head>
	<body>
		<slot/>
	</body>
</html>
```

#### è¿ç§» Next.js çš„ `/app` ç›®å½•

Next.js çš„ `app/` ç›®å½•å¸ƒå±€æ–‡ä»¶æ˜¯ç”¨ä¸¤ä¸ªæ–‡ä»¶åˆ›å»ºçš„ï¼šä¸€ä¸ª `layout.jsx` æ–‡ä»¶ç”¨äºå®šåˆ¶ `<html>` å’Œ `<body>` å†…å®¹ï¼Œä¸€ä¸ª `head.jsx` æ–‡ä»¶ç”¨äºå®šåˆ¶ `<head>` å…ƒç´ å†…å®¹ã€‚

```jsx title="app/layout.jsx"
export default function Layout({ children }) {
  return (
    <html lang="en">
      <body>{children}</body>
    </html>
  );
}
```

```jsx title="app/head.jsx"
export default function Head() {
  return (
    <>
      <title>My Page</title>
    </>
  );
}
```

1. å¼€å‘ä¸€ä¸ªæ–°çš„åªè¿”å› JSX çš„ Astro å¸ƒå±€æ–‡ä»¶ã€‚

2. ç”¨ä¸€ä¸ªå•ä¸€çš„ Astro å¸ƒå±€æ–‡ä»¶æ›¿æ¢è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªé¡µé¢å¤–å£³ï¼ˆ`<html>`ã€`<head>` å’Œ `<body>` æ ‡ç­¾ï¼‰å’Œä¸€ä¸ª `<slot/>`ï¼Œè€Œä¸æ˜¯ React çš„ `{children}` propsï¼š

```astro title="src/layouts/Layout.astro"
<html lang="en">
	<head>
	    <title>My Page</title>
	</head>
	<body>
		<slot/>
	</body>
</html>
```

### è¿ç§» Pages å’Œ Posts

åœ¨ Next.js ä¸­ï¼Œä½ çš„æ–‡ç« è¦ä¹ˆåœ¨ `/pages`ï¼Œè¦ä¹ˆåœ¨ `/app/routeName/page.jsx`ã€‚

åœ¨ Astro ä¸­ï¼Œ**ä½ æ‰€æœ‰çš„é¡µé¢å†…å®¹å¿…é¡»åœ¨ `src/`** ä¸­ï¼Œåœ¨ `src/pages` æˆ– `src/content` å…¶ä¸­ã€‚

#### React é¡µé¢

ç°æœ‰çš„ Next JSX (.js) é¡µé¢å°†éœ€è¦ä» JSX æ–‡ä»¶[è½¬æ¢ä¸º .astro é¡µé¢](#æç¤ºå°†-jsx-æ–‡ä»¶è½¬æ¢ä¸º-astro-æ–‡ä»¶)ã€‚ä½ ä¸èƒ½åœ¨ Astro ä¸­ä½¿ç”¨ç°æœ‰çš„ JSX é¡µé¢æ–‡ä»¶ã€‚

è¿™äº› [.astro é¡µé¢](/zh-cn/core-concepts/astro-pages/)å¿…é¡»ä½äº `src/pages/` å†…ï¼Œå¹¶å°†æ ¹æ®å…¶æ–‡ä»¶è·¯å¾„è‡ªåŠ¨ç”Ÿæˆé¡µé¢è·¯ç”±ã€‚

#### Markdown å’Œ MDX é¡µé¢

Astro å†…ç½®äº†å¯¹ Markdown çš„æ”¯æŒå’Œå¯¹ MDX æ–‡ä»¶çš„å¯é€‰æ•´åˆã€‚ä½ å¯ä»¥å¤ç”¨ä»»ä½•ç°æœ‰çš„ [Markdown å’Œ MDX æ–‡ä»¶](/zh-cn/guides/markdown-content/)ï¼Œä½†å®ƒä»¬å¯èƒ½éœ€è¦å¯¹å®ƒä»¬çš„ frontmatter è¿›è¡Œä¸€äº›è°ƒæ•´ï¼Œæ¯”å¦‚æ·»åŠ  [Astro çš„ç‰¹æ®Š `layout` frontmatter å±æ€§](/zh-cn/core-concepts/layouts/#markdownmdx-å¸ƒå±€)ã€‚ä½ å°†ä¸å†éœ€è¦ä¸ºæ¯ä¸ª Markdown ç”Ÿæˆçš„è·¯ç”±æ‰‹åŠ¨åˆ›å»ºé¡µé¢ã€‚è¿™äº›æ–‡ä»¶å¯ä»¥æ”¾åœ¨ `src/pages/` ä¸­ï¼Œåˆ©ç”¨æ–‡ä»¶å³è·¯ç”±çš„ä¼˜åŠ¿è‡ªåŠ¨ç”Ÿæˆã€‚

å¦å¤–ï¼Œä½ å¯ä»¥åœ¨ Astro ä¸­ä½¿ç”¨[å†…å®¹é›†åˆ](/zh-cn/guides/content-collections/)æ¥å­˜å‚¨å’Œç®¡ç†ä½ çš„å†…å®¹ã€‚å½“ä½œä¸ºä¸€ä¸ªé›†åˆçš„ä¸€éƒ¨åˆ†æ—¶ï¼ŒMarkdown å’Œ MDX æ–‡ä»¶å°†åœ¨ `src/content/` çš„æ–‡ä»¶å¤¹ä¸­ã€‚ä½ å°†è‡ªå·±æ£€ç´¢å†…å®¹ï¼Œå¹¶[åŠ¨æ€ç”Ÿæˆè¿™äº›é¡µé¢](/zh-cn/guides/content-collections/#ä»å†…å®¹ç”Ÿæˆè·¯ç”±)ã€‚

### è¿ç§»æµ‹è¯•

ç”±äº Astro è¾“å‡ºçš„æ˜¯åŸå§‹ HTMLï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨æ„å»ºæ­¥éª¤çš„è¾“å‡ºæ¥ç¼–å†™ç«¯åˆ°ç«¯çš„æµ‹è¯•ã€‚å¦‚æœä½ å·²ç»èƒ½å¤ŸåŒ¹é…ä½ çš„ Next ç½‘ç«™çš„æ ‡è®°ï¼Œä»¥å‰å†™çš„ä»»ä½•ç«¯åˆ°ç«¯æµ‹è¯•éƒ½å¯èƒ½å¼€ç®±å³ç”¨ã€‚æµ‹è¯•åº“ï¼Œå¦‚ Jest å’Œ React æµ‹è¯•åº“ï¼Œå¯ä»¥è¢«å¯¼å…¥å¹¶ç”¨äº Astro æµ‹è¯•ä½ çš„ React ç»„ä»¶ã€‚

å‚è§ Astro çš„[æµ‹è¯•æŒ‡å—](/zh-cn/guides/testing/)äº†è§£æ›´å¤šã€‚

## å‚è€ƒï¼šå°† Next.js è¯­æ³•è½¬æ¢ä¸º Astro è¯­æ³•

### é“¾æ¥

å°†ä»»ä½• Next `<Link to="">`ï¼Œ`<NavLink>` ç­‰ç»„ä»¶è½¬æ¢æˆ HTML `<a href="">` æ ‡ç­¾ã€‚

```astro del={1} ins={2}
<Link to="/blog">Blog</Link>
<a href="/blog">Blog</a>
```

Astro æ²¡æœ‰ä¸ºé“¾æ¥ä½¿ç”¨ä»»ä½•ç‰¹æ®Šçš„ç»„ä»¶ï¼Œä½†æˆ‘ä»¬æ¬¢è¿ä½ å»ºç«‹ä½ è‡ªå·±çš„ `<Link>` ç»„ä»¶ã€‚ç„¶åä½ å¯ä»¥åƒä½¿ç”¨å…¶ä»–ç»„ä»¶ä¸€æ ·å¯¼å…¥å’Œä½¿ç”¨è¿™ä¸ª `<Link>`ã€‚

```astro title="src/components/Link.astro"
---
const { to } = Astro.props
---
<a href={to}><slot /></a>
```

### å¯¼å…¥

æ›´æ–°ä»»ä½•[æ–‡ä»¶å¯¼å…¥](/zh-cn/guides/imports/)ä»¥å‡†ç¡®å¼•ç”¨ç›¸å¯¹æ–‡ä»¶è·¯å¾„ã€‚è¿™å¯ä»¥é€šè¿‡ [import aliases](/zh-cn/guides/typescript/#å¯¼å…¥åˆ«å) æ¥å®Œæˆï¼Œæˆ–è€…é€šè¿‡å†™å‡ºç›¸å¯¹è·¯å¾„çš„å…¨ç§°ã€‚

è¯·æ³¨æ„ï¼Œ".astro "å’Œå…¶ä»–ä¸€äº›æ–‡ä»¶ç±»å‹å¿…é¡»ä»¥å…¶å®Œæ•´çš„æ–‡ä»¶æ‰©å±•åå¯¼å…¥ã€‚

```astro title="src/pages/authors/Fred.astro"
---
import Card from `../../components/Card.astro`
---
<Card />
```

### è½¬æ¢ Next çš„ Children Props åˆ° Astro

å°†ä»»ä½• `{children}` çš„å®ä¾‹è½¬æ¢ä¸º Astro çš„ `<slot />`ã€‚Astro ä¸éœ€è¦æ¥æ”¶ `{children}` ä½œä¸ºä¸€ä¸ªå‡½æ•° propï¼Œå¹¶ä¼šè‡ªåŠ¨åœ¨ `<slot />` ä¸­æ¸²æŸ“ child å†…å®¹ã€‚

```astro title="src/components/MyComponent" del={3-9} ins={11-13}
---
---
export default function MyComponent(props) { 
    return (
      <div>
        {props.children}
      </div>
    );  
}

<div>
  <slot />
</div>
```

å¯ä»¥ä½¿ç”¨[å‘½åæ’æ§½](/zh-cn/core-concepts/astro-components/#å‘½åæ’æ§½)å°†æœ‰å¤šä¸ªå­ç»„ä»¶çš„ React ç»„ä»¶è¿ç§»åˆ° Astro ç»„ä»¶ã€‚

å‚è€ƒæ›´å¤šå…³äº [Astro ä¸­å…·ä½“çš„ `<slot />` ç”¨æ³•](/zh-cn/core-concepts/astro-components/#æ’æ§½)ã€‚

### è½¬æ¢ Next çš„æ•°æ®è·å–åˆ° Astro

å°† `getStaticProps()` ä¸­ä»»ä½•å®ä¾‹è½¬æ¢ä¸º `Astro.glob()` æˆ– `getCollection()`/`getEntryBySlug()`ï¼Œä»¥ä¾¿è®¿é—®é¡¹ç›®ä¸­å…¶ä»–æ–‡ä»¶çš„æ•°æ®ã€‚ä¸ºäº†[è·å–è¿œç¨‹æ•°æ®](/zh-cn/guides/data-fetching/)ï¼Œä½¿ç”¨ `fetch()`ã€‚

è¿™äº›æ•°æ®è¯·æ±‚æ˜¯åœ¨ Astro ç»„ä»¶çš„ frontmatter ä¸­æ‰§è¡Œçš„ï¼Œå¹¶ä½¿ç”¨ top-level awaitã€‚

```astro title="src/pages/index.astro"
---
import { getCollection } from 'astro:content';

// è·å–æ‰€æœ‰ `src/content/blog/` çš„å…¥å£
const allBlogPosts = await getCollection('blog');

// è·å–æ‰€æœ‰ `src/pages/posts/` çš„å…¥å£
const allPosts = await Astro.glob('../pages/posts/*.md');

const response = await fetch('https://randomuser.me/api/');
const data = await response.json();
const randomUser = data.results[0];
---
```

æŸ¥çœ‹æ›´å¤šå…³äº[ç”¨ `Astro.glob()` å¯¼å…¥æœ¬åœ°æ–‡ä»¶](/zh-cn/guides/imports/#astroglob)ï¼Œ[ä½¿ç”¨ Collections API æŸ¥è¯¢](/zh-cn/guides/content-collections/#æŸ¥è¯¢é›†åˆ)æˆ–[è·å–è¿œç¨‹æ•°æ®](/zh-cn/guides/data-fetching/)ã€‚

### è½¬æ¢ Next çš„æ ·å¼åˆ° Astro

ä½ å¯èƒ½éœ€è¦ç”¨ Astro ä¸­å…¶ä»–å¯ç”¨çš„ CSS é€‰é¡¹æ¥æ›¿æ¢ä»»ä½• [CSS-in-JS åº“](https://github.com/withastro/astro/issues/4432)ï¼ˆä¾‹å¦‚ styled-componentsï¼‰ã€‚

å¦‚æœæœ‰å¿…è¦ï¼Œå°†ä»»ä½•å†…è”æ ·å¼å¯¹è±¡ï¼ˆ`style={{ fontWeight: "bold" }}`ï¼‰è½¬æ¢æˆå†…è” HTML æ ·å¼å±æ€§ï¼ˆ`style="font-weight:bold;"`ï¼‰ã€‚æˆ–è€…ï¼Œä½¿ç”¨ [Astro `<style>`æ ‡ç­¾](/zh-cn/guides/styling/#åœ¨-astro-è¿›è¡Œè®¾è®¡)å®ç° scoped CSS stylesã€‚

```astro title="src/components/Card.astro" del={1} ins={2}
<div style={{backgroundColor: `#f4f4f4`, padding: `1em`}}>{message}</div>
<div style="background-color: #f4f4f4; padding: 1em;">{message}</div>
```

åœ¨å®‰è£…äº† [Tailwind é›†æˆ](/zh-cn/guides/integrations-guide/tailwind/)ä¹‹åï¼Œå°±æ”¯æŒ Tailwindã€‚ä¸éœ€è¦å¯¹ä½ ç°æœ‰çš„ Tailwind ä»£ç è¿›è¡Œä»»ä½•ä¿®æ”¹

æŸ¥çœ‹æ›´å¤šå…³äº[åœ¨ Astro ä¸­è®¾è®¡æ ·å¼](/zh-cn/guides/styling/) çš„ä¿¡æ¯ã€‚

### è½¬æ¢ Next çš„ å›¾åƒæ’ä»¶åˆ° Astro
 
æ ¹æ®æƒ…å†µåœ¨ä½ çš„ React ç»„ä»¶ä¸­å°†ä»»ä½• Next çš„ `<Image />` ç»„ä»¶è½¬æ¢ä¸º [Astro è‡ªå·±çš„å›¾åƒé›†æˆç»„ä»¶](/zh-cn/guides/images/#image--astroassets)æˆ–è€…è½¬åŒ–æˆ[æ ‡å‡†çš„ HTML `<img>` / JSX `<img />` æ ‡ç­¾](/zh-cn/guides/images/#æ¡†æ¶ç»„ä»¶ä¸­çš„å›¾åƒ)ã€‚

Astro çš„ `<Image />` ç»„ä»¶åªèƒ½åœ¨ `.astro` å’Œ `.mdx` æ–‡ä»¶ä¸­å·¥ä½œã€‚æŸ¥çœ‹è¯¥ç»„ä»¶å¯ç”¨çš„[å®Œæ•´ç»„ä»¶å±æ€§åˆ—è¡¨](/zh-cn/guides/images/#å±æ€§)ï¼Œå¹¶æ³¨æ„å®ƒä¸ Next çš„å±æ€§æœ‰ä¸€äº›ä¸åŒã€‚

```astro title="src/pages/index.astro"
---
import { Image } from 'astro:assets';
import rocket from '../assets/rocket.png';
---
<Image src={rocket} alt="å¤ªç©ºä¸­çš„ç«ç®­é£èˆ¹ã€‚" />
<img src={rocket.src} alt="å¤ªç©ºä¸­çš„ç«ç®­é£èˆ¹ã€‚">
```

åœ¨ React (`.jsx`) ç»„ä»¶ä¸­ï¼Œä½¿ç”¨æ ‡å‡†çš„ JSX çš„å›¾ç‰‡è¯­æ³•ï¼ˆ`<img />`ï¼‰ã€‚Astro ä¸ä¼šä¼˜åŒ–è¿™äº›å›¾ç‰‡ï¼Œä½†ä½ ä¹Ÿå¯ä»¥å®‰è£…å’Œä½¿ç”¨ NPM åŒ…ä»¥æå‡çµæ´»æ€§ã€‚

ä½ å¯ä»¥åœ¨å›¾åƒæŒ‡å—ä¸­äº†è§£æ›´å¤šå…³äº[åœ¨ Astro ä¸­ä½¿ç”¨å›¾åƒ](/zh-cn/guides/images/)çš„ä¿¡æ¯ã€‚

## ç¤ºä¾‹ï¼šæ•°æ®è¯·æ±‚

ä¸‹é¢æ˜¯ä¸€ä¸ª Next.js PokÃ©dex æ•°æ®è·å–è½¬æ¢ä¸º Astro çš„ä¾‹å­ã€‚
    
`pages/index.js` ä½¿ç”¨ [REST PokÃ©API](https://pokeapi.co/) è·å–å¹¶æ˜¾ç¤ºå‰ 151 ä¸ªç¥å¥‡å®è´çš„åˆ—è¡¨ã€‚

ä¸‹é¢æ˜¯å¦‚ä½•åœ¨ `src/pages/index.astro` ä¸­é‡æ–°åˆ›å»ºï¼Œå°† `getStaticProps()` æ›¿æ¢ä¸º `fetch()`ã€‚

1. å®šä¹‰è¦è¿”å›çš„ JSXã€‚

    ```jsx title="pages/index.js" {6-18}
    import Link from 'next/link'
    import styles from '../styles/poke-list.module.css';

    export default function Home({ pokemons }) {
        return (
            <>
                <ul className={`plain-list ${styles.pokeList}`}>
                    {pokemons.map((pokemon) => (
                        <li className={styles.pokemonListItem} key={pokemon.name}>
                            <Link className={styles.pokemonContainer} as={`/pokemon/${pokemon.name}`} href="/pokemon/[name]">
                                <p className={styles.pokemonId}>No. {pokemon.id}</p>
                                <img className={styles.pokemonImage} src={`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${pokemon.id}.png`} alt={`${pokemon.name} picture`}></img>
                                <h2 className={styles.pokemonName}>{pokemon.name}</h2>
                            </Link>
                        </li>
                    ))}
                </ul>
            </>
        )
    }

    export const getStaticProps = async () => {
        const res = await fetch("https://pokeapi.co/api/v2/pokemon?limit=151")
        const resJson = await res.json();
        const pokemons = resJson.results.map(pokemon => {
            const name = pokemon.name;
            // https://pokeapi.co/api/v2/pokemon/1/
            const url = pokemon.url;
            const id = url.split("/")[url.split("/").length - 2];
            return {
                name,
                url,
                id
            }
        });
        return {
            props: {
                pokemons,
            },
        }
    }
    ```

2. åˆ›å»º `src/pages/index.astro`

    ä½¿ç”¨ Next å‡½æ•°çš„è¿”å›å€¼ã€‚å°†ä»»ä½• Next æˆ– React è¯­æ³•è½¬æ¢æˆ Astroï¼ŒåŒ…æ‹¬æ”¹å˜ä»»ä½• [HTML å…¨å±€å±æ€§](https://developer.mozilla.org/zh-CN/docs/Web/HTML/Global_attributes)çš„å¤§å°å†™ã€‚

    æ³¨æ„ï¼š

    - `.map` å°±å·²ç»å¯ä»¥äº†

    - `className` å˜æˆ `class`ã€‚

    - `<Link>` å˜æˆ `<a>`ã€‚

    - `<> </>` åœ¨ Astro æ¨¡æ¿è®¾è®¡ä¸­æ˜¯ä¸éœ€è¦çš„ã€‚

    ```astro title="src/pages/index.astro" "class" "</a>" "<a"
    ---
    ---
    <ul class="plain-list pokeList">
        {pokemons.map((pokemon) => (
            <li class="pokemonListItem" key={pokemon.name}>
                <a class="pokemonContainer" href={`/pokemon/${pokemon.name}`}>
                    <p class="pokemonId">No. {pokemon.id}</p>
                    <img class="pokemonImage" src={`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${pokemon.id}.png`} alt={`${pokemon.name} picture`}/>
                    <h2 class="pokemonName">{pokemon.name}</h2>
                </a>
            </li>
        ))}
    </ul>
    ```

3. æ·»åŠ ä»»ä½•éœ€è¦çš„ imports, props, å’Œ JavaScript

    æ³¨æ„ï¼š

    - ä¸å†éœ€è¦ `getStaticProps` å‡½æ•°ã€‚æ¥è‡ª API çš„æ•°æ®ç›´æ¥åœ¨ä»£ç æ …æ ä¸­è¢«è·å–ã€‚
    - ä¸€ä¸ª `<Layout>` ç»„ä»¶è¢«å¯¼å…¥å¹¶åŒ…è£¹äº†é¡µé¢æ¨¡æ¿ã€‚

    ```astro ins={2,4-16,19,31} title="src/pages/index.astro"
    ---
    import Layout from '../layouts/layout.astro';

    const res = await fetch("https://pokeapi.co/api/v2/pokemon?limit=151");
    const resJson = await res.json();
    const pokemons = resJson.results.map(pokemon => {
        const name = pokemon.name;
        // https://pokeapi.co/api/v2/pokemon/1/
        const url = pokemon.url;
        const id = url.split("/")[url.split("/").length - 2];
        return {
            name,
            url,
            id
        }
    });
    ---

    <Layout>
      <ul class="plain-list pokeList">
          {pokemons.map((pokemon) => (
              <li class="pokemonListItem" key={pokemon.name}>
                  <a class="pokemonContainer" href={`/pokemon/${pokemon.name}`}>
                      <p class="pokemonId">No. {pokemon.id}</p>
                      <img class="pokemonImage" src={`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${pokemon.id}.png`} alt={`${pokemon.name} picture`}/>
                      <h2 class="pokemonName">{pokemon.name}</h2>
                  </a>
              </li>
          ))}
      </ul>
    </Layout>
    ```

## ç¤¾åŒºèµ„æº

- è§†é¢‘ï¼š[ä» NextJS åˆ° Astroï¼šæ›´å¤šçš„æ§åˆ¶æƒ = æ›´å¿«çš„ç½‘ç«™](https://www.youtube.com/watch?v=PSzCtdM20Fc)ã€‚

- è§†é¢‘ï¼š[Astro å¦‚ä½•ä½¿æˆ‘çš„ç½‘ç«™é€Ÿåº¦æå‡ 100 å€](https://www.youtube.com/watch?v=cOxA3kMYtkM)ã€‚

- åšå®¢ï¼š[è¿ç§» Next.js é¡¹ç›®è‡³ Astro](https://johnzanussi.com/posts/nextjs-to-astro-migration)ã€‚

- åšå®¢ï¼š[ä» NextJS åˆ° Astro](https://vanntile.com/blog/next-to-astro)ã€‚
- åšå®¢ï¼š[è½¬æ¢ Next.js åˆ° Astro](https://ericclemmons.com/blog/converting-nextjs-to-astro)ã€‚
