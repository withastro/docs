---
title: Ghost & Astro
description: ä½¿ç”¨ Ghost ä½œä¸º CMS å°†å…§å®¹æ·»åŠ åˆ°ä½ çš„ Astro é¡¹ç›®
type: cms
stub: false
service: Ghost
i18nReady: true
---

import FileTree from '~/components/FileTree.astro'
import PackageManagerTabs from '~/components/tabs/PackageManagerTabs.astro'

[Ghost](https://github.com/TryGhost/Ghost) æ˜¯ä¸€ä¸ªåŸºäº Node.js æ„å»ºçš„å¼€æºæ— å¤´ CMSï¼ˆContent Management Systemï¼Œå†…å®¹ç®¡ç†ç³»ç»Ÿï¼‰ã€‚

## ä¸ Astro é›†æˆ
åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ [Ghost content API](https://ghost.org/docs/content-api/) å°†æ•°æ®è¿æ¥åˆ°ä½ çš„ Astro é¡¹ç›®ä¸­ã€‚

### å‰ç½®å‡†å¤‡
åœ¨å¼€å§‹ä½¿ç”¨ä¹‹å‰ï¼Œä½ éœ€è¦ï¼š 

1. **ä¸€ä¸ª Astro é¡¹ç›®** - å¦‚æœæ²¡æœ‰ Astro é¡¹ç›®, æˆ‘ä»¬çš„ [å®‰è£…æŒ‡å—](/zh-cn/install/auto/) å°†åœ¨çŸ­æ—¶é—´å†…å¸®åŠ©ä½ å¯åŠ¨å¹¶è¿è¡Œã€‚

2. **ä¸€ä¸ª Ghost ç«™ç‚¹** - å‡å®šä½ å·²ç»é…ç½®äº†ä¸€ä¸ªä½¿ç”¨ Ghost çš„ç«™ç‚¹ã€‚å¦‚æœæ²¡æœ‰ï¼Œå¯ä»¥æ ¹æ® [Ghost æœ¬åœ°é…ç½®](https://ghost.org/docs/install/local/)åœ¨æœ¬åœ°ç¯å¢ƒé…ç½®ä¸€ä¸ªã€‚

3. **å†…å®¹ API å¯†é’¥ï¼ˆContent API Keyï¼‰** - ä½ å¯ä»¥åœ¨ GHOST ç«™ç‚¹çš„ `Settings > Integrations` æ‰¾åˆ°ä½ çš„ `Content API key`ã€‚


### é…ç½®

åœ¨ä½ çš„é¡¹ç›®çš„æ ¹ç›®å½•ä¸­åˆ›å»ºæˆ–ç¼–è¾‘ä¸€ä¸ª `.env` æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å˜é‡ä»¥å°†ä½ çš„ Ghost ç«™ç‚¹è¿æ¥åˆ° Astroï¼š

```ini title=".env"
CONTENT_API_KEY=YOUR_API_KEY
```

ç°åœ¨ï¼Œä½ åº”è¯¥èƒ½å¤Ÿåœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨è¿™ä¸ªç¯å¢ƒå˜é‡äº†ã€‚

å¦‚æœä½ å¸Œæœ›è®©ä½ çš„ç¯å¢ƒå˜é‡æ‹¥æœ‰æ™ºèƒ½æç¤ºï¼ˆIntelliSenseï¼‰ï¼Œä½ å¯ä»¥åœ¨ `src/` ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `env.d.ts` æ–‡ä»¶ï¼Œå¹¶åƒè¿™æ ·é…ç½® `ImportMetaEnv`ï¼š

```ts title="src/env.d.ts"
interface ImportMetaEnv {
  readonly CONTENT_API_KEY: string;
}
```
:::tip[æç¤º]
äº†è§£æ›´å¤šå…³äº[ä½¿ç”¨ç¯å¢ƒå˜é‡](/zh-cn/guides/environment-variables/)å’Œ Astro ä¸­çš„ `.env` æ–‡ä»¶çš„ä¿¡æ¯ã€‚
:::

ä½ çš„æ ¹ç›®å½•ç°åœ¨åº”è¯¥åŒ…å«ä»¥ä¸‹æ–°æ–‡ä»¶ï¼š

<FileTree title="Project Structure">
- src/
  - **env.d.ts**
- **.env**
- astro.config.mjs
- package.json
</FileTree>

### å®‰è£…ä¾èµ–é¡¹

é€‰æ‹©ä½ å–œæ¬¢çš„åŒ…ç®¡ç†å™¨è¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£… Ghost å®˜æ–¹çš„å†…å®¹ API å®¹å™¨ [`@tryghost/content-api`](https://www.npmjs.com/package/@tryghost/content-api) è¿æ¥ Ghost:

<PackageManagerTabs>
  <Fragment slot="npm">
  ```shell
  npm install @tryghost/content-api
  ```
  </Fragment>
  <Fragment slot="pnpm">
  ```shell
  pnpm install @tryghost/content-api
  ```
  </Fragment>
  <Fragment slot="yarn">
  ```shell
  yarn add @tryghost/content-api
  ```
  </Fragment>
</PackageManagerTabs>

## ä½¿ç”¨ Astro å’Œ Ghost åˆ›å»ºåšå®¢

é€šè¿‡ä¸Šé¢çš„è®¾ç½®ï¼Œä½ ç°åœ¨å¯ä»¥åˆ›å»ºä¸€ä¸ªä½¿ç”¨ Ghost ä½œä¸º CMS çš„åšå®¢ã€‚

### å‰ç½®å‡†å¤‡

1. ä¸€ä¸ª Ghost åšå®¢ 
2. ä¸€ä¸ªä¸ [Ghost content API](https://www.npmjs.com/package/@tryghost/content-api) é›†æˆçš„ Astro é¡¹ç›® - è¯·å‚è§ [ä¸ Astro é›†æˆ](/zh-cn/guides/cms/ghost/#ä¸-astro-é›†æˆ) äº†è§£å¦‚ä½•å°† Astro é¡¹ç›®ä¸ Ghost é›†æˆçš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚

è¿™ä¸ªä¾‹å­å°†åˆ›å»ºä¸€ä¸ªç´¢å¼•é¡µé¢ï¼Œå¹¶åˆ—å‡ºæ‰€æœ‰æ–‡ç« ï¼Œé€šè¿‡å¸–å­çš„é“¾æ¥æŒ‡å‘åˆ°åŠ¨æ€ç”Ÿæˆçš„å•ä¸ªæ–‡ç« é¡µé¢ã€‚

### è·å–æ•°æ®

ä½ å¯ä»¥ä½¿ç”¨ Ghost content API åŒ…è·å–ä½ çš„ç«™ç‚¹æ•°æ®ã€‚

é¦–å…ˆï¼Œåœ¨ `lib` ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `ghost.ts` æ–‡ä»¶ã€‚

<FileTree title="Project Structure">
- src/
  - lib/
    - **ghost.ts**
  - pages/
    - index.astro
- astro.config.mjs
- package.json
</FileTree>

ä½¿ç”¨ Ghost ä»ªè¡¨ç›˜çš„é›†æˆé¡µé¢ä¸Šçš„ API å¯†é’¥ï¼Œé€šè¿‡ Ghost API åˆå§‹åŒ–ä¸€ä¸ª API å®ä¾‹ã€‚

```ts title="src/lib/ghost.ts"

import GhostContentAPI from '@tryghost/content-api';

// ä½¿ç”¨ç«™ç‚¹å‡­è¯åˆ›å»º API å®ä¾‹
export const ghostClient = new GhostContentAPI({
    url: 'http://127.0.0.1:2368', // è¿™æ˜¯ Ghost ç«™ç‚¹è¿è¡Œåœ¨æœ¬åœ°ç¯å¢ƒä¸­çš„é»˜è®¤ URL
    key: import.meta.env.CONTENT_API_KEY,
    version: 'v5.0',
});

```


### æ˜¾ç¤ºæ–‡ç« åˆ—è¡¨

æ­¤é¡µé¢ `src/pages/index.astro` å°†æ˜¾ç¤ºä¸€ä¸ªæ–‡ç« åˆ—è¡¨ï¼Œæ¯ä¸ªæ–‡ç« éƒ½åŒ…å«ä¸€ä¸ªæè¿°å’ŒæŒ‡å‘å…¶æ–‡ç« é¡µé¢é“¾æ¥ã€‚

<FileTree title="Project Structure">
- src/
 - lib/
    - ghost.ts
  - pages/
    - **index.astro**
- astro.config.mjs
- package.json
</FileTree>

åœ¨ Astro çš„ frontmatter ä¸­å¯¼å…¥ `ghostClient()`ï¼Œä½¿ç”¨ `posts.browse()` æ–¹æ³•è®¿é—® Ghost çš„åšå®¢æ–‡ç« ã€‚è®¾ç½® `limit: all` ä»¥æ£€ç´¢æ‰€æœ‰æ–‡ç« ã€‚
```astro title="src/pages/index.astro"
---
import { ghostClient } from '../lib/ghost';
const posts = await ghostClient.posts
    .browse({
        limit: 'all',
    })
    .catch((err) => {
        console.error(err);
    });
---
```

é€šè¿‡ content API è·å–çš„æ•°æ®å°†ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡æ•°ç»„ï¼Œå…¶ä¸­åŒ…å«[æ¯ç¯‡æ–‡ç« çš„å±æ€§](https://ghost.org/docs/content-api/#posts)ï¼Œä¾‹å¦‚ï¼š
- `title` - æ–‡ç« çš„æ ‡é¢˜
- `html` - æ–‡ç« å†…å®¹çš„ HTML æ¸²æŸ“
- `feature_image` - æ–‡ç« å›¾ç‰‡çš„ URL
- `slug` - æ–‡ç« çš„ slug

ä½¿ç”¨è¿”å›çš„ `posts` å¯¹è±¡æ•°ç»„å³å¯ä»¥åœ¨ç´¢å¼•é¡µä¸Šæ˜¾ç¤ºæ‰€æœ‰åšå®¢æ–‡ç« åˆ—è¡¨ã€‚

```astro title="src/pages/index.astro"
---
import { ghostClient } from '../lib/ghost';
const posts = await ghostClient.posts
    .browse({
        limit: 'all',
    })
    .catch((err) => {
        console.error(err);
    });
---

<html lang="en">
    <head>
        <title>Astro + Ghost ğŸ‘»</title>
    </head>
    <body>

        {
            posts.map((post) => (
                <a href={`/post/${post.slug}`}>
                    <h1> {post.title} </h1>
                </a>
            ))
        }
    </body>
</html>
```

### ç”Ÿæˆé¡µé¢

æ­¤é¡µé¢ `src/pages/post/[slug].astro` å°†ä¸ºæ¯ä¸€ç¯‡æ–‡ç« [åŠ¨æ€ç”Ÿæˆä¸€ä¸ªé¡µé¢](/zh-cn/core-concepts/routing/#åŠ¨æ€è·¯ç”±)ã€‚

<FileTree title="Project Structure">
- src/
 - lib/
    -  ghost.ts
  - pages/
    - index.astro
    - post/
      - **[slug].astro**
- astro.config.mjs
- package.json
</FileTree>

å¯¼å…¥ `ghostClient()` ä»¥ä½¿ç”¨ `posts.browse()` è®¿é—®åšå®¢æ–‡ç« ï¼Œå¹¶å°†ä¸€ç¯‡æ–‡ç« ä½œä¸º props è¿”å›ç»™ä½ çš„æ¯ä¸ªåŠ¨æ€è·¯ç”±ã€‚

```astro title="src/pages/post/[slug].astro"
---
import { ghostClient } from '../../lib/ghost';

export async function getStaticPaths() {
    const posts = await ghostClient.posts
        .browse({
            limit: 'all',
        })
        .catch((err) => {
            console.error(err);
        });

    return posts.map((post) => {
        return {
            params: {
                slug: post.slug,
            },
            props: {
                post: post,
            },
        };
    });
}

const { post } = Astro.props;
---
```

é€šè¿‡åˆ›å»ºæ¨¡ç‰ˆä»¥ä½¿ç”¨æ¯ä¸ª `post` å¯¹è±¡çš„å±æ€§åŠ¨æ€ç”Ÿæˆæ¯ç¯‡æ–‡ç« çš„é¡µé¢ã€‚

```astro title="src/pages/post/[slug].astro" ins={24-37}
---
import { ghostClient } from '../../lib/ghost';
export async function getStaticPaths() {
    const posts = await ghostClient.posts
        .browse({
            limit: 'all',
        })
        .catch((err) => {
            console.error(err);
        });
    return posts.map((post) => {
        return {
            params: {
                slug: post.slug,
            },
            props: {
                post: post,
            },
        };
    });
}
const { post } = Astro.props;
---
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>{post.title}</title>
    </head>
    <body>
        <img src={post.feature_image} alt={post.title} />

        <h1>{post.title}</h1>
        <p>{post.reading_time} min read</p>

        <Fragment set:html={post.html} />
    </body>
</html>
```
:::note[æ³¨æ„]
`<Fragment />` æ˜¯ä¸€ä¸ªå†…ç½®çš„ Astro ç»„ä»¶ï¼Œå®ƒå¯ä»¥è®©ä½ é¿å…ä¸å¿…è¦çš„å®¹å™¨å…ƒç´ çš„å½±å“ã€‚ è¿™åœ¨ä»CMSï¼ˆä¾‹å¦‚Ghostæˆ–[WordPress](/zh-cn/guides/cms/wordpress/)ï¼‰è·å– HTML æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚
:::

### å‘å¸ƒä½ çš„ç½‘ç«™
è¦éƒ¨ç½²ä½ çš„ç½‘ç«™ï¼Œè¯·è®¿é—®æˆ‘ä»¬çš„[éƒ¨ç½²æŒ‡å—](/zh-cn/guides/deploy/)ï¼Œå¹¶æŒ‰ç…§ä½ æ›´å–œæ¬¢çš„æ‰˜ç®¡æœåŠ¡æä¾›å•†çš„éƒ¨ç½²è¯´æ˜è¿›è¡Œæ“ä½œã€‚
## ç¤¾åŒºèµ„æº 

- ä½ ä¹Ÿå¯ä»¥ä»è¿™ä¸ª [Astro Ghost å¯åŠ¨å™¨](https://github.com/PhilDL/astro-starter-ghost) å¼€å§‹é›†æˆä½ çš„ Ghost ä¸ Astroã€‚
- Andre Carrera å†™äº†[ä¸€ç¯‡åšå®¢æ–‡ç« ](https://andr.ec/posts/astro-ghost-blog/)ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Ghost çš„ SDK ä»¥åœ¨ä½ çš„ Astro é¡¹ç›®ä¸­åµŒå…¥æ–‡ç« å’Œé¢„è§ˆã€‚


