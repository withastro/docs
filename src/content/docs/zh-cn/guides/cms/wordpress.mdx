---
title: æ— å¤´ï¼ˆheadlessï¼‰æ¨¡å¼çš„ WordPress ä¸ Astro
description: å°† WordPress ä½œä¸º CMS å¹¶ä¸ºä½ çš„ Astro é¡¹ç›®æ·»åŠ å†…å®¹
type: cms
stub: false
service: WordPress
i18nReady: true
---
import FileTree from '~/components/FileTree.astro'

[WordPress](https://wordpress.org/) æ˜¯ä¸€ä¸ªå†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œè™½ç„¶å®ƒåŒ…å«äº†è‡ªå·±çš„å‰ç«¯ï¼Œä½†ä¹Ÿå¯ä»¥ä½œä¸ºæ— å¤´ï¼ˆheadlessï¼‰CMS ç”¨äºä¸ºä½ çš„ Astro é¡¹ç›®æä¾›å†…å®¹ã€‚

## ä¸ Astro é›†æˆ

WordPress è‡ªå¸¦äº†å†…ç½®çš„ [WordPress REST API](https://developer.wordpress.org/rest-api/)ï¼Œç”¨äºå°†ä½ çš„ WordPress æ•°æ®è¿æ¥åˆ° Astroã€‚ä½ è¿˜å¯ä»¥é€‰æ‹©åœ¨ä½ çš„ç«™ç‚¹ä¸Šå®‰è£… [WPGraphQL](https://wordpress.org/plugins/wp-graphql/) æ¥ä½¿ç”¨ GraphQLã€‚

### å‰æœŸå‡†å¤‡

åœ¨å¼€å§‹å‰ï¼Œä½ éœ€è¦å…·å¤‡ä»¥ä¸‹æ¡ä»¶ï¼š

1. **ä¸€ä¸ª Astro é¡¹ç›®** - å¦‚æœä½ è¿˜æ²¡æœ‰ Astro é¡¹ç›®ï¼Œæˆ‘ä»¬çš„[å®‰è£…æŒ‡å—](/zh-cn/install/auto/)å¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿä¸Šæ‰‹ï¼›
2. **ä¸€ä¸ª WordPress ç«™ç‚¹** - ä½ çš„ç«™ç‚¹çš„ REST API æ˜¯ `[YOUR_SITE]/wp-json/wp/v2/`ï¼Œå¹¶åœ¨ä»»ä½• WordPress ç«™ç‚¹ä¸Šéƒ½æ˜¯é»˜è®¤æä¾›çš„ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨[æœ¬åœ°ç¯å¢ƒä¸Šå®‰è£… WordPress](https://wordpress.org/support/article/installing-wordpress-on-your-own-computer/)ã€‚

### è®¾ç½®å‡­æ®

ä½ çš„ WordPress REST API é»˜è®¤æƒ…å†µä¸‹å¯ä»¥è¢«å¤–éƒ¨è¯·æ±‚ä»¥æ— éœ€è®¤è¯çš„æ–¹å¼è·å–æ•°æ®ã€‚è¿™ä¸è®©ç”¨æˆ·ä¿®æ”¹ä½ çš„æ•°æ®æˆ–ç«™ç‚¹è®¾ç½®ï¼Œè€Œæ˜¯è®©ä½ åœ¨ Astro é¡¹ç›®ä¸­ä½¿ç”¨æ•°æ®è€Œæ— éœ€ä»»ä½•å‡­æ®ã€‚

å¦‚æœéœ€è¦çš„è¯ï¼Œä½ å¯ä»¥é€‰æ‹©[è¦æ±‚èº«ä»½éªŒè¯](https://developer.wordpress.org/rest-api/frequently-asked-questions/#require-authentication-for-all-requests)ã€‚

### è·å–æ•°æ®

é€šè¿‡ä½ çš„ç«™ç‚¹å”¯ä¸€çš„ REST API URL å’Œå†…å®¹çš„è·¯ç”±æ¥è·å–ä½ çš„ WordPress æ•°æ®ï¼ˆå¯¹äºåšå®¢ï¼Œé€šå¸¸æ˜¯ `posts`ï¼‰ï¼Œç„¶åä½ å¯ä»¥ä½¿ç”¨ Astro çš„ `set:html={}` æŒ‡ä»¤æ¥æ¸²æŸ“æ•°æ®å±æ€§ã€‚

ä¾‹å¦‚ï¼Œè¦æ˜¾ç¤ºä¸€ä¸ªå¸–å­æ ‡é¢˜å’Œå†…å®¹çš„åˆ—è¡¨ï¼š

```astro title="src/pages/index.astro
---
const res = await fetch("https://[ä½ çš„ç«™ç‚¹]/wp-json/wp/v2/posts")
const posts = await res.json()
---
<h1>Astro + WordPress ğŸš€</h1>
{
  posts.map((post) => (
      <h2 set:html={post.title.rendered} />
      <p set:html={post.content.rendered} />
  ))
}
```

WordPress REST API åŒ…å«äº† [å…¨å±€å‚æ•°](https://developer.wordpress.org/rest-api/using-the-rest-api/global-parameters/)ï¼Œå¦‚ `_fields` å’Œ `embed`ã€‚

æ‰€ä»¥å¯é€šè¿‡æ­¤ API è·å–å¤§é‡çš„æ•°æ®ï¼Œä½ ä¹Ÿå¯èƒ½å¸Œæœ›ä»…è·å–ç‰¹å®šå­—æ®µã€‚ä½ å¯ä»¥é€šè¿‡åœ¨ API URL ä¸­æ·»åŠ  [`_fields`](https://developer.wordpress.org/rest-api/using-the-rest-api/global-parameters/#_fields) å‚æ•°æ¥é™åˆ¶å“åº”ï¼Œä¾‹å¦‚ï¼š`[ä½ çš„ç«™ç‚¹]/wp/v2/posts?_fields=author, id, excerpt, title, link`ã€‚

API è¿˜å¯ä»¥è¿”å›ä¸æ–‡ç« ç›¸å…³çš„å†…å®¹ï¼Œä¾‹å¦‚çˆ¶çº§æ–‡ç« çš„é“¾æ¥æˆ–è¯„è®ºã€‚ä½ å¯ä»¥åœ¨ API URL ä¸­æ·»åŠ  [`_embed`](https://developer.wordpress.org/rest-api/using-the-rest-api/global-parameters/#_embed) å‚æ•°ï¼ˆä¾‹å¦‚ `[ä½ çš„ç«™ç‚¹]/wp/v2/posts?_embed`ï¼‰ï¼Œæç¤ºæœåŠ¡å™¨åœ¨å“åº”ä¸­åŒ…å«è¿™äº›åµŒå…¥èµ„æºã€‚

## ä½¿ç”¨ WordPress å’Œ Astro æ„å»ºåšå®¢

è¯¥ç¤ºä¾‹ä» [https://norian.studio/dinosaurs/](https://norian.studio/dinosaurs/) çš„å…¬å…± WordPress API ä¸­è·å–æ•°æ®ã€‚è¯¥ WordPress ç«™ç‚¹å°†æœ‰å…³ä¸ªåˆ«æé¾™çš„ä¿¡æ¯å­˜å‚¨åœ¨ `dinos` è·¯å¾„ä¸‹ï¼Œå°±åƒåšå®¢å°†ä¸ªåˆ«åšæ–‡å­˜å‚¨åœ¨ `posts` è·¯å¾„ä¸‹ä¸€æ ·ã€‚

è¯¥ç¤ºä¾‹å±•ç¤ºå¦‚ä½•åœ¨ Astro ä¸­å¤åˆ¶æ­¤ç«™ç‚¹ç»“æ„ï¼šä¸€ä¸ªç´¢å¼•é¡µé¢ï¼Œåˆ—å‡ºæé¾™å¹¶é“¾æ¥è‡³åŠ¨æ€ç”Ÿæˆçš„ä¸ªåˆ«æé¾™é¡µé¢ã€‚

:::note
è¦åœ¨ WordPress API ä¸­ä½¿ç”¨[è‡ªå®šä¹‰æ–‡ç« ç±»å‹ï¼ˆCPTï¼‰](https://learn.wordpress.org/lesson-plan/custom-post-types/)ï¼ˆä¸åªæ˜¯ `post` å’Œ `page`ï¼‰ï¼Œä½ éœ€è¦åœ¨ WordPress ä»ªè¡¨ç›˜ä¸­[è¿›è¡Œé…ç½®](https://stackoverflow.com/questions/48536646/how-can-i-get-data-from-custom-post-type-using-wp-rest-api)ï¼Œæˆ–åœ¨ WordPress ä¸­[ä¸ºè‡ªå®šä¹‰å†…å®¹ç±»å‹æ·»åŠ  REST API æ”¯æŒ](https://developer.wordpress.org/rest-api/extending-the-rest-api/adding-rest-api-support-for-custom-content-types/)ã€‚

è¯¥ç¤ºä¾‹ä»å·²è®¾ç½®å’Œå…¬å¼€è‡³ REST API çš„ WordPress ç«™ç‚¹è·å–æ•°æ®ã€‚
:::

### æ˜¾ç¤º WordPress æ–‡ç« åˆ—è¡¨

é¡µé¢ `src/pages/index.astro` åˆ—å‡ºæ¯ä¸ªæé¾™çš„æè¿°ï¼Œå¹¶æä¾›é“¾æ¥è‡³å…¶ç‹¬ç«‹é¡µé¢ã€‚

<FileTree title="Project Structure">
- src/
  - pages/
    - **index.astro**
    - dinos/
      - [slug].astro
- astro.config.mjs
- package.json
</FileTree>

é€šè¿‡ API è·å–çš„å¯¹è±¡åŒ…å«ä»¥ä¸‹å±æ€§ï¼š

-  `title.rendered` - åŒ…å«æ–‡ç« æ ‡é¢˜çš„ HTML æ¸²æŸ“ç»“æœï¼›
-  `content.rendered` - åŒ…å«æ–‡ç« å†…å®¹çš„ HTML æ¸²æŸ“ç»“æœï¼›
-  `slug` - åŒ…å«æ–‡ç« çš„ slugï¼ˆç”¨äºç”ŸæˆåŠ¨æ€ç”Ÿæˆçš„ä¸ªåˆ«æé¾™é¡µé¢çš„é“¾æ¥ï¼‰ã€‚

```astro title="/src/pages/index.astro"
---
import Layout from "../layouts/Layout.astro"

let res = await fetch("https://norian.studio/wp-json/wp/v2/dinos")
let posts = await res.json();
---
<Layout title="Dinos!">
  <section>
    <h1>List of Dinosaurs</h1>
    {
      posts.map((post) => (
        <article>
          <h2>
            <a href={`/dinos/${post.slug}/`} set:html={post.title.rendered} />
          </h2>
          <Fragment set:html={post.content.rendered} />
        </article>
      ))
    }
  </section>
</Layout>
```

### ä½¿ç”¨ WordPress API ç”Ÿæˆé¡µé¢

é¡µé¢ `src/pages/dinos/[slug].astro` ä¸ºæ¯ä¸ªæé¾™ [åŠ¨æ€ç”Ÿæˆäº†ä¸€ä¸ªé¡µé¢](/zh-cn/core-concepts/routing/#åŠ¨æ€è·¯ç”±)ã€‚

```astro title="/src/pages/dinos/[slug].astro"
---
import Layout from '../../layouts/Layout.astro';

const { slug } = Astro.params;

let res = await fetch(`https://norian.studio/wp-json/wp/v2/dinos?slug=${slug}`)
let [post] = await res.json();

// The getStaticPaths() ä»…é€‚ç”¨äºé™æ€çš„ Astro ç«™ç‚¹ï¼Œ
// åœ¨ SSR æ¨¡å¼ä¸‹ä½ ä¸éœ€è¦ä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚
export async function getStaticPaths() {
  let data = await fetch("https://norian.studio/wp-json/wp/v2/dinos")
  let posts = await data.json();

  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post: post },
  }));
}
---
<Layout title={post.title.rendered}>
  <article>
    <h1 set:html={post.title.rendered} />
    <Fragment set:html={post.content.rendered} />
  </article>
</Layout>
```

### è¿”å›åµŒå…¥èµ„æº

`_embed` æŸ¥è¯¢å‚æ•°ä¼šå‘Šè¯‰æœåŠ¡å™¨è¿”å›ç›¸å…³çš„ï¼ˆåµŒå…¥çš„ï¼‰èµ„æºã€‚

```astro title="src/pages/dinos/[slug].astro" /&_embed/
---
const { slug } = Astro.params;

let res = await fetch(`https://norian.studio/wp-json/wp/v2/dinos?slug=${slug}&_embed`)
let [post] = await res.json();
---
```

è¿”å› `_embedded['wp:featuredmedia']['0'].media_details.sizes.medium.source_url` å±æ€§ï¼Œå¹¶ç”¨äºåœ¨æ¯ä¸ªæé¾™é¡µé¢ä¸Šæ˜¾ç¤ºç‰¹è‰²å›¾åƒã€‚ï¼ˆå¯å°† `medium` æ›¿æ¢ä¸ºä½ æ‰€éœ€çš„å›¾åƒå°ºå¯¸ã€‚ï¼‰

```astro title="/src/pages/dinos/[slug].astro" {3}
<Layout title={post.title.rendered}>
  <article>
    <img src={post._embedded['wp:featuredmedia']['0'].media_details.sizes.medium.source_url} />
    <h1 set:html={post.title.rendered} />
    <Fragment set:html={post.content.rendered} />
  </article>
</Layout>
```

### å‘å¸ƒä½ çš„ç½‘ç«™

è¦éƒ¨ç½²ä½ çš„ç½‘ç«™ï¼Œè¯·è®¿é—®æˆ‘ä»¬çš„[éƒ¨ç½²æŒ‡å—](/zh-cn/guides/deploy/)ï¼Œå¹¶æŒ‰ç…§ä½ åå¥½çš„æ‰˜ç®¡æä¾›å•†çš„æ­¥éª¤è¯´æ˜è¿›è¡Œæ“ä½œã€‚

## ç¤¾åŒºèµ„æº

-  Chris Bongers çš„æ–‡ç«  [ä½¿ç”¨ WordPress ä½œä¸ºæ— å¤´ CMS æ„å»º Astro ç½‘ç«™](https://blog.openreplay.com/building-an-astro-website-with-wordpress-as-a-headless-cms/)ã€‚
-  Ben Holmes çš„ç›´æ’­ [ä½¿ç”¨ Astro å’Œ WordPress è¿›è¡Œæ„å»º](https://www.youtube.com/watch?v=Jstqgklvfnc)ã€‚
-  Jeff Everhart çš„æ–‡ç«  [ä½¿ç”¨ Astro æ„å»ºæ— å¤´ WordPress ç½‘ç«™](https://developers.wpengine.com/blog/building-a-headless-wordpress-site-with-astro)ã€‚
-  Darko Bozhinovski çš„æ–‡ç«  [Astro å’Œ WordPress ä½œä¸º API](https://darko.io/posts/wp-as-an-api/)ã€‚


## ç”Ÿäº§ç¯å¢ƒç½‘ç«™

ä»¥ä¸‹ç½‘ç«™åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ Astro + WordPressï¼š

-  Rafid Muhymin Wafi çš„ [Soft Hard System](https://softhardsystem.com/) â€” [GitHub ä¸Šçš„æºä»£ç ](https://github.com/RafidMuhymin/softhardsystem)ã€‚
-  Anindo Neel Dutta çš„ [Dinos!](https://wc-dinos.netlify.app/) â€” [GitHub ä¸Šçš„æºä»£ç ](https://github.com/leen-neel/astro-wordpress)ã€‚
