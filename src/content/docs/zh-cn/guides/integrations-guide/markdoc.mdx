---
type: integration
title: '@astrojs/markdoc'
description: å­¦ä¹ å¦‚ä½•åœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨ @astrojs/markdoc é›†æˆã€‚
sidebar:
  label: Markdoc
githubIntegrationURL: 'https://github.com/withastro/astro/tree/main/packages/integrations/markdoc/'
category: other
i18nReady: true
---

import { FileTree } from '@astrojs/starlight/components';
import PackageManagerTabs from '~/components/tabs/PackageManagerTabs.astro';
import { Steps } from '@astrojs/starlight/components';
import ReadMore from '~/components/ReadMore.astro';

è¿™ä¸ª **[Astro é›†æˆ][astro-integration]** å…è®¸ä½¿ç”¨ [Markdoc](https://markdoc.dev/) æ¥åˆ›å»ºç»„ä»¶ã€é¡µé¢å’Œå†…å®¹é›†åˆæ¡ç›®ã€‚

## ä¸ºä»€ä¹ˆæ˜¯ Markdocï¼Ÿ

Markdoc å…è®¸ä½ ä½¿ç”¨ [Astro ç»„ä»¶][astro-components] å¢å¼º Markdownã€‚å¦‚æœä½ å·²ç»ä½¿ç”¨ Markdoc ç¼–å†™äº†ç°æœ‰å†…å®¹ï¼Œæ­¤é›†æˆå…è®¸ä½ ä½¿ç”¨å†…å®¹é›†åˆå°†è¿™äº›æ–‡ä»¶å¸¦åˆ° Astro é¡¹ç›®ä¸­ã€‚

## å®‰è£…

Astro åŒ…å«äº†ä¸€ä¸ª `astro add` å‘½ä»¤ï¼Œç”¨äºè‡ªåŠ¨è®¾ç½®å®˜æ–¹é›†æˆã€‚å¦‚æœä½ æ„¿æ„ï¼Œå¯ä»¥æ”¹ä¸º[æ‰‹åŠ¨å®‰è£…é›†æˆ](#æ‰‹åŠ¨å®‰è£…)ã€‚

åœ¨æ–°çš„ç»ˆç«¯çª—å£ä¸­è¿è¡Œä¸‹é¢å…¶ä¸­ä¸€ä¸ªå‘½ä»¤ã€‚

<PackageManagerTabs>
  <Fragment slot="npm">
  ```sh
  npx astro add markdoc
  ```
  </Fragment>
  <Fragment slot="pnpm">
  ```sh
  pnpm astro add markdoc
  ```
  </Fragment>
  <Fragment slot="yarn">
  ```sh
  yarn astro add markdoc
  ```
  </Fragment>
</PackageManagerTabs>

å¦‚æœä½ é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œ[è¯·éšæ—¶åœ¨ GitHub ä¸Šå‘æˆ‘ä»¬æŠ¥å‘Š](https://github.com/withastro/astro/issues)ï¼Œå¹¶å°è¯•ä¸‹é¢çš„æ‰‹åŠ¨å®‰è£…æ­¥éª¤ã€‚

### æ‰‹åŠ¨å®‰è£…

é¦–å…ˆï¼Œå®‰è£… `@astrojs/markdoc` åŒ…ï¼š

<PackageManagerTabs>
  <Fragment slot="npm">
  ```sh
  npm install @astrojs/markdoc
  ```
  </Fragment>
  <Fragment slot="pnpm">
  ```sh
  pnpm add @astrojs/markdoc
  ```
  </Fragment>
  <Fragment slot="yarn">
  ```sh
  yarn add @astrojs/markdoc
  ```
  </Fragment>
</PackageManagerTabs>

ç„¶åï¼Œä½¿ç”¨ `integrations` å±æ€§å°†é›†æˆåº”ç”¨åˆ°ä½ çš„ `astro.config.*` æ–‡ä»¶ä¸­ï¼š

```js ins="markdoc()" title="astro.config.mjs" ins={2}
import { defineConfig } from 'astro/config';
import markdoc from '@astrojs/markdoc';
export default defineConfig({
  // ...
  integrations: [markdoc()],
});
```

### VS Code ç¼–è¾‘å™¨é›†æˆ

å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ VS Codeï¼Œæœ‰ä¸€ä¸ªå®˜æ–¹çš„ [Markdoc è¯­è¨€æ‰©å±•](https://marketplace.visualstudio.com/items?itemName=Stripe.markdoc-language-support)ï¼Œå…¶ä¸­åŒ…æ‹¬äº†å¯¹é…ç½®æ ‡ç­¾çš„è¯­æ³•é«˜äº®å’Œè‡ªåŠ¨å®ŒæˆåŠŸèƒ½ã€‚[åœ¨ GitHub ä¸ŠæŸ¥çœ‹è¯­è¨€æœåŠ¡å™¨](https://github.com/markdoc/language-server.git)ä»¥è·å–æ›´å¤šä¿¡æ¯ã€‚

è¦è®¾ç½®æ‰©å±•ï¼Œéœ€åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªåä¸º `markdoc.config.json` çš„æ–‡ä»¶ï¼Œå¹¶åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š

```json title="markdoc.config.json"
[
  {
    "id": "my-site",
    "path": "src/content",
    "schema": {
      "path": "markdoc.config.mjs",
      "type": "esm",
      "property": "default",
      "watch": true
    }
  }
]
```
å°† `markdoc.config.mjs` è®¾ç½®ä¸ºä½ çš„é…ç½®æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ `schema` å¯¹è±¡ï¼Œé€šè¿‡ `path` å±æ€§å®šä¹‰ä½ çš„ Markdoc æ–‡ä»¶å­˜å‚¨çš„ä½ç½®ã€‚ç”±äº Markdoc æ˜¯ä¸“é—¨ç”¨äºå†…å®¹é›†åˆçš„ï¼Œä½ å¯ä»¥ä½¿ç”¨ `src/content`ã€‚

## ç”¨æ³•

Markdoc æ–‡ä»¶åªèƒ½åœ¨å†…å®¹é›†åˆä¸­ä½¿ç”¨ã€‚ä½¿ç”¨ `.mdoc` æ‰©å±•åå°†æ¡ç›®æ·»åŠ åˆ°ä»»ä½•å†…å®¹é›†åˆä¸­ï¼š

<FileTree>
- src/
  - content/
    - docs/
      - why-markdoc.mdoc
      - quick-start.mdoc
</FileTree>

ç„¶åï¼Œä½¿ç”¨ [å†…å®¹é›†åˆ API](/zh-cn/guides/content-collections/#æŸ¥è¯¢é›†åˆ) æŸ¥è¯¢ä½ çš„é›†åˆï¼š

```astro title="src/pages/why-markdoc.astro"
---
import { getEntryBySlug } from 'astro:content';

const entry = await getEntryBySlug('docs', 'why-markdoc');
const { Content } = await entry.render();
---

<!--ä½¿ç”¨ `data` è®¿é—® frontmatter å±æ€§`-->
<h1>{entry.data.title}</h1>
<!--ä½¿ç”¨ Content ç»„ä»¶æ¸²æŸ“ Markdoc å†…å®¹-->
<Content />
```

<ReadMore>äº†è§£æ›´å¤šå…³äº [Astro å†…å®¹é›†åˆæ–‡æ¡£][astro-content-collections] çš„ä¿¡æ¯ã€‚</ReadMore>

## ä¼ é€’ Markdoc å˜é‡

ä½ å¯èƒ½éœ€è¦å‘ä½ çš„å†…å®¹ä¼ é€’ [å˜é‡][markdoc-variables]ã€‚è¿™åœ¨ä¼ é€’æœåŠ¡ç«¯æ¸²æŸ“å‚æ•°å¦‚ A/B æµ‹è¯•æ—¶éå¸¸æœ‰ç”¨ã€‚

å˜é‡å¯ä»¥é€šè¿‡ `Content` ç»„ä»¶ä½œä¸º props ä¼ é€’ï¼š

```astro title="src/pages/why-markdoc.astro"
---
import { getEntryBySlug } from 'astro:content';
const entry = await getEntryBySlug('docs', 'why-markdoc');
const { Content } = await entry.render();
---
<!--å°† `abTest` å‚æ•°ä½œä¸ºå˜é‡ä¼ é€’-->
<Content abTestGroup={Astro.params.abTestGroup} />
```

ç°åœ¨ï¼Œ`abTestGroup` å¯ä»¥åœ¨ `docs/why-markdoc.mdoc` ä¸­ä½œä¸ºä¸€ä¸ªå˜é‡ä½¿ç”¨ï¼š

```md title="src/content/docs/why-markdoc.mdoc"
{% if $abTestGroup === 'image-optimization-lover' %}

è®©æˆ‘æ¥å‘Šè¯‰ä½ å…³äºå›¾åƒä¼˜åŒ–çš„ä¿¡æ¯...

{% /if %}
```

è¦ä½¿ä¸€ä¸ªå˜é‡å¯¹æ‰€æœ‰ Markdoc æ–‡ä»¶å…¨å±€å¯ç”¨ï¼Œä½ å¯ä»¥ä½¿ç”¨ `markdoc.config.mjs|ts` ä¸­çš„ `variables` å±æ€§ï¼š

```js title="markdoc.config.mjs"
import { defineMarkdocConfig } from '@astrojs/markdoc/config';

export default defineMarkdocConfig({
  variables: {
    environment: process.env.IS_PROD ? 'prod' : 'dev',
  },
});
```

### ä»ä½ çš„ Markdoc å†…å®¹ä¸­è®¿é—® frontmatter

è¦è®¿é—® frontmatterï¼Œä½ å¯ä»¥åœ¨æ¸²æŸ“å†…å®¹çš„åœ°æ–¹å°†æ¡ç›®çš„ `data` å±æ€§ä½œä¸ºä¸€ä¸ªå˜é‡ä¼ é€’ï¼š

```astro title="src/pages/why-markdoc.astro"
---
import { getEntry } from 'astro:content';
const entry = await getEntry('docs', 'why-markdoc');
const { Content } = await entry.render();
---
<Content frontmatter={entry.data} />
```

ç°åœ¨ï¼Œè¿™å¯ä»¥åœ¨ä½ çš„ Markdoc ä¸­ä½œä¸º `$frontmatter` è®¿é—®ã€‚

## æ¸²æŸ“ç»„ä»¶

`@astrojs/markdoc` æä¾›äº†é…ç½®é€‰é¡¹ï¼Œä»¥ä½¿ç”¨ Markdoc çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå¹¶å°† UI ç»„ä»¶è¿æ¥åˆ°ä½ çš„å†…å®¹ã€‚

### å°† Astro ç»„ä»¶ä½œä¸º Markdoc æ ‡ç­¾

ä½ å¯ä»¥é…ç½® [Markdoc æ ‡ç­¾][markdoc-tags]ï¼Œå°†å…¶æ˜ å°„åˆ° `.astro` ç»„ä»¶ã€‚ä½ å¯ä»¥é€šè¿‡åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `markdoc.config.mjs|ts` æ–‡ä»¶å¹¶é…ç½® `tag` å±æ€§æ¥æ·»åŠ æ–°çš„æ ‡ç­¾ã€‚

è¿™ä¸ªä¾‹å­æ¸²æŸ“äº†ä¸€ä¸ª `Aside` ç»„ä»¶ï¼Œå¹¶å…è®¸ä¼ é€’ä¸€ä¸ª `type` å­—ç¬¦ä¸²å±æ€§ï¼š

```js title="markdoc.config.mjs"
import { defineMarkdocConfig, component } from '@astrojs/markdoc/config';

export default defineMarkdocConfig({
  tags: {
    aside: {
      render: component('./src/components/Aside.astro'),
      attributes: {
        // Markdoc è¦æ±‚æ¯ä¸ªå±æ€§éƒ½æœ‰ç±»å‹å®šä¹‰ã€‚
        // è¿™äº›åº”è¯¥åæ˜ ä½ æ­£åœ¨æ¸²æŸ“çš„ç»„ä»¶çš„ `Props` ç±»å‹
        // æŸ¥çœ‹ Markdoc çš„å±æ€§å®šä¹‰æ–‡æ¡£ï¼š
        // https://markdoc.dev/docs/attributes#defining-attributes
        type: { type: String },
      },
    },
  },
});
```

ç°åœ¨ï¼Œè¿™ä¸ªç»„ä»¶å¯ä»¥åœ¨ä½ çš„ Markdoc æ–‡ä»¶ä¸­ä½¿ç”¨ `{% aside %}` æ ‡ç­¾ã€‚å­å…ƒç´ å°†è¢«ä¼ é€’ç»™ä½ çš„ç»„ä»¶çš„é»˜è®¤æ’æ§½ï¼š

```md
# æ¬¢è¿æ¥åˆ° Markdoc ğŸ‘‹

{% aside type="tip" %}

ä½¿ç”¨åƒè¿™ç§èŠ±å“¨çš„â€œasideâ€æ ‡ç­¾ä¸ºä½ çš„æ–‡æ¡£æ·»åŠ ä¸€äº› _èŠ±æ´»_ã€‚

{% /aside %}
```

### ä½¿ç”¨å®¢æˆ·ç«¯ UI ç»„ä»¶

æ ‡ç­¾å’ŒèŠ‚ç‚¹ä»…é™äº `.astro` æ–‡ä»¶ã€‚ä¸ºäº†åœ¨ Markdoc ä¸­åµŒå…¥å®¢æˆ·ç«¯ UI ç»„ä»¶ï¼Œ[ä½¿ç”¨ä¸€ä¸ªåŒ…è£… `.astro` ç»„ä»¶æ¥æ¸²æŸ“ä¸€ä¸ªæ¡†æ¶ç»„ä»¶](/zh-cn/guides/framework-components/#åµŒå¥—æ¡†æ¶ç»„ä»¶)ï¼Œå¹¶é…åˆä½ æ‰€éœ€çš„ `client:` æŒ‡ä»¤ã€‚

è¿™ä¸ªä¾‹å­ä½¿ç”¨ `ClientAside.astro` ç»„ä»¶åŒ…è£…äº†ä¸€ä¸ª React çš„ `Aside.tsx` ç»„ä»¶ï¼š

```astro title="src/components/ClientAside.astro"
---
import Aside from './Aside';
---
<Aside {...Astro.props} client:load />
```

ç°åœ¨ï¼Œè¿™ä¸ª Astro ç»„ä»¶å¯ä»¥ä¼ é€’ç»™é…ç½®ä¸­ä»»ä½• [æ ‡ç­¾][markdoc-tags] æˆ– [èŠ‚ç‚¹][markdoc-nodes] çš„ `render` å±æ€§ï¼š

```js title="markdoc.config.mjs"
import { defineMarkdocConfig, component } from '@astrojs/markdoc/config';

export default defineMarkdocConfig({
  tags: {
    aside: {
      render: component('./src/components/ClientAside.astro'),
      attributes: {
        type: { type: String },
      },
    },
  },
});
```
### ä» npm åŒ…å’Œ TypeScript æ–‡ä»¶ä¸­ä½¿ç”¨ Astro ç»„ä»¶

ä½ å¯èƒ½éœ€è¦ä½¿ç”¨ä» TypeScript æˆ– JavaScript æ–‡ä»¶ä¸­ä»¥å‘½åå¯¼å‡ºå½¢å¼æš´éœ²çš„ Astro ç»„ä»¶ã€‚è¿™åœ¨ä½¿ç”¨ npm åŒ…å’Œè®¾è®¡ç³»ç»Ÿæ—¶å¾ˆå¸¸è§ã€‚

ä½ å¯ä»¥å°†å¯¼å…¥åç§°ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ç»™ `component()` å‡½æ•°ï¼š

```js title="markdoc.config.mjs"
import { defineMarkdocConfig, component } from '@astrojs/markdoc/config';

export default defineMarkdocConfig({
  tags: {
    tabs: {
      render: component('@astrojs/starlight/components', 'Tabs'),
    },
  },
});
```

è¿™å°†åœ¨å†…éƒ¨ç”Ÿæˆä»¥ä¸‹å¯¼å…¥è¯­å¥ï¼š
```ts
import { Tabs } from '@astrojs/starlight/components';
```

## Markdoc éƒ¨åˆ†å†…å®¹

`{% partial %}` æ ‡ç­¾å…è®¸ä½ åœ¨ Markdoc å†…å®¹ä¸­æ¸²æŸ“å…¶ä»–çš„ `.mdoc` æ–‡ä»¶ã€‚

è¿™å¯¹äºè·¨å¤šä¸ªæ–‡æ¡£çš„é‡ç”¨å†…å®¹å¾ˆæœ‰ç”¨ï¼Œå¹¶ä¸”å…è®¸ä½ æ‹¥æœ‰ä¸éµå¾ªä½ çš„å†…å®¹é›†åˆæ¨¡å¼çš„ `.mdoc` å†…å®¹æ–‡ä»¶ã€‚

:::tip
å¯¹äºéƒ¨åˆ†æ–‡ä»¶æˆ–ç›®å½•ï¼Œä½¿ç”¨ä¸‹åˆ’çº¿ `_` ä½œä¸ºå‰ç¼€ã€‚è¿™å°†ä»å†…å®¹é›†åˆæŸ¥è¯¢ä¸­æ’é™¤éƒ¨åˆ†å†…å®¹ã€‚
:::

æ­¤ç¤ºä¾‹å±•ç¤ºäº†ä¸€ä¸ª Markdoc éƒ¨åˆ†å†…å®¹ï¼Œç”¨äºåœ¨åšå®¢é›†åˆæ¡ç›®ä¸­ä½¿ç”¨çš„é¡µè„šï¼š

```md title="src/content/blog/_footer.mdoc"
ç¤¾äº¤é“¾æ¥ï¼š

- [Twitter / X](https://twitter.com/astrodotbuild)
- [Discord](https://astro.build/chat)
- [GitHub](https://github.com/withastro/astro)
```

ä½¿ç”¨ `{% partial %}` æ ‡ç­¾åœ¨åšå®¢æ–‡ç« æ¡ç›®çš„åº•éƒ¨æ¸²æŸ“é¡µè„šã€‚ä½¿ç”¨ `file` å±æ€§å¹¶æä¾›æ–‡ä»¶è·¯å¾„ï¼Œå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„æˆ–è€…å¯¼å…¥åˆ«åï¼š

```md title="src/content/blog/post.mdoc" ins='file="_footer.mdoc"'
# æˆ‘çš„åšå®¢æ–‡ç« 

{% partial file="./_footer.mdoc" %}
```

## è¯­æ³•é«˜äº®

`@astrojs/markdoc` æä¾›äº† [Shiki](https://shiki.style) å’Œ [Prism](https://github.com/PrismJS) æ‰©å±•æ¥é«˜äº®ä½ çš„ä»£ç å—ã€‚

### Shiki

ä½¿ç”¨ `extends` å±æ€§å°† `shiki()` æ‰©å±•åº”ç”¨åˆ°ä½ çš„ Markdoc é…ç½®ä¸­ï¼Œä½ å¯ä»¥é€‰æ‹©ä¼ é€’ä¸€ä¸ª shiki é…ç½®å¯¹è±¡ï¼š

```js title="markdoc.config.mjs"
import { defineMarkdocConfig } from '@astrojs/markdoc/config';
import shiki from '@astrojs/markdoc/shiki';

export default defineMarkdocConfig({
  extends: [
    shiki({
      // ä» Shiki çš„å†…ç½®ä¸»é¢˜ä¸­è¿›è¡Œé€‰æ‹©ï¼ˆæˆ–æ·»åŠ ä½ è‡ªå·±çš„ä¸»é¢˜ï¼‰
      // é»˜è®¤ï¼š'github-dark'
      // https://shiki.style/themes
      theme: 'dracula',
      // å¯ç”¨å•è¯æŠ˜å ä»¥é˜²æ­¢æ°´å¹³æ»šåŠ¨
      // é»˜è®¤ï¼šfalse
      wrap: true,
      // ä¼ å…¥è‡ªå®šä¹‰è¯­è¨€
      // æ³¨æ„ï¼šShiki å†…ç½®äº†è®¸å¤šçš„ langsï¼ŒåŒ…æ‹¬ `.astro`ï¼
      // https://shiki.style/languages
      langs: [],
    }),
  ],
});
```

### Prism

ä½¿ç”¨ `extends` å±æ€§å°† `prism()` æ‰©å±•åº”ç”¨åˆ°ä½ çš„ Markdoc é…ç½®ä¸­ã€‚

```js title="markdoc.config.mjs"
import { defineMarkdocConfig } from '@astrojs/markdoc/config';
import prism from '@astrojs/markdoc/prism';

export default defineMarkdocConfig({
  extends: [prism()],
});
```

<ReadMore>è¦äº†è§£å¦‚ä½•é…ç½® Prism æ ·å¼è¡¨ï¼Œ[è¯·çœ‹æˆ‘ä»¬çš„è¯­æ³•é«˜äº®æŒ‡å—](/zh-cn/guides/syntax-highlighting/#æ·»åŠ -prism-æ ·å¼è¡¨)ã€‚</ReadMore>

## è‡ªå®šä¹‰ Markdoc èŠ‚ç‚¹ / å…ƒç´ 

ä½ å¯èƒ½æƒ³è¦å°†æ ‡å‡†çš„ Markdown å…ƒç´ ï¼Œæ¯”å¦‚æ®µè½å’ŒåŠ ç²—æ–‡æœ¬ï¼Œæ¸²æŸ“ä¸º Astro ç»„ä»¶ã€‚ä¸ºæ­¤ï¼Œä½ å¯ä»¥é…ç½®ä¸€ä¸ª [Markdoc èŠ‚ç‚¹][markdoc-nodes]ã€‚å¦‚æœæŸä¸ªèŠ‚ç‚¹æ¥æ”¶åˆ°å±æ€§ï¼Œè¿™äº›å±æ€§å°†ä½œä¸ºç»„ä»¶çš„ props å¯ç”¨ã€‚

è¿™ä¸ªä¾‹å­ä½¿ç”¨ä¸€ä¸ªè‡ªå®šä¹‰çš„ `Quote.astro` ç»„ä»¶æ¥æ¸²æŸ“å¼•ç”¨å—ï¼š

```js title="markdoc.config.mjs"
import { defineMarkdocConfig, nodes, component } from '@astrojs/markdoc/config';

export default defineMarkdocConfig({
  nodes: {
    blockquote: {
      ...nodes.blockquote, // åº”ç”¨ Markdoc çš„é»˜è®¤çš„å…¶ä»–é…ç½®é¡¹
      render: component('./src/components/Quote.astro'),
    },
  },
});
```

<ReadMore>æŸ¥çœ‹ [Markdoc èŠ‚ç‚¹æ–‡æ¡£](https://markdoc.dev/docs/nodes#built-in-nodes) äº†è§£æ‰€æœ‰å†…ç½®èŠ‚ç‚¹åŠå…¶å±æ€§ã€‚</ReadMore>

### è‡ªå®šä¹‰æ ‡é¢˜

`@astrojs/markdoc` è‡ªåŠ¨ä¸ºä½ çš„æ ‡é¢˜æ·»åŠ é”šç‚¹é“¾æ¥ï¼Œå¹¶ [é€šè¿‡å†…å®¹é›†åˆ API ç”Ÿæˆä¸€ä¸ª `headings` åˆ—è¡¨](/zh-cn/guides/content-collections/#æ¸²æŸ“æ­£æ–‡å†…å®¹)ã€‚ä¸ºäº†è¿›ä¸€æ­¥è‡ªå®šä¹‰æ ‡é¢˜çš„æ¸²æŸ“æ–¹å¼ï¼Œä½ å¯ä»¥åº”ç”¨ä¸€ä¸ª Astro ç»„ä»¶ä½œä¸º Markdoc èŠ‚ç‚¹ã€‚

è¿™ä¸ªä¾‹å­ä½¿ç”¨ `render` å±æ€§æ¸²æŸ“äº†ä¸€ä¸ª `Heading.astro` ç»„ä»¶ï¼š

```js title="markdoc.config.mjs"
import { defineMarkdocConfig, nodes, component } from '@astrojs/markdoc/config';

export default defineMarkdocConfig({
  nodes: {
    heading: {
      ...nodes.heading, // ä¿ç•™é»˜è®¤çš„é”šç‚¹é“¾æ¥ç”Ÿæˆ
      render: component('./src/components/Heading.astro'),
    },
  },
});
```

æ‰€æœ‰ Markdown æ ‡é¢˜å°†æ¸²æŸ“ `Heading.astro` ç»„ä»¶ï¼Œå¹¶å°†ä»¥ä¸‹ `attributes` ä½œä¸ºç»„ä»¶çš„ props ä¼ é€’ï¼š

* `level: number` æ ‡é¢˜çš„çº§åˆ« 1 - 6
* `id: string` ä»æ ‡é¢˜çš„æ–‡æœ¬å†…å®¹ç”Ÿæˆçš„ `id`ã€‚è¿™å¯¹åº”äºç”± [å†…å®¹ `render()` å‡½æ•°](/zh-cn/guides/content-collections/#æ¸²æŸ“æ­£æ–‡å†…å®¹) ç”Ÿæˆçš„ `slug`ã€‚

ä¾‹å¦‚ï¼Œæ ‡é¢˜ `### Level 3 heading!` å°†ä¼ é€’ `level: 3` å’Œ `id: 'level-3-heading'` ä½œä¸ºç»„ä»¶çš„ propsã€‚

### è‡ªå®šä¹‰å›¾ç‰‡ç»„ä»¶

Astro çš„ `<Image />` ç»„ä»¶ä¸èƒ½ç›´æ¥åœ¨ Markdoc ä¸­ä½¿ç”¨ã€‚ä½†æ˜¯ä½ å¯ä»¥é…ç½®ä¸€ä¸ª Astro ç»„ä»¶æ¥è¦†ç›–æ¯æ¬¡ä½¿ç”¨åŸç”Ÿ `![]()` å›¾ç‰‡è¯­æ³•æ—¶çš„é»˜è®¤å›¾ç‰‡èŠ‚ç‚¹ï¼Œæˆ–è€…ä½œä¸ºä¸€ä¸ªè‡ªå®šä¹‰çš„ Markdoc æ ‡ç­¾è®©ä½ å¯ä»¥æŒ‡å®šé¢å¤–çš„å›¾ç‰‡å±æ€§ã€‚

#### è¦†ç›– Markdoc çš„é»˜è®¤å›¾ç‰‡èŠ‚ç‚¹

ä¸ºäº†è¦†ç›–é»˜è®¤å›¾ç‰‡èŠ‚ç‚¹ï¼Œä½ å¯ä»¥é…ç½®ä¸€ä¸ª `.astro` ç»„ä»¶æ¥ä»£æ›¿æ ‡å‡†çš„ `<img>` æ¸²æŸ“ã€‚

<Steps>
1. æ„å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„ `MarkdocImage.astro` ç»„ä»¶ï¼Œå°†ä½ çš„å›¾ç‰‡çš„å¿…è¦çš„ `src` å’Œ `alt` å±æ€§ä¼ é€’ç»™ `<Image />` ç»„ä»¶ï¼š

    ```astro title="src/components/MarkdocImage.astro"
    ---
    import { Image } from "astro:assets";
    interface Props {
      src: ImageMetadata;
      alt: string;
    }
    const { src, alt } = Astro.props;
    ---
    <Image src={src} alt={alt} />
    ```

2. `<Image />` ç»„ä»¶éœ€è¦ä¸ºæ— æ³•ä½¿ç”¨ `![]()` è¯­æ³•æ¥æä¾›çš„è¿œç¨‹å›¾ç‰‡æä¾› `width` å’Œ `height` å±æ€§ã€‚ä¸ºäº†é¿å…åœ¨ä½¿ç”¨è¿œç¨‹å›¾ç‰‡æ—¶å‡ºç°é”™è¯¯ï¼Œå½“å‘ç°è¿œç¨‹ URL `src` å±æ€§æ—¶ï¼Œä¼šæ›´æ–°ä½ çš„ç»„ä»¶å¹¶æ¸²æŸ“æˆæ ‡å‡†çš„ HTML `<img>` æ ‡ç­¾ï¼š

    ```astro title="src/components/MarkdocImage.astro" ins="| string" del={9} ins={10-12}
    ---
    import { Image } from "astro:assets";
    interface Props {
      src: ImageMetadata | string;
      alt: string;
    }
    const { src, alt } = Astro.props;
    ---
    <Image src={src} alt={alt} />
    {
      typeof src === 'string' ? <img src={src} alt={alt} /> : <Image src={src} alt={alt} />
    }
    ```

3. é…ç½® Markdoc æ¥è¦†ç›–é»˜è®¤çš„å›¾ç‰‡èŠ‚ç‚¹å¹¶æ¸²æŸ“ `MarkdocImage.astro`ï¼š

    ```js title="markdoc.config.mjs"
    import { defineMarkdocConfig, nodes, component } from '@astrojs/markdoc/config';

    export default defineMarkdocConfig({
      nodes: {
        image: {
          ...nodes.image, // åº”ç”¨ Markdoc çš„å…¶ä»–é»˜è®¤é€‰é¡¹
          render: component('./src/components/MarkdocImage.astro'),
        },
      },
    });
    ```

4. ç°åœ¨ï¼Œä»»ä½• `.mdoc` æ–‡ä»¶ä¸­çš„åŸç”Ÿå›¾ç‰‡è¯­æ³•éƒ½å°†ä½¿ç”¨ `<Image />` ç»„ä»¶æ¥ä¼˜åŒ–ä½ çš„æœ¬åœ°å›¾ç‰‡ã€‚ä½ ä»ç„¶å¯ä»¥ä½¿ç”¨è¿œç¨‹å›¾ç‰‡ï¼Œä½†æ˜¯å®ƒä»¬å°†ä¸ä¼šè¢« Astro çš„ `<Image />` ç»„ä»¶æ¸²æŸ“ã€‚

    ```md title="src/content/blog/post.mdoc"

    <!-- ç”± <Image /> ä¼˜åŒ–ç»„ä»¶ -->
    ![A picture of a cat](/cat.jpg)

    <!-- æœªä¼˜åŒ–çš„ <img> æ ‡ç­¾ -->
    ![A picture of a dog](https://example.com/dog.jpg) 
    ```
</Steps>

#### åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„ Markdoc å›¾ç‰‡æ ‡ç­¾

Markdoc çš„ `image` æ ‡ç­¾å…è®¸ä½ åœ¨å›¾ç‰‡ä¸Šè®¾ç½®é¢å¤–çš„å±æ€§ï¼Œè¿™æ˜¯ç”¨ `![]()` è¯­æ³•æ— æ³•å®ç°çš„ã€‚ä¾‹å¦‚ï¼Œè‡ªå®šä¹‰å›¾ç‰‡æ ‡ç­¾å…è®¸ä½ å¯¹éœ€è¦ `width` å’Œ `height` çš„è¿œç¨‹å›¾ç‰‡ä½¿ç”¨ Astro çš„ `<Image />` ç»„ä»¶ã€‚

ä»¥ä¸‹æ­¥éª¤å°†åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„ Markdoc å›¾ç‰‡æ ‡ç­¾ï¼Œä»¥æ˜¾ç¤ºä¸€ä¸ªå¸¦æœ‰æ ‡é¢˜çš„ `<figure>` å…ƒç´ ï¼Œä½¿ç”¨ Astro çš„ `<Image />` ç»„ä»¶æ¥ä¼˜åŒ–å›¾ç‰‡ã€‚

<Steps>
1. åˆ›å»ºä¸€ä¸ª `MarkdocFigure.astro` ç»„ä»¶ï¼Œæ¥æ”¶å¿…è¦çš„å±æ€§å¹¶æ¸²æŸ“ä¸€ä¸ªå¸¦æœ‰æ ‡é¢˜çš„å›¾ç‰‡ï¼š

    ```astro title="src/components/MarkdocFigure.astro"
    ---
    // src/components/MarkdocFigure.astro
    import { Image } from "astro:assets";
    interface Props {
      src: ImageMetadata | string;
      alt: string;
      width: number;
      height: number;
      caption: string;
    }
    const { src, alt, width, height, caption } = Astro.props;
    ---
    <figure>
        <Image {src} {alt} {width} {height}  />
        {caption && <figcaption>{caption}</figcaption>}
    </figure>
    ```

2. é…ç½®ä½ çš„è‡ªå®šä¹‰å›¾ç‰‡æ ‡ç­¾æ¥æ¸²æŸ“ä½ çš„ Astro ç»„ä»¶ï¼š

    ```ts title="markdoc.config.mjs"
    import { component, defineMarkdocConfig, nodes } from '@astrojs/markdoc/config';

    export default defineMarkdocConfig({
      tags: {
        image: {
          attributes: {
            width: {
              type: String,
            },
            height: {
              type: String,
            },
            caption: {
              type: String,
            },
            ...nodes.image.attributes
          },
          render: component('./src/components/MarkdocFigure.astro'),
        },
      },
    });
    ```

3. åœ¨ Markdoc æ–‡ä»¶ä¸­ä½¿ç”¨ `image` æ ‡ç­¾æ¥æ˜¾ç¤ºä¸€ä¸ªå¸¦æœ‰æ ‡é¢˜çš„å›¾å½¢ï¼Œä¸ºä½ çš„ç»„ä»¶æä¾›æ‰€æœ‰å¿…è¦çš„å±æ€§ï¼š

    ```md
    {% image src="./astro-logo.png" alt="Astro Logo" width="100" height="100" caption="a caption!" /%}
    ```
</Steps>

## Markdoc é«˜çº§é…ç½®

`markdoc.config.mjs|ts` æ–‡ä»¶æ¥å— [æ‰€æœ‰ Markdoc é…ç½®é€‰é¡¹](https://markdoc.dev/docs/config)ï¼ŒåŒ…æ‹¬ [æ ‡ç­¾](https://markdoc.dev/docs/tags) å’Œ [å‡½æ•°](https://markdoc.dev/docs/functions)ã€‚

ä½ å¯ä»¥ä» `markdoc.config.mjs|ts` æ–‡ä»¶çš„é»˜è®¤å¯¼å‡ºä¸­ä¼ é€’è¿™äº›é€‰é¡¹ï¼š

```js title="markdoc.config.mjs"
import { defineMarkdocConfig } from '@astrojs/markdoc/config';

export default defineMarkdocConfig({
  functions: {
    getCountryEmoji: {
      transform(parameters) {
        const [country] = Object.values(parameters);
        const countryToEmojiMap = {
          japan: 'ğŸ‡¯ğŸ‡µ',
          spain: 'ğŸ‡ªğŸ‡¸',
          france: 'ğŸ‡«ğŸ‡·',
        };
        return countryToEmojiMap[country] ?? 'ğŸ³';
      },
    },
  },
});
```

ç°åœ¨ï¼Œä½ å¯ä»¥ä»ä»»ä½• Markdoc å†…å®¹æ¡ç›®ä¸­è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼š

```md
Â¡Hola {% getCountryEmoji("spain") %}!
```

<ReadMore> [æŸ¥çœ‹ Markdoc æ–‡æ¡£](https://markdoc.dev/docs/functions#creating-a-custom-function) äº†è§£æ›´å¤šå…³äºåœ¨ä½ çš„å†…å®¹ä¸­ä½¿ç”¨å˜é‡æˆ–å‡½æ•°çš„ä¿¡æ¯ã€‚</ReadMore>

### è®¾ç½®æ ¹ HTML å…ƒç´ 

é»˜è®¤æƒ…å†µä¸‹ï¼ŒMarkdoc ä¼šç”¨ `<article>` æ ‡ç­¾åŒ…è£¹æ–‡æ¡£ã€‚è¿™å¯ä»¥é€šè¿‡ä¿®æ”¹ Markdoc çš„ `document` èŠ‚ç‚¹æ¥æ”¹å˜ã€‚å®ƒæ¥å—ä¸€ä¸ª HTML å…ƒç´ åç§°æˆ–è€…å¦‚æœä½ å¸Œæœ›ç§»é™¤åŒ…è£¹å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨ `null`ï¼š

```js title="markdoc.config.mjs"
import { defineMarkdocConfig, nodes } from '@astrojs/markdoc/config';

export default defineMarkdocConfig({
  nodes: {
    document: {
      ...nodes.document, // åº”ç”¨å…¶ä»–é€‰é¡¹çš„é»˜è®¤å€¼
      render: null, // é»˜è®¤ä¸º 'article'
    },
  },
});
```

## é›†æˆé…ç½®é€‰é¡¹

Astro Markdoc é›†æˆå¤„ç†äº†åœ¨ `markdoc.config.js` æ–‡ä»¶ä¸­ä¸å¯ç”¨çš„ Markdoc é€‰é¡¹å’ŒåŠŸèƒ½çš„é…ç½®ã€‚

### `allowHTML`

å…è®¸åœ¨ Markdoc æ ‡ç­¾å’ŒèŠ‚ç‚¹æ—è¾¹ç¼–å†™ HTML æ ‡è®°ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼ŒMarkdoc ä¸ä¼šå°† HTML æ ‡è®°è¯†åˆ«ä¸ºè¯­ä¹‰å†…å®¹ã€‚

è¦å®ç°æ›´æ¥è¿‘ Markdown çš„ä½“éªŒï¼Œå…¶ä¸­ HTML å…ƒç´ å¯ä»¥ä¸ä½ çš„å†…å®¹ä¸€èµ·ä½¿ç”¨ï¼Œè¯·å°† `allowHTML:true` ä½œä¸º `markdoc` é›†æˆé€‰é¡¹è®¾ç½®ã€‚è¿™å°†åœ¨ Markdoc æ ‡è®°ä¸­å¯ç”¨ HTML è§£æã€‚

```js ins="allowHTML: true" title="astro.config.mjs" ins={6}
  import { defineConfig } from 'astro/config';
  import markdoc from '@astrojs/markdoc';

  export default defineConfig({
    // ...
    integrations: [markdoc({ allowHTML: true })],
  });
```

:::caution
å½“ `allowHTML` è¢«å¯ç”¨æ—¶ï¼ŒMarkdoc æ–‡æ¡£ä¸­çš„ HTML æ ‡è®°å°†è¢«æ¸²æŸ“ä¸ºå®é™…çš„ HTML å…ƒç´ ï¼ˆåŒ…æ‹¬ `<script>`ï¼‰ï¼Œè¿™å°†ä½¿ XSS ç­‰æ”»å‡»å‘é‡æˆä¸ºå¯èƒ½ã€‚ç¡®ä¿ä»»ä½• HTML æ ‡è®°æ¥è‡ªå¯ä¿¡çš„æ¥æºã€‚
:::

### `ignoreIndentation`

é»˜è®¤æƒ…å†µä¸‹ï¼Œä»»ä½•ä½¿ç”¨å››ä¸ªç©ºæ ¼ç¼©è¿›çš„å†…å®¹éƒ½ä¼šè¢«è§†ä¸ºä»£ç å—ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™ç§è¡Œä¸ºä½¿å¾—åœ¨å…·æœ‰å¤æ‚ç»“æ„çš„æ–‡æ¡£ä¸­ç”¨ä»»æ„çº§åˆ«çš„ç¼©è¿›æ¥æé«˜å¯è¯»æ€§å˜å¾—å›°éš¾ã€‚

åœ¨ä½¿ç”¨ Markdoc çš„åµŒå¥—æ ‡ç­¾æ—¶ï¼Œå°†æ ‡ç­¾å†…çš„å†…å®¹ç¼©è¿›å¯ä»¥å¸®åŠ©æ¸…æ¥šåœ°æ˜¾ç¤ºå±‚çº§æ·±åº¦ã€‚ä¸ºäº†æ”¯æŒä»»æ„ç¼©è¿›ï¼Œæˆ‘ä»¬éœ€è¦ç¦ç”¨åŸºäºç¼©è¿›çš„ä»£ç å—ï¼Œå¹¶ä¿®æ”¹å‡ ä¸ªå…¶ä»–çš„ markdown-it è§£æè§„åˆ™ï¼Œä»¥å¿½ç•¥ç¼©è¿›çš„ä»£ç å—ã€‚å³é€šè¿‡å¯ç”¨ ignoreIndentation é€‰é¡¹å¯ä»¥åº”ç”¨è¿™äº›ä¿®æ”¹ã€‚

```js "ignoreIndentation: true" title="astro.config.mjs" ins={6}
  import { defineConfig } from 'astro/config';
  import markdoc from '@astrojs/markdoc';

  export default defineConfig({
    // ...
    integrations: [markdoc({ ignoreIndentation: true })],
  });
```

```md
# æ¬¢è¿ä½¿ç”¨å¸¦æœ‰ç¼©è¿›æ ‡ç­¾çš„ Markdoc ğŸ‘‹

# æ³¨æ„ï¼šå¯ä»¥ä½¿ç”¨ç©ºæ ¼æˆ–åˆ¶è¡¨ç¬¦è¿›è¡Œç¼©è¿›

{% custom-tag %}
{% custom-tag %} ### æ ‡ç­¾å¯ä»¥ç¼©è¿›ä»¥æé«˜å¯è¯»æ€§

    {% another-custom-tag %}
      å½“æœ‰å¤§é‡åµŒå¥—æ—¶ï¼Œè¿™ä¸€ç‚¹æ›´å®¹æ˜“éµå¾ªã€‚
    {% /another-custom-tag %}

{% /custom-tag %}
{% /custom-tag %}
```

## ç¤ºä¾‹

* [Astro Markdoc å…¥é—¨æ¨¡æ¿](https://github.com/withastro/astro/tree/latest/examples/with-markdoc) å±•ç¤ºäº†å¦‚ä½•åœ¨ä½ çš„ Astro é¡¹ç›®ä¸­ä½¿ç”¨ Markdoc æ–‡ä»¶ã€‚

[astro-integration]: /zh-cn/guides/integrations-guide/

[astro-components]: /zh-cn/basics/astro-components/

[astro-content-collections]: /zh-cn/guides/content-collections/

[markdoc-tags]: https://markdoc.dev/docs/tags

[markdoc-nodes]: https://markdoc.dev/docs/nodes

[markdoc-variables]: https://markdoc.dev/docs/variables
