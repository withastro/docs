---
title: レイアウト
description: Astroにおけるレイアウトの紹介です。
i18nReady: true
---

import ReadMore from '~/components/ReadMore.astro'

**レイアウト**は、ページテンプレートのような再利用可能なUI構造を作成するために使用される[Astroコンポーネント](/ja/basics/astro-components/)です。

ヘッダーやナビゲーションバー、フッターなど、ページ間で共有される共通のUIを提供するAstroコンポーネントには、慣習的に「レイアウト」という用語が使われます。典型的なAstroのレイアウトコンポーネントは、[Astro、Markdown、またはMDXのページ](/ja/basics/astro-pages/)に以下を提供します。
- **ページシェル**（`<html>`, `<head>`, `<body>` タグ）
- 個々のページコンテンツが挿入される場所を指定する[**`<slot />`**](/ja/basics/astro-components/#スロット)

ただし、レイアウトコンポーネントに何か特別なところがあるわけではありません。他のAstroコンポーネントと同様に、[propsを受け取り](/ja/basics/astro-components/#コンポーネントのprops)、[他のコンポーネントをインポートして使用](/ja/basics/astro-components/#コンポーネント構造)できます。[UIフレームワークコンポーネント](/ja/guides/framework-components/)や[クライアントサイドスクリプト](/ja/guides/client-side-scripts/)も含められます。ページ全体のシェルを提供する必要すらなく、代わりに部分的なUIテンプレートとしても使用可能です。

レイアウトコンポーネントがページシェルを含んでいる場合、レイアウトコンポーネントの`<html>`タグは他の全てのタグの親である必要があります。

レイアウトコンポーネントは一般的にプロジェクト内の`src/layouts`ディレクトリに配置されますが、これは必須ではなく、プロジェクト内のどこに置いても構いません。レイアウトコンポーネントをページと同じ場所に置くこともでき、その場合は[レイアウト名の先頭に`_`を付けます](/ja/guides/routing/#excluding-pages)。


## レイアウトのサンプル

```astro "<slot />" 
---
// src/layouts/MySiteLayout.astro
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
const { title } = Astro.props
---
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <BaseHead title={title}/>
  </head>
  <body>
    <nav>
      <a href="#">ホーム</a>
      <a href="#">ブログ</a>
      <a href="#">お問い合わせ</a>
    </nav>
    <h1>{title}</h1>
    <article>
      <slot /> <!-- ここにコンテンツが挿入されます -->
    </article>
    <Footer />
  </body>
  <style>
    h1 {
      font-size: 2rem;
    }
  </style>
</html>
```

```astro title="src/pages/index.astro"
---
import MySiteLayout from '../layouts/MySiteLayout.astro';
---
<MySiteLayout title="ホームページ">
  <p>レイアウトに包まれたページのコンテンツ</p>
</MySiteLayout>
```

<ReadMore>[スロット](/ja/basics/astro-components/#スロット)についてもっと学ぶ。</ReadMore>

## レイアウトでTypeScriptを使用する

どのAstroレイアウトでも、propsに型を定義することで、型安全性と自動補完を導入できます:

```astro ins={2-7} title="src/components/MyLayout.astro"
---
interface Props { 
  title: string;
  description: string;
  publishDate: string;
  viewCount: number;
}
const { title, description, publishDate, viewCount } = Astro.props;
---
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="description" content={description}>
    <title>{title}</title>
  </head>
  <body>
    <header>
      <p>Published on {publishDate}</p>
      <p>Viewed by {viewCount} folks</p>
    </header>
    <main>
      <slot />
    </main>
  </body>
</html>
```

## Markdownのレイアウト

ページレイアウトは、ページフォーマットをもたない個別のMarkdownページにとって特に便利です。

Astroは、[ファイルベースルーティングを使用して`src/pages/`内に配置される個別の`.md`ファイル](/ja/guides/markdown-content/#individual-markdown-pages)向けに、特別な`layout`フロントマタープロパティを提供しています。これにより、ページレイアウトとして使用する`.astro`コンポーネントを指定できます。このコンポーネントを使用すると、メタタグ(例: `<meta charset="utf-8">`)やスタイルなどの`<head>`コンテンツをMarkdownページに提供できます。デフォルトでは、指定されたコンポーネントはMarkdownファイルからデータに自動的にアクセスできます。

ただし[コンテンツコレクション](/ja/guides/content-collections/)を使ってコンテンツをクエリ・レンダリングする場合、このプロパティは特別なものとして認識されません。

```markdown title="src/pages/page.md" {2} 
---
layout: ../layouts/BlogPostLayout.astro
title: "Hello, World!"
author: "Matthew Phillips"
date: "2022年8月9日"
---
すべてのフロントマターのプロパティは、Astroのレイアウトコンポーネントのpropsとして利用できます。

`layout`プロパティは、Astroが提供する唯一の特別なプロパティです。

`src/pages/`内のMarkdownファイルで使用できます。

```

Markdownページの典型的なレイアウトは以下を含みます。

1. Markdownページのフロントマターとその他のデータにアクセスするための`frontmatter`プロパティ。
2. ページのMarkdownコンテンツをレンダリングする場所を示すためのデフォルトの[`<slot />`](/ja/basics/astro-components/#スロット)。

```astro title="src/layouts/BlogPostLayout.astro" /(?<!//.*){?frontmatter(?:\\.\w+)?}?/ "<slot />"
---
// 1. frontmatter propによりフロントマターとその他のデータにアクセスできます
const { frontmatter } = Astro.props;
---
<html>
  <head>
    <!-- スタイルやmetaタグなど、その他のhead要素をここに追加します -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <title>{frontmatter.title}</title>
  </head>
  <body>
    <!-- 共通のヘッダーやフッターなど、他のUIコンポーネントをここに追加します -->
    <h1>{frontmatter.title} {frontmatter.author}著</h1>
    <!-- 2. レンダリングされたHTMLはデフォルトスロットに渡されます -->
    <slot />
    <p>投稿日: {frontmatter.date}</p>
  </body>
</html>
```

`MarkdownLayoutProps`を使用して、レイアウトの[`Props`型](/ja/guides/typescript/#component-props)を設定できます。

```astro title="src/layouts/BlogPostLayout.astro" ins={2,4-9}
---
import type { MarkdownLayoutProps } from 'astro';

type Props = MarkdownLayoutProps<{
  // フロントマターのpropsをここで定義します
  title: string;
  author: string;
  date: string;
}>;

// `frontmatter`や`url`などのMarkdownのレイアウトプロパティに
// 型安全にアクセスできます
const { frontmatter, url } = Astro.props;
---
<html>
  <head>
    <meta charset="utf-8">
    <link rel="canonical" href={new URL(url, Astro.site).pathname}>
    <title>{frontmatter.title}</title>
  </head>
  <body>
    <h1>{frontmatter.title} {frontmatter.author}著</h1>
    <slot />
    <p>投稿日: {frontmatter.date}</p>
  </body>
</html>
```

### MarkdownレイアウトのProps

Markdownレイアウトは、`Astro.props`を介して次の情報にアクセスできます。

- **`file`** - ファイルの絶対パス（たとえば`/home/user/projects/.../file.md`）。
- **`url`** - ページであれば、そのページのURL（`/en/guides/markdown-content`）。
- **`frontmatter`** - MarkdownまたはMDXドキュメントのすべてのフロントマター。
  - **`frontmatter.file`** - トップレベルの`file`プロパティと同じ。
  - **`frontmatter.url`** - トップレベルの`url`プロパティと同じ。
- **`headings`** - MarkdownまたはMDXドキュメントの見出し（`h1 -> h6`）と、関連するメタデータのリスト。このリストは次の型に従います：`{ depth: number; slug: string; text: string }[]`。
- **`rawContent()`** - 生のMarkdownドキュメントを文字列として返す関数。
- **`compiledContent()`** - MarkdownドキュメントをHTML文字列にコンパイルして返すasync関数。

:::note
Markdownレイアウトは、`Astro.props`からMarkdownファイルの[利用可能なプロパティ](/ja/guides/markdown-content/#available-properties)すべてにアクセスできますが、**2つの重要な違いがあります:**

* 見出し情報（つまり`h1 -> h6`要素）は、`getHeadings()`関数ではなく、`headings`配列を介して利用できます。

* `file`と`url`は、ネストされた`frontmatter`プロパティ（つまり`frontmatter.url`と`frontmatter.file`）としても利用できます。
:::

### レイアウトを手動でインポートする（MDX）

MDXファイルのフロントマターでも、特別なMarkdownの`layout`プロパティを使って、同じように指定したレイアウトコンポーネントへ`frontmatter`と`headings`のpropsを直接渡すことができます。

MDXレイアウトに、フロントマターには存在しない（または存在しようがない）情報を渡すには、代わりに`<Layout />`コンポーネントをインポートして使用できます。これは他のAstroコンポーネントと同じように動作し、propsは自動で受け取りません。必要なpropsを直接渡してください。

```mdx title="src/pages/posts/first-post.mdx" ins={6} del={2} /</?BaseLayout>/ /</?BaseLayout title={frontmatter.title} fancyJsHelper={fancyJsHelper}>/
---
layout: ../../layouts/BaseLayout.astro
title: '初めてのMDX記事'
publishDate: '2022年9月21日'
---
import BaseLayout from '../../layouts/BaseLayout.astro';

export function fancyJsHelper() {
  return "YAMLでやってみよう!";
}

<BaseLayout title={frontmatter.title} fancyJsHelper={fancyJsHelper}>
  MDXを使用した新しいAstroブログへようこそ!
</BaseLayout>
```

すると、レイアウトの`Astro.props`を介して値が利用でき、MDXコンテンツは`<slot />`コンポーネントが書かれている場所に挿入されます。

```astro title="src/layouts/BaseLayout.astro" /{?title}?/ "fancyJsHelper" "{fancyJsHelper()}"
---
const { title, fancyJsHelper } = Astro.props;
---
<html>
  <head>
    <!-- -->
    <meta charset="utf-8">
  </head>
  <body>
    <!-- -->
    <h1>{title}</h1>
    <slot /> <!-- your content is injected here -->
    <p>{fancyJsHelper()}</p>
    <!-- -->
  </body>
</html>
```

レイアウトを使用する場合(frontmatterの`layout`プロパティを使用するか、レイアウトをインポートするかに関わらず)、レイアウトに `<meta charset="utf-8">` タグを含める必要があります。AstroはMDXページにこのタグを自動的に追加しなくなったためです。

<ReadMore>[Markdownのガイド](/ja/guides/markdown-content/)でAstroのMarkdownとMDXサポートについてもっと学ぶ。</ReadMore>

## レイアウトの入れ子

レイアウトコンポーネントは、ページ全体に相当するHTMLを含む必要はありません。レイアウトをより小さなコンポーネントに分割し、各コンポーネントを組み合わせてより柔軟なページレイアウトを作成できます。このパターンは、複数のレイアウト間でコードを共有したい場合に便利です。

たとえば、`BlogPostLayout.astro`レイアウトはブログ記事のタイトル、日付、作者にスタイルを付けるとします。そして、サイト全体で共通の`BaseLayout.astro`は、ナビゲーションやフッター、SEOメタタグ、グローバルスタイル、フォントなどのページテンプレートの残りを処理します。また、他の入れ子になったコンポーネントと同様に、ブログ記事から受け取ったpropsを他のレイアウトに渡すこともできます。

```astro {3} /</?BaseLayout>/ /</?BaseLayout url={frontmatter.url}>/
---
// src/layouts/BlogPostLayout.astro
import BaseLayout from './BaseLayout.astro'
const {frontmatter} = Astro.props;
---
<BaseLayout url={frontmatter.url}>
  <h1>{frontmatter.title}</h1>
  <h2>投稿者: {frontmatter.author}</h2>
  <slot />
</BaseLayout>
```
