---
title: Astroã‚µã‚¤ãƒˆã‚’Denoã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹
description: Denoã‚’ä½¿ã£ã¦Astroã‚µã‚¤ãƒˆã®ã‚¦ã‚§ãƒ–ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æ–¹æ³•ã€‚
type: deploy
i18nReady: true
---

ã‚µãƒ¼ãƒã‚µã‚¤ãƒ‰ã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã—ãŸAstroã‚µã‚¤ãƒˆã‚’ã€JavaScriptã€TypeScriptã€WebAssemblyã‚’ã‚¨ãƒƒã‚¸ã§å®Ÿè¡Œã™ã‚‹åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã§ã‚ã‚‹[Deno Deploy](https://deno.com/deploy)ã«ã€ä¸–ç•Œä¸­ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã“ã®ã‚¬ã‚¤ãƒ‰ã«ã¯ã€GitHub Actions ã¾ãŸã¯ Deno Deploy ã® CLI ã‚’ä½¿ç”¨ã—ã¦ Deno Deploy ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æ‰‹é †ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

## å¿…è¦æ¡ä»¶

ã“ã®ã‚¬ã‚¤ãƒ‰ã¯ã€ã™ã§ã«[Deno](https://deno.land/)ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

Astroãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚µã‚¤ãƒˆï¼ˆSSRï¼‰ã¨ã—ã¦[Deno Deploy](https://deno.com/deploy)ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚Deno Deployã¯é™çš„ã‚µã‚¤ãƒˆã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚

### SSRç”¨ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼

Astroãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§SSRã‚’æœ‰åŠ¹ã«ã—ã€Deno Deployã§ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚

ä»¥ä¸‹ã® `astro add` ã‚³ãƒãƒ³ãƒ‰ã§ã€Astroãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«SSRã‚’æœ‰åŠ¹ã«ã™ã‚‹ãŸã‚ã®[Denoã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼][Denoã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼]ã‚’è¿½åŠ ã—ã¾ã™ã€‚ã“ã‚Œã§ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã€`astro.config.mjs` ãƒ•ã‚¡ã‚¤ãƒ«ã«é©åˆ‡ãªå¤‰æ›´ãŒåŠ ãˆã‚‰ã‚Œã¾ã™ã€‚

```bash
npx astro add deno
```

ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚’æ‰‹å‹•ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã®2ã¤ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

1. ãŠå¥½ã¿ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ã‚’ä½¿ç”¨ã—ã¦ã€[`@astrojs/deno`ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼][Denoã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼] ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä¾å­˜é–¢ä¿‚ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚npmã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã€ã¾ãŸã¯ã‚ˆãã‚ã‹ã‚‰ãªã„å ´åˆã¯ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ã“ã‚Œã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

    ```bash
      npm install @astrojs/deno
    ```

1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« `astro.config.mjs` ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚

    ```js ins={3,6-7}
    // astro.config.mjs
    import { defineConfig } from 'astro/config';
    import deno from '@astrojs/deno';

    export default defineConfig({
      output: 'server',
      adapter: deno(),
    });
    ```

    æ¬¡ã«ã€`package.json` ã® `preview` ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚

    ```json del={8} ins={9}
    // package.json
    {
      // ...
      "scripts": {
        "dev": "astro dev",
        "start": "astro dev",
        "build": "astro build",
        "preview": "astro preview"
        "preview": "deno run --allow-net --allow-read --allow-env ./dist/server/entry.mjs"
      }
    }
    ```

    ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€æœ¬ç•ªã®Astroã‚µã‚¤ãƒˆã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§Denoã‚’ä½¿ã£ã¦ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

    ```bash
    npm run preview
    ```

## ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•

GitHubã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€ã¾ãŸã¯Deno Deployã®CLIï¼ˆã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ï¼‰ã‚’ä½¿ç”¨ã—ã¦ã€Deno Deployã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### GitHub Actionsã®ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒGitHubã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€[Deno Deploy website](https://dash.deno.com/)ã‚’å‚ç…§ã—ã¦ã€GitHub Actionsã‚’è¨­å®šã—ã¦Astroã‚µã‚¤ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ãã ã•ã„ã€‚

1. å…¬é–‹ã¾ãŸã¯éå…¬é–‹ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«ã‚³ãƒ¼ãƒ‰ã‚’ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹ã€‚

1. GitHubã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§[Deno Deploy](https://dash.deno.com/)ã«ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã—ã€[New Project](https://dash.deno.com)ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

1. ãƒªãƒã‚¸ãƒˆãƒªã¨ãƒ‡ãƒ—ãƒ­ã‚¤å…ƒã®ãƒ–ãƒ©ãƒ³ãƒã‚’é¸æŠã—ã€**GitHub Action**ãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠã—ã¾ã™ã€‚(Astroã‚µã‚¤ãƒˆã§ã¯ãƒ“ãƒ«ãƒ‰ã‚¹ãƒ†ãƒƒãƒ—ãŒå¿…è¦ãªãŸã‚ã€è‡ªå‹•ãƒ¢ãƒ¼ãƒ‰ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“)ã€‚

1. Astro ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã€`.github/workflows/deploy.yml` ã«æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ä»¥ä¸‹ã® YAML ã‚’è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚ã“ã‚Œã¯ Deno Deploy ãŒæä¾›ã™ã‚‹ YAML ã¨ä¼¼ã¦ã„ã¾ã™ãŒã€Astro ã‚µã‚¤ãƒˆã«å¿…è¦ãªã‚¹ãƒ†ãƒƒãƒ—ãŒè¿½åŠ ã•ã‚Œã¦ã„ã¾ã™ã€‚

    ```yaml
    name: Deploy
    on: [push]

    jobs:
      deploy:
        name: Deploy
        runs-on: ubuntu-latest
        permissions:
          id-token: write # Deno Deploy ã§ã®èªè¨¼ã«å¿…è¦ã§ã™ã€‚
          contents: read # ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³ã«å¿…è¦ã§ã™ã€‚

        steps:
          - name: Clone repository
            uses: actions/checkout@v3

          # npmã‚’ä½¿ç”¨ã—ã¦ã„ãªã„å ´åˆã¯ã€`npm ci` ã‚’ `yarn install` ã¾ãŸã¯ `pnpm i` ã«å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚
          - name: Install dependencies
            run: npm ci

          # npmã‚’ä½¿ç”¨ã—ã¦ã„ãªã„å ´åˆã¯ã€`npm run build` ã‚’ `yarn build` ã¾ãŸã¯ `pnpm run build` ã«å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚
          - name: Build Astro
            run: npm run build

          - name: Upload to Deno Deploy
            uses: denoland/deployctl@v1
            with:
              project: my-deno-project # TODO: replace with Deno Deploy project name
              entrypoint: server/entry.mjs
              root: dist
    ```

1. ã“ã®YAMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒŸãƒƒãƒˆã—ã€è¨­å®šã—ãŸdeployãƒ–ãƒ©ãƒ³ãƒã®GitHubã«ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹ã¨ã€è‡ªå‹•çš„ã«deployãŒå§‹ã¾ã‚‹ã¯ãšã§ã™ï¼

   GitHub ãƒªãƒã‚¸ãƒˆãƒªãƒšãƒ¼ã‚¸ã®ã€ŒActionsã€ã‚¿ãƒ–ã€ã¾ãŸã¯[Deno Deploy](https://dash.deno.com)ã§é€²æ—ã‚’ç¢ºèªã§ãã¾ã™ã€‚


### CLI ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

1. [Deno Deploy CLI](https://deno.com/deploy/docs/deployctl)ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

    ```bash
    deno install --allow-read --allow-write --allow-env --allow-net --allow-run --no-check -r -f https://deno.land/x/deploy/deployctl.ts
    ```

1. Astroãƒ“ãƒ«ãƒ‰ã‚¹ãƒ†ãƒƒãƒ—ã‚’å®Ÿè¡Œã™ã‚‹ã€‚

    ```bash
    npm run build
    ```

1. deployctl`ã‚’å®Ÿè¡Œã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ï¼

   ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã¯ã€`<ACCESS-TOKEN>` ã‚’ [Personal Access Token](https://dash.deno.com/user/access-tokens) ã«ã€`<MY-DENO-PROJECT>` ã‚’ Deno Deploy ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚

    ```bash
    DENO_DEPLOY_TOKEN=<ACCESS-TOKEN> deployctl deploy --project=<MY-DENO-PROJECT> --no-static --include=./dist ./dist/server/entry.mjs
    ```

    [Deno Deploy](https://dash.deno.com)ã§ã™ã¹ã¦ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è¿½è·¡ã§ãã¾ã™ã€‚

1.ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ãƒ“ãƒ«ãƒ‰ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’1ã¤ã®ã‚³ãƒãƒ³ãƒ‰ã«ç°¡ç´ åŒ–ã™ã‚‹ã«ã¯ã€`package.json`ã«`deploy-deno`ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¿½åŠ ã™ã‚‹ã€‚

    ```json ins={9}
    // package.json
    {
      // ...
      "scripts": {
        "dev": "astro dev",
        "start": "astro dev",
        "build": "astro build",
        "preview": "deno run --allow-net --allow-read --allow-env ./dist/server/entry.mjs",
        "deno-deploy": "npm run build && deployctl deploy --project=<MY-DENO-PROJECT> --no-static --include=./dist ./dist/server/entry.mjs"
      }
    }
    ```

    ãã®å¾Œã€ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ¯ãƒ³ã‚¹ãƒ†ãƒƒãƒ—ã§Astroã‚µã‚¤ãƒˆã‚’ãƒ“ãƒ«ãƒ‰ã—ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

    ```bash
    DENO_DEPLOY_TOKEN=<ACCESS-TOKEN> npm run deno-deploy
    ```


ğŸ“š [SSR in Astro](/ja/guides/server-side-rendering/)ã«ã¤ã„ã¦ã‚‚ã£ã¨èª­ã‚€ã€‚

[Denoã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼]: https://github.com/denoland/deno-astro-adapter
