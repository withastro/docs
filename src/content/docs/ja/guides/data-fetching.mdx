---
title: ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒ
description: Astroã§fetch APIã‚’ä½¿ç”¨ã—ã¦ãƒªãƒ¢ãƒ¼ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã—ã‚‡ã†ã€‚
i18nReady: true
---
`.astro`ãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒ“ãƒ«ãƒ‰æ™‚ã«ãƒªãƒ¢ãƒ¼ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€ãƒšãƒ¼ã‚¸ã®ç”Ÿæˆã«ä½¿ã„ã¾ã™ã€‚

## Astroã§ã®`fetch()`

ã™ã¹ã¦ã®[Astroã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ](/ja/core-concepts/astro-components/)ã¯ã€ãã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã§[ã‚°ãƒ­ãƒ¼ãƒãƒ«ãª`fetch()`function](https://developer.mozilla.org/ja/docs/Web/API/fetch)ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€APIã«HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œãˆã¾ã™ã€‚ã“ã®fetchã¯ãƒ“ãƒ«ãƒ‰æ™‚ã«å®Ÿè¡Œã•ã‚Œã€ãã®ãƒ‡ãƒ¼ã‚¿ã¯å‹•çš„ãªHTMLã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§åˆ©ç”¨å¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

ğŸ’¡ Astroã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å†…éƒ¨ã§ã€[**top-level await**](https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Operators/await#top_level_await)ã‚’åˆ©ç”¨ã§ãã¾ã™ã€‚

ğŸ’¡ å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã¯Astroã¨ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ä¸¡æ–¹ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«propsã¨ã—ã¦æ¸¡ã•ã‚Œã¾ã™ã€‚

```astro
---
// src/components/User.astro
import Contact from '../components/Contact.jsx';
import Location from '../components/Location.astro';

const response = await fetch('https://randomuser.me/api/');
const data = await response.json();
const randomUser = data.results[0]
---
<!-- ãƒ“ãƒ«ãƒ‰æ™‚ã«å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã§HTMLãŒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚ -->
<h1>ãƒ¦ãƒ¼ã‚¶ãƒ¼</h1>
<h2>{randomUser.name.first} {randomUser.name.last}</h2>

<!-- ãƒ“ãƒ«ãƒ‰æ™‚ã«å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ãŒpropsã¨ã—ã¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«æ¸¡ã•ã‚Œã¾ã™ã€‚ -->
<Contact client:load email={randomUser.email} />
<Location city={randomUser.location.city} />
```

### GraphQLã‚¯ã‚¨ãƒª

Astroã¯ã¾ãŸã€`fetch()`ã‚’ä½¿ç”¨ã—ã¦ä»»æ„ã®æœ‰åŠ¹ãªGraphQLã‚¯ã‚¨ãƒªã§GraphQLã‚µãƒ¼ãƒãƒ¼ã«ã‚¯ã‚¨ãƒªã‚’æŠ•ã’ã‚‰ã‚Œã¾ã™ã€‚

```astro
---
const response = await fetch("https://graphql-weather-api.herokuapp.com",
  {
    method:'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({
      query: `
        query getWeather($name:String!) {
            getCityByName(name: $name){
              name
              country
              weather {
                summary {
                    description
                }
              }
            }
          }
        `,
      variables: {
          name: "Tokyo",
      },
    }),
  })

const json = await response.json();
const weather = json.data
---
<h1>å¤©æ°—ã‚’ãƒ“ãƒ«ãƒ‰æ™‚ã«ãƒ•ã‚§ãƒƒãƒã—ã¾ã™ã€‚</h1>
<h2>{weather.getCityByName.name}, {weather.getCityByName.country}</h2>
<p>å¤©æ°—: {weather.getCityByName.weather.summary.description}</p>
```

:::note
Astroã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã¯ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹ã¨ãã«ãƒ•ã‚§ãƒƒãƒã•ã‚Œã‚‹ã“ã¨ã‚’å¿˜ã‚Œãªã„ã§ãã ã•ã„ã€‚

ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚ŒãŸAstroã‚µã‚¤ãƒˆã¯ã€**ãƒ“ãƒ«ãƒ‰æ™‚ã«ä¸€åº¦ã ã‘**ãƒ‡ãƒ¼ã‚¿ã‚’fetchã—ã¾ã™ã€‚é–‹ç™ºç’°å¢ƒã§ã¯ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®æ›´æ–°æ™‚ã«fetchã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã§ä½•åº¦ã‚‚ãƒ‡ãƒ¼ã‚¿ã‚’å†å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã¯ã€Astroã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§[UIãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯](/ja/core-concepts/framework-components/)ã¾ãŸã¯[ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆ](/ja/guides/client-side-scripts/)ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
:::

## UIãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã®`fetch()`

`fetch()`é–¢æ•°ã¯ã€ä»»æ„ã®[UI ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯](/ja/core-concepts/framework-components/)ã‹ã‚‰ã‚‚ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«åˆ©ç”¨ã§ãã¾ã™ã€‚

```tsx
// Movies.tsx
import type { FunctionalComponent } from 'preact';
import { h } from 'preact';

const data = await fetch('https://example.com/movies.json').then((response) =>
  response.json()
);

// ãƒ“ãƒ«ãƒ‰æ™‚ã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯CLIã«ã‚‚ãƒ­ã‚°ã¨ã—ã¦å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚
// client:*ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚ŒãŸå ´åˆã€ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã‚‚ãƒ­ã‚°ãŒå‡ºåŠ›ã•ã‚Œã¾ã™ã€‚
console.log(data);

const Movies: FunctionalComponent = () => {
  // çµæœã‚’ãƒšãƒ¼ã‚¸ã«å‡ºåŠ›ã™ã‚‹
  return <div>{JSON.stringify(data)}</div>;
};

export default Movies;
```
