---
title: ì„¸ì…˜
description: ìš”ì²­ ì‹œ ë Œë”ë§ë˜ëŠ” í˜ì´ì§€ì— ëŒ€í•œ ìš”ì²­ ê°„ì— ë°ì´í„°ë¥¼ ê³µìœ í•©ë‹ˆë‹¤.
i18nReady: true
---
import Since from '~/components/Since.astro';
import ReadMore from '~/components/ReadMore.astro';

<p>
<Since v="5.7.0" />
</p>

ì„¸ì…˜ì€ [ìš”ì²­ ì‹œ ë Œë”ë§ë˜ëŠ” í˜ì´ì§€](/ko/guides/on-demand-rendering/)ì— ëŒ€í•œ ìš”ì²­ ê°„ì— ë°ì´í„°ë¥¼ ê³µìœ í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.

[`cookies`](/ko/guides/on-demand-rendering/#ì¿ í‚¤)ì™€ëŠ” ë‹¬ë¦¬ ì„¸ì…˜ì€ ì„œë²„ì— ì €ì¥ë˜ë¯€ë¡œ í¬ê¸° ì œí•œì´ë‚˜ ë³´ì•ˆ ë¬¸ì œì— ëŒ€í•œ ê±±ì • ì—†ì´ ë” ë§ì€ ì–‘ì˜ ë°ì´í„°ë¥¼ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‚¬ìš©ì ë°ì´í„°, ì¥ë°”êµ¬ë‹ˆ, ì–‘ì‹ ìƒíƒœì™€ ê°™ì€ ê²ƒë“¤ì„ ì €ì¥í•˜ëŠ” ë° ìœ ìš©í•˜ë©°, í´ë¼ì´ì–¸íŠ¸ ì¸¡ JavaScript ì—†ì´ ì‘ë™í•©ë‹ˆë‹¤.

```astro title="src/components/CartButton.astro" {3}
---
export const prerender = false; // 'server' ì¶œë ¥ì—ëŠ” í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
const cart = await Astro.session?.get('cart');
---

<a href="/checkout">ğŸ›’ {cart?.length ?? 0} items</a>
```

## ì„¸ì…˜ êµ¬ì„±

ì„¸ì…˜ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ ìŠ¤í† ë¦¬ì§€ ë“œë¼ì´ë²„ê°€ í•„ìš”í•©ë‹ˆë‹¤. [Node](/ko/guides/integrations-guide/node/#ì„¸ì…˜), [Cloudflare](/ko/guides/integrations-guide/cloudflare/#ì„¸ì…˜) ë° [Netlify](/ko/guides/integrations-guide/netlify/#ì„¸ì…˜) ì–´ëŒ‘í„°ëŠ” ìë™ìœ¼ë¡œ ê¸°ë³¸ ë“œë¼ì´ë²„ë¥¼ êµ¬ì„±í•˜ì§€ë§Œ, í˜„ì¬ ë‹¤ë¥¸ ì–´ëŒ‘í„°ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” [ë“œë¼ì´ë²„ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì§€ì •](/ko/reference/configuration-reference/#sessiondriver)í•´ì•¼ í•©ë‹ˆë‹¤.

```js title="astro.config.mjs" ins={4}
  {
    adapter: vercel(),
    session: {
      driver: "redis",
    },
  }
```

<ReadMore>
  ìŠ¤í† ë¦¬ì§€ ë“œë¼ì´ë²„ ì„¤ì • ë° ê¸°íƒ€ êµ¬ì„± ê°€ëŠ¥í•œ ì˜µì…˜ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ [`session` êµ¬ì„± ì˜µì…˜](/ko/reference/configuration-reference/#ì„¸ì…˜-ì˜µì…˜)ì„ ì°¸ì¡°í•˜ì„¸ìš”.
</ReadMore>


## ì„¸ì…˜ ë°ì´í„°ì™€ ìƒí˜¸ì‘ìš©

[`session` ê°ì²´](/ko/reference/api-reference/#session)ë¥¼ ì‚¬ìš©í•˜ë©´ ì €ì¥ëœ ì‚¬ìš©ì ìƒíƒœ(ì˜ˆ: ì¥ë°”êµ¬ë‹ˆì— í•­ëª© ì¶”ê°€) ë° ì„¸ì…˜ ID(ì˜ˆ: ë¡œê·¸ì•„ì›ƒ ì‹œ ì„¸ì…˜ ID ì¿ í‚¤ ì‚­ì œ)ì™€ ìƒí˜¸ ì‘ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê°ì²´ëŠ” Astro ì»´í¬ë„ŒíŠ¸ ë° í˜ì´ì§€ì—ì„œëŠ” `Astro.session`ìœ¼ë¡œ, API ì—”ë“œí¬ì¸íŠ¸, ë¯¸ë“¤ì›¨ì–´ ë° ì•¡ì…˜ì—ì„œëŠ” `context.session` ê°ì²´ë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì„¸ì…˜ì€ ì²˜ìŒ ì‚¬ìš©ë  ë•Œ ìë™ìœ¼ë¡œ ìƒì„±ë˜ë©°, [`session.regenerate()`](/ko/reference/api-reference/#regenerate)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì–¸ì œë“ ì§€ ì¬ìƒì„±í•˜ê±°ë‚˜ [`session.destroy()`](/ko/reference/api-reference/#destroy)ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒê´´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ëŒ€ë¶€ë¶„ì˜ ì‚¬ìš© ì‚¬ë¡€ì—ì„œëŠ” [`session.get()`](/ko/reference/api-reference/#get)ê³¼ [`session.set()`](/ko/reference/api-reference/#set)ë§Œ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.

<ReadMore>
ìì„¸í•œ ë‚´ìš©ì€ [ì„¸ì…˜ API ì°¸ì¡°](/ko/reference/api-reference/#session)ë¥¼ í™•ì¸í•˜ì„¸ìš”.
</ReadMore>

### Astro ì»´í¬ë„ŒíŠ¸ ë° í˜ì´ì§€

`.astro` ì»´í¬ë„ŒíŠ¸ ë° í˜ì´ì§€ì—ì„œëŠ” ì „ì—­ `Astro` ê°ì²´ë¥¼ í†µí•´ ì„¸ì…˜ ê°ì²´ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì¥ë°”êµ¬ë‹ˆì— ë‹´ê¸´ ìƒí’ˆì˜ ìˆ˜ë¥¼ í‘œì‹œí•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```astro title="src/components/CartButton.astro" "Astro.session"
---
export const prerender = false; // 'server' ì¶œë ¥ì—ëŠ” í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
const cart = await Astro.session?.get('cart');
---

<a href="/checkout">ğŸ›’ {cart?.length ?? 0} items</a>
```

### API ì—”ë“œí¬ì¸íŠ¸

API ì—”ë“œí¬ì¸íŠ¸ì—ì„œëŠ” `context` ê°ì²´ì—ì„œ ì„¸ì…˜ ê°ì²´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì¥ë°”êµ¬ë‹ˆì— í•­ëª©ì„ ì¶”ê°€í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```ts title="src/pages/api/addToCart.ts" "context.session"
export async function POST(context: APIContext) {
  const cart = await context.session?.get('cart') || [];
	const data = await context.request.json<{ item: string }>();
  if(!data?.item) {
    return new Response('Item is required', { status: 400 });
  }
  cart.push(data.item);
  await context.session?.set('cart', cart);
  return Response.json(cart);
}
```

### ì•¡ì…˜

ì•¡ì…˜ì—ì„œëŠ” `context` ê°ì²´ì—ì„œ ì„¸ì…˜ ê°ì²´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì¥ë°”êµ¬ë‹ˆì— í•­ëª©ì„ ì¶”ê°€í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```ts title="src/actions/addToCart.ts" "context.session"
import { defineAction } from 'astro:actions';
import { z } from 'astro:schema';

export const server = {
  addToCart: defineAction({
    input: z.object({ productId: z.string() }),
    handler: async (input, context) => {
      const cart = await context.session?.get('cart');
      cart.push(input.productId);
      await context.session?.set('cart', cart);
      return cart;
    },
  }),
};
```

### ë¯¸ë“¤ì›¨ì–´

:::note
ì—ì§€ ë¯¸ë“¤ì›¨ì–´ì—ì„œëŠ” ì„¸ì…˜ì´ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
:::

ë¯¸ë“¤ì›¨ì–´ì—ì„œëŠ” `context` ê°ì²´ì—ì„œ ì„¸ì…˜ ê°ì²´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì„¸ì…˜ì— ë§ˆì§€ë§‰ ë°©ë¬¸ ì‹œê°„ì„ ì„¤ì •í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```ts title="src/middleware.ts" "context.session"
import { defineMiddleware } from 'astro:middleware';

export const onRequest = defineMiddleware(async (context, next) => {
  context.session?.set('lastVisit', new Date());
  return next();
});
```

## ì„¸ì…˜ ë°ì´í„° íƒ€ì…

ê¸°ë³¸ì ìœ¼ë¡œ ì„¸ì…˜ ë°ì´í„°ëŠ” íƒ€ì…ì´ ì§€ì •ë˜ì§€ ì•Šìœ¼ë©°, ì–´ë–¤ í‚¤ë“  ì„ì˜ì˜ ë°ì´í„°ë¥¼ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°’ì€ ì½˜í…ì¸  ì»¬ë ‰ì…˜ ë° ì•¡ì…˜ì—ì„œ ì‚¬ìš©ë˜ëŠ” ê²ƒê³¼ ë™ì¼í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ [devalue](https://github.com/Rich-Harris/devalue)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì§ë ¬í™” ë° ì—­ì§ë ¬í™”ë©ë‹ˆë‹¤. ì´ëŠ” ì§€ì›ë˜ëŠ” íƒ€ì…ì´ ë™ì¼í•˜ë©°, ë¬¸ìì—´, ìˆ«ì, `Date`, `Map`, `Set`, `URL`, ë°°ì—´ ë° ì¼ë°˜ ê°ì²´ë¥¼ í¬í•¨í•œë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.

ì„ íƒì ìœ¼ë¡œ `src/env.d.ts` íŒŒì¼ì„ ë§Œë“¤ê³  `App.SessionData` íƒ€ì… ì„ ì–¸ì„ ì¶”ê°€í•˜ì—¬ ì„¸ì…˜ ë°ì´í„°ì˜ [TypeScript íƒ€ì…ì„ ì •ì˜](/ko/guides/typescript/#ì „ì—­-íƒ€ì…-í™•ì¥í•˜ê¸°)í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```ts title="src/env.d.ts"
declare namespace App {
  interface SessionData {
    user: {
      id: string;
      name: string;
    };
    cart: string[];
  }
}
```

ì´ë ‡ê²Œ í•˜ë©´ í¸ì§‘ê¸°ì—ì„œ íƒ€ì… ê²€ì‚¬ ë° ìë™ ì™„ì„± ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ ì„¸ì…˜ ë°ì´í„°ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```ts title="src/components/CartButton.astro"
---
const cart = await Astro.session?.get('cart');
// const cart: string[] | undefined

const something = await Astro.session?.get('something');
// const something: any

Astro.session?.set('user', { id: 1, name: 'Houston' });
// Error: Argument of type '{ id: number; name: string }' is not assignable to parameter of type '{ id: string; name: string; }'.
---
```

:::caution
ì´ê²ƒì€ íƒ€ì… ê²€ì‚¬ì—ë§Œ ì‚¬ìš©ë˜ë©° ì„¸ì…˜ì˜ ëŸ°íƒ€ì„ ë™ì‘ì—ëŠ” ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì‚¬ìš©ìê°€ ì„¸ì…˜ì— ë°ì´í„°ë¥¼ ì €ì¥í•œ ìƒíƒœì—ì„œ íƒ€ì…ì„ ë³€ê²½í•˜ë©´ ëŸ°íƒ€ì„ ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ê°ë³„íˆ ì£¼ì˜í•˜ì„¸ìš”.
:::
