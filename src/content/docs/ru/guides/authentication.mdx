---
title: Аутентификация
description: Введение в аутентификацию в Astro.
i18nReady: true
---

import { Steps } from '@astrojs/starlight/components'
import PackageManagerTabs from '~/components/tabs/PackageManagerTabs.astro'
import ReadMore from '~/components/ReadMore.astro'

Аутентификация и авторизация — это два процесса безопасности, управляющие доступом к вашему сайту или приложению. **Аутентификация** подтверждает личность посетителя, а **авторизация** предоставляет доступ к защищенным разделам и ресурсам.

Аутентификация позволяет персонализировать части сайта для вошедших пользователей и защищать личную информацию. Библиотеки аутентификации (например, [Better Auth](https://better-auth.com/), [Clerk](https://clerk.com)) предоставляют инструменты для различных методов входа: через email, социальные сети (OAuth) и другие.

:::tip
В Astro нет официального встроенного решения для аутентификации, но вы можете найти множество [интеграций от сообщества](https://astro.build/integrations/?search=auth) в нашем каталоге.
:::

<ReadMore>Узнайте, как [добавить аутентификацию с помощью Supabase](/ru/guides/backend/supabase/#добавление-аутентификации-с-помощью-supabase) или [Firebase](/ru/guides/backend/firebase/#добавление-аутентификации-с-помощью-firebase) в наших специальных руководствах.</ReadMore>

## Better Auth

Better Auth — это независимый от фреймворка инструмент для аутентификации (и авторизации) на TypeScript. Он предлагает богатый набор функций «из коробки» и экосистему плагинов для расширенной функциональности.

Он поддерживает Astro официально и может быть легко интегрирован в ваш проект.

### Установка

<PackageManagerTabs>
  <Fragment slot="npm">
  ```shell
  npm install better-auth
  ```
  </Fragment>
  <Fragment slot="pnpm">
  ```shell
  pnpm add better-auth
  ```
  </Fragment>
  <Fragment slot="yarn">
  ```shell
  yarn add better-auth
  ```
  </Fragment>
</PackageManagerTabs>

### Настройка

Настройте таблицы базы данных для хранения данных пользователей и выберите методы входа, как описано в [руководстве по установке Better Auth](https://www.better-auth.com/docs/installation). Затем вам нужно будет создать обработчик (handler) в вашем проекте Astro.

```ts title="src/pages/api/auth/[...all].ts"
import { auth } from "../../../lib/auth"; // импорт вашего экземпляра Better Auth
import type { APIRoute } from "astro";

export const prerender = false; // Обязательно для работы в режиме сервера

export const ALL: APIRoute = async (ctx) => {
	return auth.handler(ctx.request);
};
```

Подробности ищите в [руководстве по Better Auth для Astro](https://www.better-auth.com/docs/integrations/astro).

## Clerk

Clerk — это комплексная платформа, предоставляющая готовые интерфейсы (UI), гибкие API и панели управления для управления пользователями. Для Astro доступен [официальный SDK `@clerk/astro`](https://clerk.com/docs/references/astro/overview).

### Использование

Clerk предоставляет компоненты, которые позволяют управлять видимостью страниц в зависимости от состояния аутентификации. Покажите гостям кнопку входа, а авторизованным пользователям — их профиль:

```astro title="src/pages/index.astro"
---
import Layout from 'src/layouts/Base.astro';
import { SignedIn, SignedOut, UserButton, SignInButton } from '@clerk/astro/components';

export const prerender = false;
---

<Layout>
    <SignedIn>
        <UserButton />
    </SignedIn>
    <SignedOut>
        <SignInButton />
    </SignedOut>
</Layout>
```

Также вы можете защищать маршруты на уровне сервера с помощью мидлвара.

## Lucia

[Lucia](https://lucia-auth.com/) — это популярный ресурс для реализации аутентификации на основе сессий. Хотя проект перешел в режим поддержки, его руководства по-прежнему являются отличным источником знаний о том, как устроена аутентификация «под капотом».

### Руководства

<Steps>
1. Создайте [базовый API сессий](https://lucia-auth.com/sessions/basic-api/) с выбранной базой данных.
2. Добавьте [куки сессий](https://lucia-auth.com/sessions/cookies/astro), используя эндпойнты и мидлвар.
3. Реализуйте [GitHub OAuth](https://lucia-auth.com/tutorials/github-oauth/astro).
</Steps>
