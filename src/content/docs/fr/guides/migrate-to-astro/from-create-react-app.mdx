---
title: Migration depuis Create React App (CRA)
description: Conseils pour migrer un projet Create React App existant vers Astro
sidebar:
  label: Create React App
type: migration
stub: true
framework: Create React App
i18nReady: true
---
import AstroJSXTabs from '~/components/tabs/AstroJSXTabs.astro';
import PackageManagerTabs from '~/components/tabs/PackageManagerTabs.astro';
import { FileTree } from '@astrojs/starlight/components';
import ReadMore from '~/components/ReadMore.astro';
import Badge from "~/components/Badge.astro"

L'[int√©gration React d'Astro](/fr/guides/integrations-guide/react/) permet d'[utiliser des composants React dans les composants Astro](/fr/guides/framework-components/), y compris des applications React enti√®res comme Create React App (CRA) !

```astro title="src/pages/index.astro"
---
// Importation du composant racine de l'application
import App from '../cra-project/App.jsx';
---
<!-- Utilisation d'une directive client pour charger votre application -->
<App client:load />
```

<ReadMore>Voir comment [Construire une application √† page unique (SPA) avec Astro](https://logsnag.com/blog/react-spa-with-astro) <Badge text="Externe" /> en utilisant React Router.</ReadMore>

De nombreuses applications fonctionneront comme des applications React compl√®tes si vous les ajoutez directement √† votre projet Astro avec l'int√©gration React install√©e. C'est un excellent moyen de rendre votre projet op√©rationnel imm√©diatement et de maintenir votre application fonctionnelle pendant que vous migrez vers Astro.

Au fil du temps, vous pouvez convertir votre structure pi√®ce par pi√®ce en une combinaison de composants `.astro` et `.jsx`. Vous d√©couvrirez probablement que vous avez besoin de moins de composants React que vous ne le pensez !

Voici quelques concepts cl√©s et strat√©gies de migration pour vous aider √† d√©marrer. Utilisez le reste de notre documentation et notre [communaut√© sur Discord](https://astro.build/chat) pour continuer !

## Principales similitudes entre CRA et Astro

- La [syntaxe des fichiers `.astro` est similaire √† celle de JSX](/fr/reference/astro-syntax/#diff√©rences-entre-astro-et-jsx). L'√©criture d'Astro devrait vous sembler famili√®re.

- Astro utilise un routage bas√© sur les fichiers et [permet √† des pages sp√©cialement nomm√©es de cr√©er des routes dynamiques](/fr/guides/routing/#routes-dynamiques).

- Astro est [bas√© sur des composants](/fr/basics/astro-components/), et votre structure de balisage sera similaire avant et apr√®s votre migration.

- Astro a [des int√©grations officielles pour React, Preact, et Solid](/fr/guides/integrations-guide/react/) pour que vous puissiez utiliser vos composants JSX existants. Notez que dans Astro, ces fichiers **doivent** avoir une extension `.jsx` ou `.tsx`.

- Astro supporte [l'installation de paquets NPM](/fr/guides/imports/#paquets-npm), y compris les biblioth√®ques React. La plupart de vos d√©pendances existantes fonctionneront dans Astro.

## Principales diff√©rences entre CRA et Astro

Lorsque vous reconstruisez votre site CRA dans Astro, vous remarquerez quelques diff√©rences importantes :

- CRA est une application √† page unique qui utilise `index.js` comme racine de votre projet. Astro est un site multi-pages, et `index.astro` est votre page d'accueil.

- Les composants [`.astro`](/fr/basics/astro-components/) ne sont pas √©crits comme des fonctions export√©es qui renvoient un mod√®le de page. Au lieu de cela, vous diviserez votre code en une ¬´¬†barri√®re de code¬†¬ª pour votre JavaScript et un corps exclusivement pour le HTML que vous g√©n√©rez.

- [Ax√© sur le contenu](/fr/concepts/why-astro/#ax√©-sur-le-contenu) : Astro a √©t√© con√ßu pour mettre en valeur votre contenu et vous permettre d'opter pour l'interactivit√© uniquement en cas de besoin. Une application CRA existante peut √™tre construite pour une grande interactivit√© c√¥t√© client et peut n√©cessiter des techniques Astro avanc√©es pour inclure des √©l√©ments qui sont plus difficiles √† reproduire en utilisant des composants `.astro`, tels que des tableaux de bord.

## Ajouter votre CRA √† Astro

Votre application existante peut √™tre affich√©e directement dans un nouveau projet Astro, souvent sans modification du code de votre application.

### Cr√©er un nouveau projet Astro

Utilisez la commande `create astro` de votre gestionnaire de paquets pour lancer l'assistant CLI d'Astro et s√©lectionner un nouveau projet Astro ¬´¬†vide¬†¬ª.

<PackageManagerTabs>
  <Fragment slot="npm">
  ```shell
  npm create astro@latest
  ```
  </Fragment>
  <Fragment slot="pnpm">
  ```shell
  pnpm create astro@latest
  ```
  </Fragment>
  <Fragment slot="yarn">
  ```shell
  yarn create astro@latest
  ```
  </Fragment>
</PackageManagerTabs>

### Ajouter les int√©grations et les d√©pendances
Ajoutez l'int√©gration React en utilisant la commande `astro add` de votre gestionnaire de paquets. Si votre application utilise Tailwind ou MDX, vous pouvez ajouter plusieurs int√©grations Astro en utilisant la m√™me commande :

<PackageManagerTabs>
  <Fragment slot="npm">
  ```shell
  npx astro add react
  npx astro add react tailwind mdx
  ```
  </Fragment>
  <Fragment slot="pnpm">
  ```shell
  pnpm astro add react
  pnpm astro add react tailwind mdx
  ```
  </Fragment>
  <Fragment slot="yarn">
  ```shell
  yarn astro add react
  yarn astro add react tailwind mdx
  ```
  </Fragment>
</PackageManagerTabs>

Si votre CRA n√©cessite des d√©pendances (par exemple des paquets NPM), installez-les individuellement en utilisant la ligne de commande ou en les ajoutant manuellement au `package.json` de votre nouveau projet Astro, puis en lan√ßant une commande d'installation. Notez que beaucoup de d√©pendances React, mais pas toutes, fonctionneront dans Astro.

### Ajouter vos fichiers d'application existants

Copiez les fichiers sources et les dossiers de votre projet Create React App (CRA) (par exemple `components`, `hooks`, `styles`, etc.) dans un nouveau dossier √† l'int√©rieur de `src/`, en conservant sa structure de fichiers pour que votre application continue √† fonctionner. Notez que toutes les extensions de fichiers `.js` doivent √™tre renomm√©es en `.jsx` ou `.tsx`.

N'incluez aucun fichier de configuration. Vous utiliserez les propres fichiers d'Astro `astro.config.mjs`, `package.json`, et `tsconfig.json`.

D√©placez le contenu du dossier `public/` de votre application (par exemple les actifs statiques) dans le dossier `public/` d'Astro.

<FileTree>
- public/
  - logo.png
  - favicon.ico
  - ...
- src/
  - cra-project/
    - App.jsx
    - ...
  - pages/
    - index.astro
- astro.config.mjs
- package.json
- tsconfig.json
</FileTree>

### Afficher votre application

Importez le composant racine de votre application dans la section frontmatter de `index.astro`, puis affichez le composant `<App />` dans votre mod√®le de page :

```astro title="src/pages/index.astro"
---
import App from '../cra-project/App.jsx';
---
<App client:load />
```

:::note[Directives client]
Votre application a besoin d'une [directive client](/fr/reference/directives-reference/#directives-client) pour l'interactivit√©. Astro affichera votre application React en HTML statique jusqu'√† ce que vous optiez pour le JavaScript c√¥t√© client.

Utilisez `client:load` pour vous assurer que votre application se charge imm√©diatement depuis le serveur, ou `client:only="react"` pour ignorer le rendu sur le serveur et ex√©cuter votre application enti√®rement c√¥t√© client.
:::

## Convertir votre CRA en Astro

Apr√®s avoir [ajout√© votre application existante √† Astro](#ajouter-votre-cra-√†-astro), vous voudrez probablement convertir votre application elle-m√™me √† Astro !

Vous reproduirez un sch√©ma similaire bas√© sur des composants [en utilisant une mise en page HTML dans des composants Astro pour votre structure de base](/fr/basics/astro-components/) tout en important et en incluant des composants React individuels (qui peuvent eux-m√™mes √™tre des applications enti√®res !) pour des √Ælots d'interactivit√©.

Chaque migration sera diff√©rente et peut √™tre effectu√©e de mani√®re incr√©mentale sans perturber votre application de travail. Transformez des √©l√©ments individuels √† votre propre rythme afin que de plus en plus de votre application soit aliment√©e par des composants Astro au fil du temps.

Lors de la conversion de votre application React, vous d√©ciderez quels composants React vous allez [r√©√©crire en composants Astro](#conversion-des-fichiers-jsx-en-fichiers-astro). La seule restriction est que les composants Astro peuvent importer des composants React, alors que les composants React ne peuvent importer que d'autres composants React :

```astro title="src/pages/static-components.astro" ins={2,7}
---
import MyReactComponent from '../components/MyReactComponent.jsx';
---
<html>
  <body>
    <h1>Utilisez les composants React directement dans Astro !</h1>
    <MyReactComponent />
  </body>
</html>
```

Au lieu d'importer des composants Astro dans des composants React, vous pouvez imbriquer des composants React dans un seul composant Astro :

```astro title="src/pages/nested-components.astro" {2,3,5,8,10}
---
import MyReactSidebar from '../components/MyReactSidebar.jsx';
import MyReactButton from '../components/MyReactButton.jsx';
---
<MyReactSidebar>
  <p>Voici une barre lat√©rale avec du texte et un bouton.</p>
  <div slot="actions">
    <MyReactButton client:idle />
  </div>
</MyReactSidebar>
```


Il peut √™tre utile de se familiariser avec les [√Æles Astro](/fr/concepts/islands/) et les [composants Astro](/fr/basics/astro-components/) avant de restructurer votre CRA en projet Astro.


### Comparaison : JSX vs Astro

Comparez le composant CRA suivant et le composant Astro correspondant :

<AstroJSXTabs>
  <Fragment slot="jsx">
    ```jsx title="StarCount.jsx"
    import React, { useState, useEffect } from 'react';
    import Header from './Header';
    import Footer from './Footer';
    
    const Component = () => {
        const [stars, setStars] = useState(0);
        const [message, setMessage] = useState('');
    
        useEffect(() => {
            const fetchData = async () => {
                const res = await fetch('https://api.github.com/repos/withastro/astro');
                const json = await res.json();
    
                setStars(json.stargazers_count || 0);
                setMessage(json.message);
            };
    
            fetchData();
        }, []);
    
        return (
            <>
                <Header />
                <p style={{
                    backgroundColor: `#f4f4f4`,
                    padding: `1em 1.5em`,
                    textAlign: `center`,
                    marginBottom: `1em`
                }}>Astro has {stars} üßë‚ÄçüöÄ</p>
                <Footer />
            </>
        )
    };
    
    export default Component;
        ```
      </Fragment>
      <Fragment slot="astro">
        ```astro title="StarCount.astro"
        ---
        import Header from './Header.astro';
        import Footer from './Footer.astro';
        import './layout.css';
        const res = await fetch('https://api.github.com/repos/withastro/astro')
        const json = await res.json();
        const message = json.message;
        const stars = json.stargazers_count || 0;
        ---
        <Header />
        <p class="banner">Astro has {stars} üßë‚ÄçüöÄ</p>
        <Footer />
        <style>
          .banner {
            background-color: #f4f4f4; 
            padding: 1em 1.5em;
            text-align: center;
            margin-bottom: 1em;
          }
        <style>
        ```
  </Fragment>
</AstroJSXTabs>


### Conversion des fichiers JSX en fichiers `.astro`

Voici quelques conseils pour convertir un composant CRA `.js` en un composant `.astro` :

1. Utilisez le JSX renvoy√© de la fonction du composant CRA existant comme base de votre mod√®le HTML.

2. Changez toute [syntaxe CRA ou JSX en Astro](#r√©f√©rence--convertir-la-syntaxe-cra-en-astro) ou aux standards web HTML. Cela inclut `{children}` et `className`, par exemple.

3. D√©placez tout JavaScript n√©cessaire, y compris les instructions d'importation, dans une [¬´¬†barri√®re de code¬†¬ª (`---`)](/fr/basics/astro-components/#le-script-du-composant). Remarque : le JavaScript pour [afficher le contenu de mani√®re conditionnelle](/fr/reference/astro-syntax/#html-dynamique) est souvent √©crit √† l'int√©rieur du mod√®le HTML directement dans Astro.

4. Utilisez [`Astro.props`](/fr/reference/api-reference/#props) pour acc√©der √† toutes les props suppl√©mentaires qui ont √©t√© pr√©c√©demment transmises √† votre fonction CRA.

5. D√©cidez si les composants import√©s doivent √©galement √™tre convertis en Astro. Vous pouvez les garder en tant que composants React pour le moment, ou pour toujours. Mais vous pouvez √©ventuellement vouloir les convertir en composants `.astro`, surtout s'ils n'ont pas besoin d'√™tre interactifs !

6. Remplacez `useEffect()` par des d√©clarations d'importation ou [`import.meta.glob()`](/fr/guides/imports/#importmetaglob) pour interroger vos fichiers locaux. Utilisez `fetch()` pour r√©cup√©rer des donn√©es externes.

### Tests de migration

Comme Astro produit du HTML brut, il est possible d'√©crire des tests de bout en bout en utilisant le r√©sultat de l'√©tape de construction. Tous les tests de bout en bout √©crits pr√©c√©demment peuvent fonctionner pr√™ts √† l'emploi si vous avez √©t√© en mesure de faire correspondre le balisage de votre site avec CRA. Les biblioth√®ques de test telles que Jest et React Testing Library peuvent √™tre import√©es et utilis√©es dans Astro pour tester vos composants React.

Voir le [guide des tests](/fr/guides/testing/) d'Astro pour plus d'informations.

## R√©f√©rence : Convertir la syntaxe CRA en Astro

### Importations CRA vers Astro

Mettez √† jour tous les [imports de fichiers](/fr/guides/imports/) pour qu'ils fassent exactement r√©f√©rence √† des chemins d'acc√®s relatifs. Cela peut √™tre fait en utilisant [des alias d'importation](/fr/guides/typescript/#alias-dimportation), ou en √©crivant un chemin relatif en entier.

Notez que `.astro` et plusieurs autres types de fichiers doivent √™tre import√©s avec leur extension compl√®te.

```astro title="src/pages/authors/Fred.astro"
---
import Card from '../../components/Card.astro';
---
<Card />
```

### Les props d'enfants de CRA √† Astro

Convertit toutes les instances de `{children}` en un `<slot />` Astro. Ce dernier n'a pas besoin de recevoir `{children}` en tant que propri√©t√© de fonction et affichera automatiquement le contenu des enfants dans un `<slot />`.

```astro title="src/components/MyComponent.astro" del={3-9} ins={11-13}
---
---
export default function MyComponent(props) { 
    return (
      <div>
        {props.children}
      </div>
    );  
}

<div>
  <slot />
</div>
```

Les composants React qui passent plusieurs ensembles d'enfants peuvent √™tre migr√©s vers un composant Astro en utilisant des [slots nomm√©s](/fr/basics/astro-components/#les-emplacements-slots-nomm√©s).

En savoir plus sur [l'utilisation sp√©cifique de `<slot />` dans Astro](/fr/basics/astro-components/#les-emplacements-slots).

### R√©cup√©ration de donn√©es de CRA √† Astro

La r√©cup√©ration de donn√©es dans un composant Create React App est similaire √† Astro, avec quelques l√©g√®res diff√©rences.

Vous devrez supprimer toutes les instances d'un crochet d'effet secondaire (`useEffect`) pour `import.meta.glob()` ou `getCollection()`/`getEntryBySlug()` pour acc√©der aux donn√©es depuis d'autres fichiers dans la source de votre projet.

Pour [r√©cup√©rer des donn√©es distantes](/fr/guides/data-fetching/), utilisez `fetch()`.

Ces requ√™tes de donn√©es sont effectu√©es dans la partie avant du composant Astro et utilisent des attentes de premier niveau.

```astro title="src/pages/index.astro"
---
import { getCollection } from 'astro:content';

// Obtention de toutes les entr√©es `src/content/blog/`
const allBlogPosts = await getCollection('blog');

// Obtention de toutes les entr√©es `src/pages/posts/`
const allPosts = Object.values(import.meta.glob('../pages/post/*.md', { eager: true }));

// R√©cup√©ration des donn√©es √† distance
const response = await fetch('https://randomuser.me/api/');
const data = await response.json();
const randomUser = data.results[0];
---
```

En savoir plus sur l'importation de fichiers locaux avec [`import.meta.glob()`](/fr/guides/imports/#importmetaglob), [l'interrogation √† l'aide de l'API Collections](/fr/guides/content-collections/#interroger-les-collections) ou [la r√©cup√©ration de donn√©es distantes](/fr/guides/data-fetching/).

### Le style de CRA √† Astro

Il se peut que vous deviez remplacer les [biblioth√®ques CSS-in-JS](https://github.com/withastro/astro/issues/4432) (par exemple, `styled-components`) par d'autres options CSS disponibles dans Astro.

Si n√©cessaire, convertissez les objets de style en ligne (`style={{ fontWeight: "bold" }}`) en attributs de style HTML en ligne (`style="font-weight:bold ;"`). Vous pouvez √©galement utiliser une balise [Astro `<style>`](/fr/guides/styling/#styliser-avec-astro) pour les styles CSS √©tendus.

```astro title="src/components/Card.astro" del={1} ins={2}
<div style={{backgroundColor: `#f4f4f4`, padding: `1em`}}>{message}</div>
<div style="background-color: #f4f4f4; padding: 1em;">{message}</div>
```

Tailwind est pris en charge apr√®s l'installation du [plugin Vite de Tailwind](/fr/guides/styling/#tailwind). Aucune modification de votre code Tailwind existant n'est n√©cessaire !

En savoir plus sur [les styles dans Astro](/fr/guides/styling/).


## D√©pannage

Votre CRA pourrait ¬´¬†simplement fonctionner¬†¬ª dans Astro ! Mais il se peut que vous deviez proc√©der √† des ajustements mineurs pour reproduire les fonctionnalit√©s et/ou les styles de votre application existante.

Si vous ne trouvez pas les r√©ponses √† vos questions dans ces documents, visitez le [serveur Discord d'Astro](https://astro.build/chat) et posez vos questions dans notre forum d'assistance !
