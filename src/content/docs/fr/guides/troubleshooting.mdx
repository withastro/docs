---
title: D√©pannage
description: Besoin d'aide ? Bloqu√© sur quelque chose ? Ce guide est fait pour vous.
i18nReady: true
---

Astro fournit plusieurs outils diff√©rents pour vous aider √† d√©panner et √† d√©boguer votre code.

## Trucs et astuces

### D√©bogage avec `console.log()`

`console.log()` est un moyen simple mais populaire de d√©boguer votre code Astro. Lorsque vous √©crivez votre appel √† `console.log`, il d√©terminera o√π votre sortie de d√©bogage sera affich√©e.

#### Frontmatter

Un appel √† `console.log()` dans le Frontmatter d'Astro sera toujours sorti dans le **terminal** qui ex√©cute le processus d'Astro. Car Astro s'ex√©cute sur le serveur, et jamais dans le navigateur.

```astro
---
const sum = (a, b) => a + b;

// Exemple : Affiche "4" dans le terminal
console.log(sum(2, 2));
---
```

#### Scripts JS

Le code qui est √©crit ou import√© dans un `<script>` d'Astro sera ex√©cut√© dans le navigateur. Toutes les sorties de d√©bogage ou autres appels √† `console.log()` seront affich√©s dans votre navigateur.

### D√©bogage des composants de Framework

[Les composants de Framework](/fr/core-concepts/framework-components/) (comme React et Svelte) sont uniques : ils sont rendus sur le serveur par d√©faut, ce qui signifie que les sorties de d√©bogage seront visibles dans le terminal. Cependant, ils peuvent √©galement √™tre hydrat√©s pour le navigateur, ce qui peut aussi entra√Æner que vos logs de d√©bogage apparaissent √©galement dans le navigateur.

Cela peut √™tre utile pour d√©boguer les diff√©rences entre la sortie SSR et les composants hydrat√©s dans le navigateur.

### Le composant `<Debug />` d'Astro

Pour vous aider √† d√©boguer vos composants Astro, Astro propose un composant [`<Debug />`](/fr/reference/api-reference/#debug-) qui affiche directement une valeur dans votre template HTML de composant. Cela est utile pour un d√©bogage rapide dans le navigateur sans avoir √† faire les aller-retour entre votre terminal et votre navigateur.

```astro
---
import { Debug } from 'astro/components';
const sum = (a, b) => a + b;
---

<!-- Exemple : Affiche {answer: 6} dans le navigateur -->
<Debug answer={sum(2, 4)} />
```

Le composant `<Debug />` d'Astro supporte une vari√©t√© d'options de syntaxe pour un d√©bogage plus flexible et concis :

```astro
---
import { Debug } from 'astro/components';
const sum = (a, b) => a + b;
const answer = sum(2, 4);
---
<!-- Exemple : Les trois exemples sont √©quivalents. -->
<Debug answer={sum(2, 4)} />
<Debug {{answer: sum(2, 4)}} />
<Debug {answer} />
```

## Erreurs courantes

Voici une liste de quelques messages d'erreurs courants que vous pourriez rencontrer dans votre terminal, ce qu'ils signifient et ce que vous pouvez faire pour les corriger.

### Cannot use import statement outside a module

Dans les composants Astro, les balises `<script>` sont hoist√©es et charg√©es comme des [modules JavaScript](https://developer.mozilla.org/fr/docs/Web/JavaScript/Guide/Modules) par d√©faut. Si vous avez ajout√© la directive [`is:inline`](/fr/reference/directives-reference/#isinline) ou n'importe quel autre attribut dans votre balise, ce comportement par d√©faut est d√©sactiv√©.

**Solution**: Si vous avez ajout√© n'importe quel attribut √† votre balise `<script>`, vous devez aussi ajouter la directive `type="module"` pour pouvoir utiliser les importations.

**Statut**: Comportement attendu par Astro, comme pr√©vu.

üí° Vous n'√™tes pas certain que cela va r√©soudre votre probl√®me ? V√©rifiez si quelqu'un d'autre a d√©j√† [signal√© ce type d'erreur](https://github.com/withastro/astro/issues?q=is%3Aissue+is%3Aopen+Cannot+use+import+statement) !

### `document` (or `window`) is not defined

Cette erreur se produit lorsqu'on essaie d'acc√©der √† `document` ou `window` sur le serveur.

Les composants Astro fonctionnent sur le serveur, vous ne pouvez donc pas acc√©der √† ces objets sp√©cifiques au navigateur dans le frontmatter.

Les composants des Frameworks s'ex√©cutent par d√©faut sur le serveur, et cette erreur peut donc se produire lors de l'acc√®s √† `document` ou `window` pendant le rendu. 

**Solution** : D√©terminez le code qui appelle `document` ou `window`. Si vous n'utilisez pas directement `document` ou `window` et que vous obtenez toujours cette erreur, v√©rifiez si les packages que vous importez sont destin√©s √† fonctionner sur le client. 

- Si le code se trouve dans un composant Astro, d√©placez-le dans une balise `<script>` √† l'ext√©rieur du frontmatter. Cela indique √† Astro d'ex√©cuter ce code sur le client, o√π `document` et `window` sont disponibles.

- Si le code est dans un composant du framework, essayez d'acc√©der √† ces objets apr√®s le rendu en utilisant des m√©thodes de cycle de vie (par exemple [`useEffect()`](https://react.dev/reference/react/useEffect) dans React, [`onMounted()`](https://vuejs.org/api/composition-api-lifecycle.html#onmounted) dans Vue, et [`onMount()`](https://svelte.dev/docs#run-time-svelte-onmount) dans Svelte). Indiquez au composant du framework de s'hydrater c√¥t√© client en utilisant une directive [client :](/fr/reference/directives-reference/#directives-client), comme `client:load`, pour ex√©cuter ces m√©thodes de cycle de vie. Vous pouvez √©galement emp√™cher le composant d'effectuer un rendu sur le serveur en ajoutant la directive [`client:only`](/fr/reference/directives-reference/#clientonly).

**Statut**: Comportement attendu par Astro, comme pr√©vu.

### Expected a default export

Cette erreur peut √™tre lev√©e lorsque vous essayez d'importer ou de rendre un composant invalide, ou un qui ne fonctionne pas correctement. (Ce message d'erreur appara√Æt car le fonctionnement de l'importation d'un composant UI se fait d'une fa√ßon sp√©cifique √† Astro.)

**Solution**: Essayez de trouver des erreurs dans les composants que vous importez et affichez et assurez-vous qu'ils fonctionnent correctement. Vous pouvez aussi ouvrir un Template de d√©marrage Astro [astro.new](https://astro.new) et d√©boguer votre composant dans un projet Astro minimal.

**Statut**: Comportement attendu par Astro, comme pr√©vu.

### Refused to execute inline script

Il se peut que l'erreur suivante apparaisse dans la console du navigateur :

> Refused to execute inline script because it violates the following Content Security Policy directive: ‚Ä¶

Cela signifie que la [Content Security Policy](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP) (CSP) de votre site interdit l'ex√©cution des balises `<script>`, qu'Astro produit par d√©faut.

**Solution:** Mettez √† jour votre CSP pour inclure `script-src : 'unsafe-inline'` afin d'autoriser l'ex√©cution des scripts inline.


## Pi√®ges courants

### Mon composant ne s'affiche pas

En premier lieu, v√©rifiez que vous avez **import√© le composant** dans votre [Script de composant `.astro`](/fr/core-concepts/astro-components/#le-script-du-composant) ou [`.mdx` file](/fr/guides/markdown-content/#utilisation-des-composants-en-mdx).

Ensuite, v√©rifiez votre appel `import` :

- Votre importation dirige-t-elle vers le bon endroit ? (V√©rifiez votre chemin d'import.)

- Est-ce que votre importation a le m√™me nom que le composant import√© ? (V√©rifiez le nom de votre composant et que cela suit la syntaxe `.astro`.)

- Avez-vous inclu l'extension dans l'importation ? (V√©rifiez que le fichier import√© contient une extension. Ex: `.astro`, `.md`, `.jsx`, `.vue`)

### Mon composant n'est pas interactif

Si votre composant est rendu (voir la pr√©c√©dente section) mais ne r√©pond pas √† l'interaction utilisateur, alors vous avez peut-√™tre oubli√© une [directive `client:*`](/fr/reference/directives-reference/#directives-client) pour hydrater votre composant.

Par d√©faut, un [composants UI de Framework n'est pas hydrat√© sur le navigateur](/fr/core-concepts/framework-components/#hydratation-des-composants-interactifs). Si aucune directive `client:*` n'est fournie, son HTML est rendu sur la page sans JavaScript.

:::tip
Les [composants Astro](/fr/core-concepts/astro-components/) sont des composants HTML sans ex√©cution sur le navigateur. Mais, vous pouvez utiliser une balise `<script>` dans votre Template de composant Astro pour envoyer du JavaScript au navigateur qui s'ex√©cute globalement sur toute la page.
:::

### Cannot find package 'X'

Si vous voyez un avertissement du type `"Cannot find package 'react'"` (ou similaire) lorsque vous d√©marrez Astro, cela signifie que vous devez installer ce package dans votre projet.  Tous les gestionnaires de packages n'installent pas automatiquement les d√©pendances pour vous. Si vous √™tes sur Node v16+ et que vous utilisez npm, vous ne devriez pas avoir √† vous soucier de cette section.

React, par exemple, est une d√©pendance peer de l'int√©gration `@astrojs/react`. Cela signifie que vous devez installer les packages officiels `react` et `react-dom` avec votre int√©gration. L'int√©gration s'appuiera alors automatiquement sur ces packages.

```shell ins="react react-dom"
# Exemple : Installer les int√©grations et les frameworks ensemble
npm install @astrojs/react react-dom
```
Voir [le guide d'int√©gration d'Astro](/fr/guides/integrations-guide/) pour des instructions sur l'ajout de moteurs de rendu de frameworks, d'outils CSS et d'autres packages √† Astro.

### `Astro.glob()` - no matches found

Quant vous utilisez `Astro.glob()` pour importer des fichiers, assurez-vous d'utiliser la syntaxe glob correcte qui va correspondre √† tous les fichiers dont vous auriez besoin.

#### Chemins d'acc√®s

Par exemple, utilisez `../components/**/*.js` dans `src/pages/index.astro` pour importer les deux fichiers suivants :

- `src/components/MyComponent.js`
- `src/components/includes/MyOtherComponent.js`

#### Valeurs prises en charge

`Astro.glob()` ne prend pas en charge les variables dynamiques et les interpolations.

Ce n'est pas un bug d'Astro. C'est d√ª √† une limitation de la fonctionnalit√© [`import.meta.glob()` de Vite](https://vitejs.dev/guide/features.html#glob-import) qui ne supporte que des cha√Ænes de caract√®res statiques.

L'alternative la plus courante est d'importer un ensemble plus grand de fichiers qui inclut tous les fichiers dont vous avez besoin en utilisant `Astro.glob()`, puis de les filtrer :

```astro
---
// src/components/featured.astro
const { postSlug } = Astro.props
const pathToMyFeaturedPost = `src/pages/blog/${postSlug}.md`

const posts = await Astro.glob('../pages/blog/*.md');
const myFeaturedPost = posts.find(post => post.file.includes(pathToMyFeaturedPost));
---

<p>
    Jetez un oeil √† mon article favori, <a href={myFeaturedPost.url}>{myFeaturedPost.frontmatter.title}</a> !
</p>
```

### Utilisation d'Astro avec Yarn 2+ (Berry)

Dans Yarn version 2 ou plus (a.k.a. Berry), utilise une technique appel√©e ["Plug'n'Play" (PnP)](https://yarnpkg.com/features/pnp) pour stocker et g√©rer les modules Node, qui peut [causer des probl√®mes](https://github.com/withastro/astro/issues/3450) lors de l'initialisation d'un nouveau projet Astro utilisant `create-astro` ou lors de l'utilisation de Astro. Une solution est de d√©finir la propri√©t√© [`nodeLinker`](https://yarnpkg.com/configuration/yarnrc#nodeLinker) dans `yarnrc.yml` √† la valeur `node-modules` :

```yaml
nodeLinker: "node-modules"
```

### Ajouter des d√©pendances √† Astro dans une monorepo

Lorsque vous travaillez avec Astro dans une configuration monorepo, les d√©pendances du projet doivent √™tre ajout√©es dans le fichier `package.json` de chaque projet.

Cependant, vous pouvez aussi vouloir utiliser Astro √† la racine de la monorepo (par exemple, [les projets Nx recommandent d'installer les d√©pendances √† la racine](https://github.com/nrwl/nx/issues/3023#issuecomment-630558318)). Dans ce cas, ajoutez manuellement les d√©pendances li√©es √† Astro (par exemple `@astrojs/vue`, `astro-component-lib`) √† la partie `vite.ssr.noExternal` de la configuration d'Astro pour vous assurer que ces d√©pendances sont correctement install√©es et regroup√©es :

```js
// astro.config.mjs
import { defineConfig } from 'astro/config'
export default defineConfig({
  vite: {
    ssr: {
      noExternal: [
        '@astrojs/vue',
        'astro-component-lib',
      ]
    }
  }
})
```

### Utilisation de `<head>` dans un composant

Dans Astro, l'utilisation d'une balise `<head>` fonctionne comme n'importe quelle autre balise HTML : elle n'est pas d√©plac√©e en haut de la page ou fusionn√©e avec la balise `<head>` existante. Pour cette raison, vous ne voulez g√©n√©ralement inclure qu'une seule balise `<head>` dans une page. Nous recommandons d'√©crire cet unique `<head>` et son contenu dans un [composant de mise en page] (/fr/core-concepts/layouts/).

### Un `<script>` ou `<style>` inattendu est inclus

Vous pouvez remarquer que les balises `<script>` ou `<style>` d'un composant import√© sont incluses dans votre source HTML m√™me si ce composant n'appara√Æt pas dans la sortie finale. Par exemple, cela se produira avec les composants [rendus conditionnellement](/fr/core-concepts/astro-syntax/#html-dynamique) qui ne sont pas affich√©s. 

Le processus de Build d'Astro fonctionne sur le graphe des modules : une fois qu'un composant est inclus dans le mod√®le, ses balises `<script>` et `<style>` sont trait√©es, optimis√©es et regroup√©es, qu'il apparaisse ou non dans la sortie finale. Ceci ne s'applique pas aux scripts lorsque la directive `is:inline` est appliqu√©e.

## Cr√©er des reproductions minimales

Lorsque vous d√©pannez votre code, il peut √™tre utile de cr√©er une **reproduction minimale** du probl√®me que vous pouvez partager. Il s'agit d'un projet Astro plus petit et simplifi√© qui d√©montre votre probl√®me. Le fait d'avoir une reproduction fonctionnelle dans un nouveau projet permet de confirmer qu'il s'agit d'un probl√®me reproductible et qu'il n'est pas d√ª √† quelque chose d'autre dans votre environnement personnel ou dans un projet existant.

Le partage d'une reproduction minimale est utile lorsque vous demandez de l'aide dans nos fils d'assistance et est souvent n√©cessaire lorsque vous d√©posez un rapport de bogue aupr√®s d'Astro.

### Cr√©er un StackBlitz via [astro.new](https://astro.new)

Vous pouvez utiliser [astro.new](https://astro.new) pour cr√©er un nouveau projet Astro en un seul clic. Pour des reproductions minimales, nous recommandons fortement de partir de l'exemple minimal (vide) ex√©cut√© dans [StackBlitz](https://stackblitz.com), avec le moins de code suppl√©mentaire possible.

StackBlitz ex√©cutera ce projet Astro dans le navigateur, en dehors de votre environnement local. Il vous fournira √©galement un lien partageable afin que n'importe quel mainteneur Astro ou membre de l'√©quipe de support puisse voir votre reproduction minimale en dehors de leur propre environnement local. Cela signifie que tout le monde voit exactement le m√™me projet, avec la m√™me configuration et les m√™mes d√©pendances. Il est ainsi plus facile pour quelqu'un d'autre d'aider √† d√©panner votre code. Si le probl√®me est reproductible, cela vous permet de v√©rifier que le probl√®me se trouve dans le code Astro lui-m√™me et vous pouvez soumettre un rapport de bogue en toute confiance.

Notez que tous les probl√®mes ne sont pas reproductibles dans StackBlitz. Par exemple, votre probl√®me peut d√©pendre d'un environnement sp√©cifique ou d'un gestionnaire de packages, ou il peut impliquer le streaming HTML, qui n'est pas support√© par StackBlitz. Dans ce cas, cr√©ez un nouveau projet Astro minimal (vide) en utilisant le CLI, reproduisez le probl√®me et t√©l√©chargez-le sur un d√©p√¥t GitHub. Au lieu de partager une URL StackBlitz, fournissez un lien vers le d√©p√¥t GitHub de votre reproduction minimale.

### Code minimal

Une fois que votre projet vide est mis en place, passez par les √©tapes pour reproduire le probl√®me. Cela peut inclure l'ajout de packages, la modification de la configuration et l'√©criture de code.

Vous ne devez ajouter que le minimum de code n√©cessaire pour reproduire le probl√®me. Ne reproduisez pas d'autres √©l√©ments de votre projet existant et supprimez tout le code qui n'est pas directement li√© au probl√®me.

### Cr√©er une Issue

Si votre probl√®me peut √™tre reproduit, il est temps de cr√©er une issue et de d√©poser un rapport de bug !

Allez sur le d√©p√¥t Astro appropri√© sur GitHub et ouvrez une nouvelle issue. La plupart des d√©p√¥ts ont un template d'issue qui pose des questions ou demande des informations pour le soumettre. Il est important que vous suiviez ces templates car si vous ne fournissez pas les informations dont nous avons besoin, nous devrons vous les demander... et personne ne travaillera sur votre probl√®me !

Incluez le lien vers votre reproduction minimale sur StackBlitz (ou le d√©p√¥t GitHub, si n√©cessaire). Commencez par une description du comportement attendu par rapport au comportement r√©el pour fournir le contexte du probl√®me. Ensuite, incluez des instructions claires, √©tape par √©tape, sur la fa√ßon de reproduire le probl√®me dans un projet Astro.

## Besoin de plus ?

Venez discuter avec nous sur [Discord](https://astro.build/chat) et expliquez votre probl√®me dans le salon `#support`. Nous sommes toujours heureux de pouvoir vous aider !

Visitez les [_"Issues"_ GitHub ouvertes dans Astro](https://github.com/withastro/astro/issues/) pour voir si vous rencontrez un probl√®me connu ou soumettre un rapport de bug.

Vous pouvez aussi visiter [les discussions RFC](https://github.com/withastro/rfcs/discussions/) pour voir si vous avez trouv√© une limitation connue d'Astro et regarder si il y a des propositions en rapport avec votre utilisation.
