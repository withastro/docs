---
title: Ghost & Astro
description: Ajouter du contenu a votre projet Astro en utilisant Ghost comme CMS
sidebar:
  label: Ghost
type: cms
stub: false
service: Ghost
i18nReady: true
---

import { FileTree, CardGrid, LinkCard } from '@astrojs/starlight/components';
import PackageManagerTabs from '~/components/tabs/PackageManagerTabs.astro'

[Ghost](https://github.com/TryGhost/Ghost) est un syst√®me de gestion de contenu open-source, headless, construit sur Node.js.

## Int√©gration avec Astro
Dans cette section, nous utiliserons l'API [Ghost content API](https://ghost.org/docs/content-api/) pour int√©grer vos donn√©es dans votre projet Astro.

### Pr√©requis
Pour commencer, vous devez disposer des √©l√©ments suivants : 

1. **Un projet Astro** - Si vous n'avez pas encore de projet Astro, notre [Guide d'installation](/fr/install-and-setup/) vous permettra d'√™tre op√©rationnel en un rien de temps.

2. **Un site Ghost** - Nous supposons que vous avez un site configur√© avec Ghost. Si ce n'est pas le cas, vous pouvez en configurer un sur un [environnement local](https://ghost.org/docs/install/local/).

3. **Cl√© API de contenu** - Vous pouvez effectuer une int√©gration dans les `Settings > Integrations` de votre site. A partir de l√†, vous pouvez trouver votre `Content API key`


### Configuration des informations d'identification

Pour ajouter les identifiants de votre site √† Astro, cr√©ez un fichier `.env` √† la racine de votre projet avec la variable suivante :

```ini title=".env"
CONTENT_API_KEY=YOUR_API_KEY
```

Maintenant, vous devriez √™tre capable d'utiliser cette variable d'environnement dans votre projet.

Si vous voulez avoir IntelliSense pour votre variable d'environnement, vous pouvez cr√©er un fichier `env.d.ts` dans le r√©pertoire `src/` et configurer `ImportMetaEnv` comme ceci :

```ts title="src/env.d.ts"
interface ImportMetaEnv {
  readonly CONTENT_API_KEY: string;
}
```
:::tip
En savoir plus sur [l'utilisation des variables d'environnement](/fr/guides/environment-variables/) at les fichiers `.env` dans Astro.
:::

Votre r√©pertoire racine doit maintenant contenir ces nouveaux fichiers :

<FileTree title="Structure du projet">
- src/
  - **env.d.ts**
- **.env**
- astro.config.mjs
- package.json
</FileTree>

### Installation des d√©pendances

Pour se connecter √† Ghost, installez l'API de contenu officielle [`@tryghost/content-api`](https://www.npmjs.com/package/@tryghost/content-api) en utilisant la commande ci-dessous pour votre gestionnaire de paquets pr√©f√©r√© et, √©ventuellement, un paquet utile contenant des d√©finitions de types si vous utilisez TypeScript :

<PackageManagerTabs>
  <Fragment slot="npm">
  ```shell
  npm install @tryghost/content-api
  npm install --save @types/tryghost__content-api
  ```
  </Fragment>
  <Fragment slot="pnpm">
  ```shell
  pnpm add @tryghost/content-api
  pnpm add --save-dev @types/tryghost__content-api
  ```
  </Fragment>
  <Fragment slot="yarn">
  ```shell
  yarn add @tryghost/content-api
  yarn add --dev @types/tryghost__content-api
  ```
  </Fragment>
</PackageManagerTabs>

## Cr√©er un blog avec Astro et Ghost

Avec la configuration ci-dessus, vous √™tes maintenant en mesure de cr√©er un blog qui utilise Ghost comme CMS.

### Pr√©requis

1. A blog Ghost 
2.  Un projet Astro int√©gr√© √† l'[API de contenu Ghost](https://www.npmjs.com/package/@tryghost/content-api) - Voir [int√©gration avec Astro](#int√©gration-avec-astro) pour plus de d√©tails sur la fa√ßon de configurer un projet Astro avec Ghost.

Cet exemple cr√©e une page d'index qui r√©pertorie les articles avec des liens vers des pages individuelles g√©n√©r√©es dynamiquement.

### R√©cup√©ration de donn√©es

Vous pouvez r√©cup√©rer les donn√©es de votre site avec l'API de contenu de Ghost.

Tout d'abord, cr√©ez un fichier `ghost.ts` dans un r√©pertoire `lib`.

<FileTree title="Structure du projet">
- src/
  - lib/
    - **ghost.ts**
  - pages/
    - index.astro
- astro.config.mjs
- package.json
</FileTree>

Initialiser une instance API avec l'API Ghost en utilisant la cl√© API de la page Int√©grations du tableau de bord Ghost.

```ts title="src/lib/ghost.ts"

import GhostContentAPI from '@tryghost/content-api';

// Cr√©er une instance API avec les informations d'identification du site
export const ghostClient = new GhostContentAPI({
    url: 'http://127.0.0.1:2368', // Il s'agit de l'URL par d√©faut si votre site fonctionne dans un environnement local.
    key: import.meta.env.CONTENT_API_KEY,
    version: 'v5.0',
});

```


### Afficher une liste d'articles

La page `src/pages/index.astro` affichera une liste d'articles, chacun avec une description et un lien vers sa propre page.

<FileTree title="Structure du projet">
- src/
 - lib/
    - ghost.ts
  - pages/
    - **index.astro**
- astro.config.mjs
- package.json
</FileTree>

Importez `ghostClient()` dans le frontmatter Astro pour utiliser la m√©thode `posts.browse()` afin d'acc√©der aux articles du blog depuis Ghost. D√©finissez `limit : all` pour r√©cup√©rer tous les articles.

```astro title="src/pages/index.astro"
---
import { ghostClient } from '../lib/ghost';
const posts = await ghostClient.posts
    .browse({
        limit: 'all',
    })
    .catch((err) => {
        console.error(err);
    });
---
```

La recherche via l'API de contenu renvoie un tableau d'objets contenant les [propri√©t√©s de chaque article](https://ghost.org/docs/content-api/#posts) telles que :
- `title` - le titre de l'article
- `html` - le rendu HTML du contenu de l'article
- `feature_image` - l'URL source de l'image vedette de l'article
- `slug` - le nom de l'article.

Utilisez le tableau `posts` renvoy√© par la recherche pour afficher une liste d'articles de blog sur la page.

```astro title="src/pages/index.astro"
---
import { ghostClient } from '../lib/ghost';
const posts = await ghostClient.posts
    .browse({
        limit: 'all',
    })
    .catch((err) => {
        console.error(err);
    });
---

<html lang="en">
    <head>
        <title>Astro + Ghost üëª</title>
    </head>
    <body>

        {
            posts.map((post) => (
                <a href={`/post/${post.slug}`}>
                    <h1> {post.title} </h1>
                </a>
            ))
        }
    </body>
</html>
```

### G√©n√©ration des pages

La page `src/pages/post/[slug].astro` [g√©n√®re dynamiquement une page](/fr/guides/routing/#routes-dynamiques) pour chaque post.

<FileTree title="Project Structure">
- src/
 - lib/
    -  ghost.ts
  - pages/
    - index.astro
    - post/
      - **[slug].astro**
- astro.config.mjs
- package.json
</FileTree>

Importez `ghostClient()` pour acc√©der aux articles de blogs en utilisant `posts.browse()` et renvoyer un article en tant que props √† chacune de vos routes dynamiques.

```astro title="src/pages/post/[slug].astro"
---
import { ghostClient } from '../../lib/ghost';

export async function getStaticPaths() {
    const posts = await ghostClient.posts
        .browse({
            limit: 'all',
        })
        .catch((err) => {
            console.error(err);
        });

    return posts.map((post) => {
        return {
            params: {
                slug: post.slug,
            },
            props: {
                post: post,
            },
        };
    });
}

const { post } = Astro.props;
---
```

Cr√©ez le mod√®le pour chaque page en utilisant les propri√©t√©s de chaque objet `post`.

```astro title="src/pages/post/[slug].astro" ins={24-37}
---
import { ghostClient } from '../../lib/ghost';
export async function getStaticPaths() {
    const posts = await ghostClient.posts
        .browse({
            limit: 'all',
        })
        .catch((err) => {
            console.error(err);
        });
    return posts.map((post) => {
        return {
            params: {
                slug: post.slug,
            },
            props: {
                post: post,
            },
        };
    });
}
const { post } = Astro.props;
---
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>{post.title}</title>
    </head>
    <body>
        <img src={post.feature_image} alt={post.title} />

        <h1>{post.title}</h1>
        <p>{post.reading_time} min read</p>

        <Fragment set:html={post.html} />
    </body>
</html>
```
:::note
`<Fragment />` est un composant Astro int√©gr√© qui vous permet d'√©viter un √©l√©ment wrapper inutile. Cela peut √™tre particuli√®rement utile lorsque vous r√©cup√©rez du HTML √† partir d'un CMS (par exemple Ghost ou [WordPress](/fr/guides/cms/wordpress/)).
:::

### Publier votre site
Pour d√©ployer votre site, consultez notre [guide de d√©ploiement](/fr/guides/deploy/) et suivez les instructions de votre h√©bergeur pr√©f√©r√©.

## Ressources communautaires

<CardGrid>

  <LinkCard title="Tutoriel Ghost CMS & Astro (en)" href="https://matthiesen.xyz/blog/astro-ghostcms" />
  <LinkCard title="Astro + Ghost + Tailwind CSS (en)" href="https://andr.ec/posts/astro-ghost-blog/" />
  <LinkCard title="Cr√©er un site d'entreprise avec Astro et Ghost (en)" href="https://artabric.com/post/building-a-corporate-site-with-astro-and-ghost/" />
  <LinkCard title="`astro-starter-ghost` (en)" href="https://github.com/PhilDL/astro-starter-ghost" />

</CardGrid>

:::note[Vous avez une ressource √† partager‚ÄØ?]
Si vous avez trouv√© (ou cr√©√©¬†!) une vid√©o ou un article de blog utile sur l'utilisation de Ghost avec Astro, [ajoutez-le √† cette liste](https://github.com/withastro/docs/edit/main/src/content/docs/en/guides/cms/ghost.mdx)‚ÄØ!
:::
