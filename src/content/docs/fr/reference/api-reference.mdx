---
title: Contexte de rendu d'Astro
sidebar:
  label: Contexte de rendu
i18nReady: true
tableOfContents:
  minHeadingLevel: 2
  maxHeadingLevel: 4
---
import Since from '~/components/Since.astro';
import { Tabs, TabItem } from '@astrojs/starlight/components';
import ReadMore from '~/components/ReadMore.astro';

Lors du rendu d'une page, Astro fournit une API d'ex√©cution sp√©cifique au rendu actuel. Cela inclut des informations utiles telles que l'URL de la page actuelle ainsi que des API permettant d'effectuer des actions telles que la redirection vers une autre page.

Dans les composants `.astro`, ce contexte est disponible √† partir de l'objet global `Astro`. Les fonctions de point de terminaison sont √©galement appel√©es avec ce m√™me objet de contexte comme premier argument, dont les propri√©t√©s refl√®tent les propri√©t√©s globales d'Astro.

Certaines propri√©t√©s ne sont disponibles que pour les routes rendues √† la demande ou peuvent avoir des fonctionnalit√©s limit√©es sur les pages pr√©-rendues.

L'objet global `Astro` est disponible pour tous les fichiers `.astro`. Utilisez l'objet `context` dans les [fonctions de point de terminaison](/fr/guides/endpoints/) pour servir les points de terminaison de serveur statique ou en direct et dans le [middleware](/fr/guides/middleware/) pour injecter un comportement lorsqu'une page ou un point de terminaison est sur le point d'√™tre rendu.

## L'objet de contexte

Les propri√©t√©s suivantes sont disponibles sur le global `Astro` (par exemple `Astro.props`, `Astro.redirect()`) et sont √©galement disponibles sur l'objet de contexte (par exemple `context.props`, `context.redirect()`) pass√© aux fonctions de point de terminaison et au middleware.

### `props`

`props` est un objet contenant toutes les valeurs qui ont √©t√© transmises en tant qu'[attributs de composant](/fr/basics/astro-components/#props-de-composant).

```astro {3}
---
// src/components/Heading.astro
const { title, date } = Astro.props;
---
<div>
  <h1>{title}</h1>
  <p>{date}</p>
</div>
```

```astro /title=".+"/ /date=".+"/
---
// src/pages/index.astro
import Heading from '../components/Heading.astro';
---
<Heading title="Mon tout premier article" date="09 Ao√ªt 2022" />
```

<ReadMore>En savoir plus sur la fa√ßon dont les [Mises en page Markdown et MDX](/fr/guides/markdown-content/#propri√©t√©-layout-du-frontmatter) g√®rent les propri√©t√©s.</ReadMore>


L'objet `props` contient √©galement tous les `props` transmis depuis `getStaticPaths()` lors du rendu des routes statiques.

<Tabs>
  <TabItem label="Astro.props">
    ```astro title="src/pages/posts/[id].astro" "props:" {11}
    ---
    export function getStaticPaths() {
      return [
        { params: { id: '1' }, props: { author: 'Blu' } },
        { params: { id: '2' }, props: { author: 'Erika' } },
        { params: { id: '3' }, props: { author: 'Matthew' } }
      ];
    }

    const { id } = Astro.params;
    const { author } = Astro.props;
    ---
    ```
  </TabItem>
  <TabItem label="context.props">
    ```ts title="src/pages/posts/[id].json.ts" "props:" {11-15}
    import type { APIContext } from 'astro';

    export function getStaticPaths() {
      return [
        { params: { id: '1' }, props: { author: 'Blu' } },
        { params: { id: '2' }, props: { author: 'Erika' } },
        { params: { id: '3' }, props: { author: 'Matthew' } }
      ];
    }

    export function GET({ props }: APIContext) {
      return new Response(
        JSON.stringify({ author: props.author }),
      );
    }
    ```
  </TabItem>

</Tabs>
Voir aussi¬†: [Transmission de donn√©es avec `props`](/fr/reference/routing-reference/#transmission-de-donn√©es-avec-props)

### `params`

`params` est un objet contenant les valeurs des segments de route dynamiques correspondant √† une requ√™te. Ses cl√©s doivent correspondre aux [param√®tres](/fr/guides/routing/#routes-dynamiques) du chemin d'acc√®s √† la page ou au fichier de point de terminaison.

Dans les versions statiques, il s'agira des `params` renvoy√©s par `getStaticPaths()` utilis√©s pour le pr√©-rendu [des routes dynamiques](/fr/guides/routing/#routes-dynamiques).

<Tabs>
  <TabItem label="Astro.params">
    ```astro title="src/pages/posts/[id].astro" {9} "params:"
    ---
    export function getStaticPaths() {
      return [
        { params: { id: '1' } },
        { params: { id: '2' } },
        { params: { id: '3' } }
      ];
    }
    const { id } = Astro.params;
    ---
    <h1>{id}</h1>
    ```
  </TabItem>
  <TabItem label="context.params">
    ```ts title="src/pages/posts/[id].json.ts" "params:" {11-15}
    import type { APIContext } from 'astro';

    export function getStaticPaths() {
      return [
        { params: { id: '1' } },
        { params: { id: '2' } },
        { params: { id: '3' } }
      ];
    }

    export function GET({ params }: APIContext) {
      return new Response(
        JSON.stringify({ id: params.id }),
      );
    }
    ```
  </TabItem>
</Tabs>


Lorsque les routes sont rendues √† la demande, `params` peut √™tre n'importe quelle valeur correspondant aux segments de chemin dans le mod√®le de route dynamique.

```astro title="src/pages/posts/[id].astro" "Astro.params"
---
import { getPost } from '../api';

const post = await getPost(Astro.params.id);

// Aucun article trouv√© avec cet identifiant
if (!post) {
  return Astro.redirect("/404")
}
---
<html>
  <h1>{post.name}</h1>
</html>
```

Voir aussi¬†: [`params`](/fr/reference/routing-reference/#params)

### `url`

<p>

**Type¬†:** `URL`<br />
<Since v="1.0.0" />
</p>

`url` est un objet [URL](https://developer.mozilla.org/fr/docs/Web/API/URL) construit √† partir de la valeur actuelle de `request.url`. Il est utile pour interagir avec les propri√©t√©s individuelles de l'URL de la requ√™te, comme le chemin d'acc√®s et l'origine. 

`Astro.url` √©quivaut √† faire `new URL(Astro.request.url)`.

`url` sera une URL `localhost` en mode dev. Lors de la cr√©ation d'un site, les routes pr√©-rendues recevront une URL bas√©e sur les options [`site`](/fr/reference/configuration-reference/#site) et [`base`](/fr/reference/configuration-reference/#base). Si `site` n'est pas configur√©, les pages pr√©-rendues recevront √©galement une URL `localhost` pendant la construction.

```astro title="src/pages/index.astro" "Astro.url"
<h1>L'URL actuelle est : {Astro.url}</h1>
<h1>Le chemin d'acc√®s actuel de l'URL est : {Astro.url.pathname}</h1>
<h1>L'origine de l'URL actuelle est : {Astro.url.origin}</h1>
```

Vous pouvez √©galement utiliser `url` pour cr√©er de nouvelles URL en le passant comme argument √† [`new URL()`](https://developer.mozilla.org/fr/docs/Web/API/URL/URL).

```astro title="src/pages/index.astro" "Astro.url"
---
// Exemple : cr√©er une URL canonique √† l'aide de votre domaine de production
const canonicalURL = new URL(Astro.url.pathname, Astro.site);
// Exemple : cr√©ez une URL pour les balises m√©ta SEO en utilisant votre domaine actuel
const socialImageURL = new URL('/images/preview.png', Astro.url);
---
<link rel="canonical" href={canonicalURL} />
<meta property="og:image" content={socialImageURL} />
```

### `site`

<p>

**Type¬†:** `URL | undefined`
</p>

`site` renvoie une `URL` cr√©√©e √† partir du `site` d√©fini dans votre configuration Astro. Il renvoie `undefined` si vous n'avez pas d√©fini de valeur pour [`site`](/fr/reference/configuration-reference/#site) dans votre configuration Astro.

```astro title="src/pages/index.astro" "Astro.site"
<link
    rel="alternate"
    type="application/rss+xml"
    title="Le titre de votre site"
    href={new URL("rss.xml", Astro.site)}
/>
```

### `clientAddress`

<p>

**Type¬†:** `string`<br />
<Since v="1.0.0" />
</p>

`clientAddress` sp√©cifie l'[adresse IP](https://fr.wikipedia.org/wiki/Adresse_IP) de la requ√™te. Cette propri√©t√© est uniquement disponible pour les routes rendues √† la demande et ne peut pas √™tre utilis√©e sur les pages pr√©-rendues.

<Tabs>
  <TabItem label="Astro.clientAddress">
    ```astro title="src/pages/ip-address.astro" "Astro.clientAddress"
    ---
    export const prerender = false; // Pas n√©cessaire en mode `server`
    ---

    <div>Votre adresse IP est : <span class="address">{Astro.clientAddress}</span></div>
    ```
  </TabItem>
  <TabItem label="context.clientAddress">
    ```ts title="src/pages/ip-address.ts" "clientAddress"
    export const prerender = false; // Pas n√©cessaire en mode `server`
    import type { APIContext } from 'astro';

    export function GET({ clientAddress }: APIContext) {
      return new Response(`Votre adresse IP est : ${clientAddress}`);
    }
    ```
  </TabItem>
</Tabs>


### `isPrerendered`

<p>

**Type**¬†: `boolean`<br />
<Since v="5.0.0" />
</p>

Un bool√©en indiquant si la page actuelle est pr√©-rendue ou non.

Vous pouvez utiliser cette propri√©t√© pour ex√©cuter une logique conditionnelle dans un middleware, par exemple, pour √©viter d'acc√©der aux en-t√™tes dans les pages pr√©-rendues.

### `generator`

<p>

**Type¬†:** `string`<br />
<Since v="1.0.0" />
</p>

`generator` fournit la version actuelle d'Astro que votre projet ex√©cute. C'est un moyen pratique d'ajouter une balise [`<meta name="generator">`](https://html.spec.whatwg.org/multipage/semantics.html#meta-generator) avec votre version actuelle d'Astro. Il suit le format `"Astro v5.x.x"`.

<Tabs>
  <TabItem label="Astro.generator">
    ```astro title="src/pages/site-info.astro" "Astro.generator"
    <html>
      <head>
        <meta name="generator" content={Astro.generator} />
      </head>
      <body>
        <footer>
          <p>Construit avec <a href="https://astro.build">{Astro.generator}</a></p>
        </footer>
      </body>
    </html>
    ```
  </TabItem>
  <TabItem label="context.generator">
    ```ts title="src/pages/site-info.json.ts" "generator"
    import type { APIContext } from 'astro';

    export function GET({ generator, site }: APIContext) {
      const body = JSON.stringify({ generator, site });
      return new Response(body);
    }
    ```
  </TabItem>
</Tabs>

### `request`

<p>

**Type¬†:** `Request`
</p>

`Astro.request` est un objet [Request](https://developer.mozilla.org/fr/docs/Web/API/Request) standard. Il peut √™tre utilis√© pour obtenir les propri√©t√©s `url`, `headers`, `method`, et m√™me le corps de la requ√™te.

<Tabs>
  <TabItem label="Astro.request">
    ```astro wrap title="src/pages/index.astro" "Astro.request"
    <p>R√©ception d'une requ√™te {Astro.request.method} √† "{Astro.request.url}".</p>
    <p>En-t√™tes de requ√™te re√ßus :</p>
    <p><code>{JSON.stringify(Object.fromEntries(Astro.request.headers))}</code></p>
    ```
  </TabItem>
  <TabItem label="context.request">
    ```ts "request"
    import type { APIContext } from 'astro';

    export function GET({ request }: APIContext) {
      return new Response(`Hello ${request.url}`);
    }
    ```
  </TabItem>
</Tabs>

:::note
Sur les pages pr√©-rendues, `request.url` ne contient pas de param√®tres de recherche, comme `?type=new`, car il n'est pas possible de les d√©terminer √† l'avance lors des constructions statiques. Cependant, `request.url` contient des param√®tres de recherche pour les pages rendues √† la demande car ils peuvent √™tre d√©termin√©s √† partir d'une requ√™te serveur.
:::

### `response`

<p>

**Type¬†:** `ResponseInit & { readonly headers: Headers }`
</p>

`response` est un objet `ResponseInit` standard. Il a la structure suivante.

 - `status`¬†: Le code de statut num√©rique de la r√©ponse, par exemple `200`.
 - `statusText`¬†: Le message de statut associ√© au code de statut, par exemple `'OK'`.
 - `headers`¬†: Une instance [`Headers`](https://developer.mozilla.org/fr/docs/Web/API/Headers) que vous pouvez utiliser pour d√©finir les en-t√™tes HTTP de la r√©ponse.

`Astro.response` est utilis√© pour d√©finir le `status`, le `statusText` et les `headers` de la r√©ponse d'une page.


```astro
---
if(condition) {
  Astro.response.status = 404;
  Astro.response.statusText = 'Non trouv√©';
}
---
```

Ou de d√©finir un en-t√™te¬†:

```astro
---
Astro.response.headers.set('Set-Cookie', 'a=b; Path=/;');
---
```

### `redirect()`

<p>

**Type¬†:** `(path: string, status?: number) => Response`
<Since v="1.5.0" />
</p>

`redirect()` renvoie un objet [Response](https://developer.mozilla.org/fr/docs/Web/API/Response) qui vous permet de rediriger vers une autre page et √©ventuellement de fournir un [code d'√©tat de r√©ponse HTTP](https://developer.mozilla.org/fr/docs/Web/HTTP/Status#messages_de_redirection) comme deuxi√®me param√®tre.

Une page (et non un composant enfant) doit renvoyer le r√©sultat de `Astro.redirect()` pour que la redirection se produise.

Pour les routes g√©n√©r√©es de mani√®re statique, cela produira une redirection client √† l'aide d'une balise [`<meta http-equiv="refresh">`](https://developer.mozilla.org/fr/docs/Web/HTML/Element/meta#http-equiv) et ne prend pas en charge les codes d'√©tat.

Pour les routes rendues √† la demande, la d√©finition d'un code d'√©tat personnalis√© est prise en charge lors de la redirection. S'il n'est pas sp√©cifi√©, les redirections seront servies avec un code d'√©tat `302`.

L'exemple suivant redirige un utilisateur vers une page de connexion¬†:

<Tabs>
  <TabItem label="Astro.redirect()">
    ```astro title="src/pages/account.astro" {8} "Astro.redirect"
    ---
    import { isLoggedIn } from '../utils';

    const cookie = Astro.request.headers.get('cookie');

    // Si l'utilisateur n'est pas connect√©, redirigez-le vers la page de connexion
    if (!isLoggedIn(cookie)) {
      return Astro.redirect('/login');
    }
    ---
    
    <p>Informations de l'utilisateur</p>
    ```
  </TabItem>
  <TabItem label="context.redirect()">
    ```ts "redirect"
    import type { APIContext } from 'astro';

    export function GET({ redirect, request }: APIContext) {
      const cookie = request.headers.get('cookie');
      if (!isLoggedIn(cookie)) {
        return redirect('/login', 302);
      } else {
        // renvoyer les informations de l'utilisateur
      }
    }
    ```
  </TabItem>
</Tabs>


### `rewrite()`

<p>

**Type¬†:** `(rewritePayload: string | URL | Request) => Promise<Response>`<br />
<Since v="4.13.0" />
</p>

`rewrite()` vous permet de diffuser du contenu √† partir d'une URL ou d'un chemin diff√©rent sans rediriger le navigateur vers une nouvelle page.

La m√©thode accepte soit une cha√Æne de caract√®res, une `URL` ou un objet `Request` pour l'emplacement du chemin.

Utilisez une cha√Æne de caract√®res pour fournir un chemin explicite¬†:

<Tabs syncKey="rewrite">
  <TabItem label="Astro.rewrite()">
    ```astro title="src/pages/index.astro" "Astro.rewrite"
    ---
    return Astro.rewrite("/login")
    ---
    ```
  </TabItem>
  <TabItem label="context.rewrite()">
    ```ts "rewrite"
    import type { APIContext } from 'astro';

    export function GET({ rewrite }: APIContext) {
      return rewrite('/login');
    }
    ```
  </TabItem>
</Tabs>

Utilisez un type `URL` lorsque vous devez construire le chemin de l'URL pour la r√©√©criture. L'exemple suivant affiche le chemin parent d'une page en cr√©ant une nouvelle URL √† partir du chemin relatif `"../"`¬†:

<Tabs syncKey="rewrite">
  <TabItem label="Astro.rewrite()">
    ```astro title="src/pages/blog/index.astro"
    ---
    return Astro.rewrite(new URL("../", Astro.url))
    ---
    ```
  </TabItem>
  <TabItem label="context.rewrite()">
    ```ts
    import type { APIContext } from 'astro';

    export function GET({ rewrite }: APIContext) {
      return rewrite(new URL("../", Astro.url));
    }
    ```
  </TabItem>
</Tabs>

Utilisez un type `Request` pour un contr√¥le complet de la `Request` envoy√©e au serveur pour le nouveau chemin. L'exemple suivant envoie une requ√™te pour afficher la page parent tout en fournissant des en-t√™tes¬†:

<Tabs syncKey="rewrite">
  <TabItem label="Astro.rewrite()">
    ```astro title="src/pages/blog/index.astro"
    ---
    return Astro.rewrite(new Request(new URL("../", Astro.url), {
      headers: {
        "x-custom-header": JSON.stringify(Astro.locals.someValue)
      }
    }))
    ---
    ```
  </TabItem>
  <TabItem label="context.rewrite()">
    ```ts
    import type { APIContext } from 'astro';

    export function GET({ rewrite }: APIContext) {
      return rewrite(new Request(new URL("../", Astro.url), {
        headers: {
          "x-custom-header": JSON.stringify(Astro.locals.someValue)
        }
      }));
    }
    ```
  </TabItem>
</Tabs>

### `originPathname`

<p>

**Type¬†:** `string`<br />
<Since v="5.0.0" />
</p>

`originPathname` d√©finit le chemin d'acc√®s d'origine de la requ√™te, avant que les r√©√©critures ne soient appliqu√©es.

<Tabs>
  <TabItem label="Astro.originPathname">
  	```astro title="src/pages/404.astro"
    <p>Le chemin d'origine est {Astro.originPathname}</p>
    <p>Le chemin r√©√©crit est {Astro.url.pathname}</p>
    ```
  </TabItem>
  <TabItem label="context.originPathname">
    ```ts title="src/middleware.ts"
    import { defineMiddleware } from 'astro:middleware';

    export const onRequest = defineMiddleware(async (context, next) => {
      // Enregistre le chemin d'acc√®s d'origine avant toute r√©√©criture
      recordPageVisit(context.originPathname);
      return next();
    });
  ```
  </TabItem>
</Tabs>

### `locals`

<p>

<Since v="2.4.0" />
</p>

`locals` est un objet utilis√© pour stocker et acc√©der √† des informations arbitraires pendant le cycle de vie d'une requ√™te. `Astro.locals` est un objet contenant toutes les valeurs de l'objet `context.locals` d√©fini par le middleware. Utilisez-le pour acc√©der aux donn√©es renvoy√©es par le middleware dans vos fichiers `.astro`.

Les fonctions middleware peuvent √† la fois lire et √©crire les valeurs de `context.locals`¬†:

```ts title="src/middleware.ts" "locals"
import type { MiddlewareHandler } from 'astro';

export const onRequest: MiddlewareHandler = ({ locals }, next) => {
  if (!locals.title) {
    locals.title = "Titre par d√©faut";
  }
  return next();
}
```

Les composants Astro et les points de terminaison de l'API peuvent lire les valeurs depuis `locals` lorsqu'elles s'affichent¬†:

<Tabs>
  <TabItem label="Astro.locals">
    ```astro title="src/pages/Orders.astro" "Astro.locals"
    ---
    const title = Astro.locals.title;
    ---
    <h1>{title}</h1>
    ```
  </TabItem>
  <TabItem label="context.locals">
    ```ts title="src/pages/hello.ts" "locals"
    import type { APIContext } from 'astro';

    export function GET({ locals }: APIContext) {
      return new Response(locals.title); // "Titre par d√©faut"
    }
    ```
  </TabItem>
</Tabs>

### `preferredLocale`

<p>

**Type¬†:** `string | undefined`<br />
<Since v="3.5.0" />
</p>

`preferredLocale` est une valeur calcul√©e pour trouver la meilleure correspondance entre les pr√©f√©rences linguistiques du navigateur de votre visiteur et les param√®tres r√©gionaux pris en charge par votre site.

Elle est calcul√©e en v√©rifiant les param√®tres r√©gionaux configur√©s dans votre tableau [`i18n.locales`](/fr/reference/configuration-reference/#i18nlocales) et les param√®tres r√©gionaux pris en charge par le navigateur de l'utilisateur via l'en-t√™te `Accept-Language`. Cette valeur a pour valeur `undefined` si aucune correspondance de ce type n'existe.

Cette propri√©t√© est uniquement disponible pour les routes rendues √† la demande et ne peut pas √™tre utilis√©e sur des pages statiques pr√©-rendues.

### `preferredLocaleList`

<p>

**Type¬†:** `string[] | undefined`<br />
<Since v="3.5.0" />
</p>

`preferredLocaleList` repr√©sente le tableau de tous les param√®tres r√©gionaux demand√©s par le navigateur et pris en charge par votre site web. Cela g√©n√®re une liste de toutes les langues compatibles entre votre site et votre visiteur.

Si aucune des langues demand√©es par le navigateur n'est trouv√©e dans votre tableau locales, alors la valeur est `[]`. Cela se produit lorsque vous ne prenez en charge aucun des param√®tres r√©gionaux pr√©f√©r√©s de vos visiteurs.

Si le navigateur ne sp√©cifie aucune langue pr√©f√©r√©e, alors cette valeur sera celle de [`i18n.locales`](/fr/reference/configuration-reference/#i18nlocales)¬†: tous vos param√®tres r√©gionaux pris en charge seront consid√©r√©s comme √©galement pr√©f√©r√©s par un visiteur sans pr√©f√©rences.

Cette propri√©t√© n'est disponible que pour l'affichage c√¥t√© serveur (SSR) et ne doit pas √™tre utilis√©e pour les sites statiques.

### `currentLocale`

<p>

**Type¬†:** `string | undefined`<br />
<Since v="3.5.6" />
</p>

Les param√®tres r√©gionaux calcul√©s √† partir de l'URL actuelle, en utilisant la syntaxe sp√©cifi√©e dans votre configuration `locales`. Si l'URL ne contient pas de pr√©fixe `/[locale]/`, la valeur par d√©faut sera [`i18n.defaultLocale`](/fr/reference/configuration-reference/#i18ndefaultlocale).

### `getActionResult()`

<p>
**Type¬†:** `(action: TAction) => ActionReturnType<TAction> | undefined`<br />
<Since v="4.15.0" />
</p>

`getActionResult()` est une fonction qui renvoie le r√©sultat d'une soumission d'[Action](/fr/guides/actions/). Celle-ci accepte une fonction d'action comme argument (par exemple, `actions.logout`) et renvoie un objet `data` ou `error` lorsqu'une soumission est re√ßue. Sinon, elle renverra `undefined`.

```astro title="src/pages/index.astro" "Astro.getActionResult"
---
import { actions } from 'astro:actions';

const result = Astro.getActionResult(actions.logout);
---

<form action={actions.logout}>
  <button type="submit">Se d√©connecter</button>
</form>
{result?.error && <p>√âchec de la d√©connexion. Veuillez r√©essayer.</p>}
```

### `callAction()`

<p>
<Since v="4.15.0" />
</p>

`callAction()` est une fonction utilis√©e pour appeler un gestionnaire d'Action directement depuis votre composant Astro. Celle-ci accepte une fonction Action comme premier argument (par exemple `actions.logout`) et toute entr√©e que l'action re√ßoit comme deuxi√®me argument. Elle renvoie le r√©sultat de l'action sous forme de promesse.

```astro title="src/pages/index.astro" "Astro.callAction"
---
import { actions } from 'astro:actions';

const { data, error } = await Astro.callAction(actions.logout, { userId: '123' });
---
```

### `routePattern`

<p>

**Type**¬†: `string`<br />
<Since v="5.0.0" />
</p>

Le mod√®le de route charg√© de g√©n√©rer la page ou la route actuelle. Dans le routage bas√© sur des fichiers, cela ressemble au chemin d'acc√®s au fichier de votre projet utilis√© pour cr√©er la route. Lorsque les int√©grations cr√©ent des routes pour votre projet, `context.routePattern` est identique √† la valeur de `injectRoute.pattern`.

La valeur commencera par une barre oblique et ressemblera au chemin d'un composant de page par rapport √† votre dossier `src/pages/` sans extension de fichier.

Par exemple, le fichier `src/pages/en/blog/[slug].astro` renverra `/en/blog/[slug]` pour `routePattern`. Chaque page de votre site g√©n√©r√©e par ce fichier (par exemple `/en/blog/post-1/`, `/en/blog/post-2/`, etc.) partage la m√™me valeur pour `routePattern`. Dans le cas des routes `index.*`, le mod√®le de route n'inclura pas le mot ¬´¬†index¬†¬ª. Par exemple, `src/pages/index.astro` renverra `/`.

Vous pouvez utiliser cette propri√©t√© pour comprendre quelle route effectue le rendu de votre composant. Cela vous permet de cibler ou d'analyser ensemble les URL de pages g√©n√©r√©es de mani√®re similaire. Par exemple, vous pouvez l'utiliser pour restituer certaines informations de mani√®re conditionnelle ou collecter des mesures sur les routes les plus lentes.

### `cookies`

<p>

**Type¬†:** `AstroCookies`<br />
<Since v="1.4.0" />
</p>

`cookies` contient des utilitaires pour lire et manipuler les cookies pour les [routes rendues √† la demande](/fr/guides/on-demand-rendering/).

#### Utilitaires de cookies

##### `cookies.get()`

<p>

**Type¬†:** <code>(key: string, options?: <a href="#astrocookiegetoptions">AstroCookieGetOptions</a>) => <a href="#type-astrocookie">AstroCookie</a> | undefined</code>
</p>

Obtient le cookie sous la forme d'un objet [`AstroCookie`](#type-astrocookie), qui contient la `value` et des fonctions utilitaires pour convertir le cookie en types autres que des cha√Ænes de caract√®res.

##### `cookies.has()`

<p>

**Type¬†:** <code>(key: string, options?: <a href="#astrocookiegetoptions">AstroCookieGetOptions</a>) => boolean</code>
</p>

D√©termine si ce cookie existe. Si le cookie a √©t√© d√©fini via `Astro.cookies.set()` cela retournera `true`, sinon cela v√©rifiera les cookies dans `Astro.request`.

##### `cookies.set()`

<p>

**Type¬†:** <code>(key: string, value: string | object, options?: <a href="#astrocookiesetoptions">AstroCookieSetOptions</a>) => void</code>
</p>

D√©finit la cl√© du cookie (`key`) sur la valeur donn√©e. Cela tentera de convertir la valeur du cookie en une cha√Æne de caract√®res. Les options permettent de d√©finir les [caract√©ristiques du cookie](https://www.npmjs.com/package/cookie#options-1), comme `maxAge` ou `httpOnly`.

##### `cookies.delete()`

<p>

**Type¬†:** `(key: string, options?: AstroCookieDeleteOptions) => void`
</p>

Invalide un cookie en fixant la date d'expiration dans le pass√© (0 en temps Unix).

Une fois qu'un cookie est ¬´¬†supprim√©¬†¬ª (expir√©), `Astro.cookies.has()` retournera `false` et `Astro.cookies.get()` retournera un [`AstroCookie`](#type-astrocookie) avec une `valeur` de `undefined`. Les options disponibles lors de la suppression d'un cookie sont¬†: `domain`, `path`, `httpOnly`, `sameSite`, et `secure`.

##### `cookies.merge()`

<p>

**Type¬†:** `(cookies: AstroCookies) => void`
</p>

Fusionne une nouvelle instance `AstroCookies` dans l'instance actuelle. Tous les nouveaux cookies seront ajout√©s √† l'instance actuelle et tous les cookies portant le m√™me nom remplaceront les valeurs existantes.

##### `cookies.headers()`

<p>

**Type¬†:** `() => Iterator<string>`
</p>

Obtient les valeurs de l'en-t√™te `Set-Cookie` qui seront envoy√©es avec la r√©ponse.

#### Type `AstroCookie`

Le type renvoy√© apr√®s l'obtention d'un cookie via `Astro.cookies.get()`. Il a la structure suivante¬†:

##### `value`

<p>

**Type¬†:** `string`
</p>

La valeur brute de la cha√Æne du cookie.

##### `json`

<p>

**Type¬†:** `() => Record<string, any>`
</p>

Analyse la valeur du cookie via `JSON.parse()`, retournant un objet. G√©n√®re une erreur si la valeur du cookie n'est pas un JSON valide.

##### `number`

<p>

**Type¬†:** `() => number`
</p>

Analyse la valeur du cookie en tant que nombre. Renvoie NaN s'il ne s'agit pas d'un nombre valide.

##### `boolean`

<p>

**Type¬†:** `() => boolean`
</p>

Convertit la valeur du cookie en un bool√©en.

#### `AstroCookieGetOptions`

<p><Since v="4.1.0"/></p>

L'interface `AstroCookieGetOption` vous permet de sp√©cifier des options lorsque vous recevez un cookie.

##### `decode`

<p>
**Type¬†:** `(value: string) => string`
</p>

Permet de personnaliser la mani√®re dont un cookie est d√©s√©rialis√© en une valeur.

#### `AstroCookieSetOptions`

<p><Since v="4.1.0"/></p>

`AstroCookieSetOptions` est un objet qui peut √™tre transmis √† `Astro.cookies.set()` lors de la d√©finition d'un cookie pour personnaliser la mani√®re dont le cookie est s√©rialis√©.

##### `domain`

<p>

**Type¬†:** `string`
</p>

Sp√©cifie le domaine. Si aucun domaine n'est d√©fini, la plupart des clients interpr√©teront l'application au domaine actuel.

##### `expires`

<p>

**Type¬†:** `Date`
</p>

Sp√©cifie la date d'expiration du cookie.

##### `httpOnly`

<p>

**Type¬†:** `boolean`
</p>

Si la valeur est `true`, le cookie ne sera pas accessible c√¥t√© client.

##### `maxAge`

<p>

**Type¬†:** `number`
</p>

Sp√©cifie un nombre, en secondes, pour lequel le cookie est valide.

##### `path`

<p>

**Type¬†:** `string`
</p>

Sp√©cifie un sous-chemin du domaine dans lequel le cookie est appliqu√©.

##### `sameSite`

<p>

**Type¬†:** `boolean | 'lax' | 'none' | 'strict'`
</p>

Sp√©cifie la valeur de l'en-t√™te du cookie [SameSite](https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-rfc6265bis-09#section-5.4.7).

##### `secure`

<p>

**Type¬†:** `boolean`
</p>

Si c'est vrai, le cookie n'est d√©fini que sur les sites https.

##### `encode`

<p>

**Type¬†:** `(value: string) => string`
</p>

Permet de personnaliser la fa√ßon dont le cookie est s√©rialis√©.

### `session`

<p>

**Type¬†:** `AstroSession`

<Since v="5.7.0" />

</p>

`session` est un objet qui permet de stocker des donn√©es entre les requ√™tes pour [les routes rendues √† la demande](/fr/guides/on-demand-rendering/). Il est associ√© √† un cookie qui contient uniquement l'ID de session¬†: les donn√©es elles-m√™mes ne sont pas stock√©es dans le cookie.

La session est cr√©√©e lors de la premi√®re utilisation et le cookie de session est automatiquement d√©fini. L'objet `session` a pour valeur `undefined` si aucun stockage de session n'a √©t√© configur√©, ou si la route actuelle est pr√©-rendue, et enregistrera une erreur si vous essayez de l'utiliser.

Consultez [le guide des sessions](/fr/guides/sessions/) pour plus d'informations sur la fa√ßon d'utiliser les sessions dans votre projet Astro.

#### `get()`

<p>

**Type**¬†: `(key: string) => Promise<any>`

</p>

Renvoie la valeur de la cl√© donn√©e dans la session. Si la cl√© n'existe pas, la fonction renvoie `undefined`.

<Tabs>
  <TabItem label="Astro.session">
    ```astro title="src/components/Cart.astro" "Astro.session?.get('cart')"
    ---
    const cart = await Astro.session?.get('cart');
    ---
    <button>üõí {cart?.length}</button>
    ```
  </TabItem>
  <TabItem label="context.session">
    ```ts title="src/pages/api/cart.ts" "session.get('cart')"
    import type { APIContext } from 'astro';

    export async function GET({ session }: APIContext) {
      const cart = await session.get('cart');
      return Response.json({ cart });
    }
    ```

  </TabItem>
</Tabs>

#### `set()`

<p>

**Type**¬†: `(key: string, value: any, options?: { ttl: number }) => void`

</p>

D√©finit la valeur de la cl√© donn√©e dans la session. Cette valeur peut √™tre de tout type s√©rialisable. Cette m√©thode est synchrone et la valeur est imm√©diatement disponible pour r√©cup√©ration, mais elle n'est enregistr√©e dans le backend qu'√† la fin de la requ√™te.

<Tabs>
  <TabItem label="Astro.session">
    ```astro title="src/pages/products/[slug].astro" "Astro.session?.set('lastViewedProduct', slug)"
    ---
    const { slug } = Astro.params;
    Astro.session?.set('lastViewedProduct', slug);
    ---
    ```
  </TabItem>
  <TabItem label="context.session">
    ```ts title="src/pages/api/add-to-cart.ts" "session.set('cart', cart)"
    import type { APIContext } from 'astro';

    export async function POST({ session, request }: APIContext) {
      const cart = await session.get('cart');
      const newItem = await request.json();
      cart.push(newItem);
      // Enregistrer le panier mis √† jour dans la session
      session.set('cart', cart);
      return Response.json({ cart });
    }
    ```

  </TabItem>
</Tabs>

#### `regenerate()`

<p>

**Type**¬†: `() => void`

</p>

R√©g√©n√®re l'ID de session. Appelez cette fonction lorsqu'un utilisateur se connecte ou augmente ses privil√®ges, afin d'√©viter les attaques par fixation de session.

<Tabs>
  <TabItem label="Astro.session">
    ```astro title="src/pages/welcome.astro" "Astro.session?.regenerate()"
    ---
    Astro.session?.regenerate();
    ---
    ```
  </TabItem>
  <TabItem label="context.session">
    ```ts title="src/pages/api/login.ts" "session.regenerate()"
    import type { APIContext } from 'astro';

    export async function POST({ session }: APIContext) {
      // Authentifier l'utilisateur...
      doLogin();
      // R√©g√©n√©rer l'ID de session pour emp√™cher les attaques de fixation de session
      session.regenerate();
      return Response.json({ success: true });
    }
    ```

  </TabItem>
</Tabs>

#### `destroy()`

<p>

**Type**¬†: `() => void`

</p>

D√©truit la session en supprimant le cookie et l'objet du backend. Appelez cette fonction lorsqu'un utilisateur se d√©connecte ou que sa session est invalid√©e.

<Tabs>
  <TabItem label="Astro.session">
    ```astro title="src/pages/logout.astro" "Astro.session?.destroy()"
    ---
    Astro.session?.destroy();
    return Astro.redirect('/login');
    ---
    ```
  </TabItem>
  <TabItem label="context.session">
    ```ts title="src/pages/api/logout.ts" "session.destroy()"
    import type { APIContext } from 'astro';

    export async function POST({ session }: APIContext) {
      session.destroy();
      return Response.json({ success: true });
    }
    ```

  </TabItem>
</Tabs>

#### `load()`

<p>

**Type**¬†: `(id: string) => Promise<void>`
</p>

Charge une session par identifiant. En utilisation normale, une session est charg√©e automatiquement √† partir du cookie de requ√™te. Utilisez cette m√©thode pour charger une session √† partir d'un identifiant diff√©rent. Ceci est utile si vous g√©rez vous-m√™me l'identifiant de session ou si vous souhaitez suivre une session sans utiliser de cookies.

<Tabs>
  <TabItem label="Astro.session">
    ```astro title="src/pages/cart.astro" "Astro.session?.load('session-id')"
    ---
    // Charger la session √† partir d'un en-t√™te au lieu de cookies
    const sessionId = Astro.request.headers.get('x-session-id');
    await Astro.session?.load(sessionId);
    const cart = await Astro.session?.get('cart');
    ---
    <h1>Votre panier</h1>
    <ul>
      {cart?.map((item) => (
        <li>{item.name}</li>
      ))}
    </ul>
    ```
  </TabItem>
  <TabItem label="context.session">
    ```ts title="src/pages/api/load-session.ts" "session.load('session-id')"
    import type { APIRoute } from 'astro';

    export const GET: APIRoute = async ({ session, request }) => {
      // Charger la session √† partir d'un en-t√™te au lieu de cookies
      const sessionId = request.headers.get('x-session-id');
      await session.load(sessionId);
      const cart = await session.get('cart');
      return Response.json({ cart });
    };
    ```

  </TabItem>

</Tabs>


### Propri√©t√©s d'objet obsol√®tes

#### `Astro.glob()`

:::caution[Obsol√®te depuis la version 5.0]
Utilisez [`import.meta.glob` de Vite](https://vite.dev/guide/features.html#glob-import) pour interroger les fichiers de projet.

`Astro.glob('../pages/post/*.md')` peut √™tre remplac√© par¬†:

`Object.values(import.meta.glob('../pages/post/*.md', { eager: true }));`

Consultez le [guide d'importation](/fr/guides/imports/#importmetaglob) pour plus d'informations et d'utilisation.
:::

`Astro.glob()` est un moyen de charger de nombreux fichiers locaux dans la configuration de votre site statique.

```astro
---
// src/components/my-component.astro
const posts = await Astro.glob('../pages/post/*.md'); // renvoie un tableau d'articles qui se trouvent dans ./src/pages/post/*.md
---

<div>
{posts.slice(0, 3).map((post) => (
  <article>
    <h2>{post.frontmatter.title}</h2>
    <p>{post.frontmatter.description}</p>
    <a href={post.url}>Lire la suite</a>
  </article>
))}
</div>
```

`.glob()` ne prend qu'un seul param√®tre¬†: une URL relative glob des fichiers locaux que vous souhaitez importer. Elle est asynchrone et renvoie un tableau des exportations des fichiers correspondants.

`.glob()` ne peut pas prendre de variables ou de cha√Ænes de caract√®res qui les interpolent, car elles ne sont pas analysables statiquement. (Consultez [le guide d'importation](/fr/guides/imports/#valeurs-prises-en-charge) pour une solution de contournement.) Ceci est d√ª au fait que `Astro.glob()` est un wrapper de [`import.meta.glob()`](https://vite.dev/guide/features.html#glob-import) de Vite.

:::note
Vous pouvez √©galement utiliser `import.meta.glob()` lui-m√™me dans votre projet Astro. Vous pouvez le faire lorsque¬†:
- Vous avez besoin de cette fonctionnalit√© dans un fichier autre que `.astro`, comme une route API. `Astro.glob()` n'est disponible que dans les fichiers `.astro`, tandis que `import.meta.glob()` est disponible n'importe o√π dans le projet.
- Vous ne souhaitez pas charger chaque fichier imm√©diatement. `import.meta.glob()` peut renvoyer des fonctions qui importent le contenu du fichier, plut√¥t que de renvoyer le contenu lui-m√™me. Notez que cette importation inclut tous les styles et scripts de tous les fichiers import√©s. Ceux-ci seront regroup√©s et ajout√©s √† la page, qu'un fichier soit r√©ellement utilis√© ou non, car cela est d√©cid√© par une analyse statique, et non au moment de l'ex√©cution.
- Vous souhaitez acc√©der au chemin de chaque fichier. `import.meta.glob()` renvoie une association du chemin d'un fichier et de son contenu, tandis que `Astro.glob()` renvoie une liste de contenu.
- Vous souhaitez transmettre plusieurs mod√®les¬†; par exemple, vous souhaitez ajouter un ¬´¬†mod√®le n√©gatif¬†¬ª qui filtre certains fichiers. `import.meta.glob()` peut √©ventuellement prendre un tableau de cha√Ænes glob, plut√¥t qu'une seule cha√Æne de caract√®res.

En savoir plus dans la [documentation de Vite](https://vite.dev/guide/features.html#glob-import).
:::

##### Fichiers Markdown

Les fichiers Markdown charg√©s avec `Astro.glob()` renvoient l'interface `MarkdownInstance` suivante¬†:

```ts
export interface MarkdownInstance<T extends Record<string, any>> {
  /* Toutes les donn√©es sp√©cifi√©es dans le frontmatter YAML/TOML de ce fichier */
	frontmatter: T;
  /* Le chemin d'acc√®s absolu de ce fichier */
	file: string;
  /* Le chemin rendu de ce fichier */
	url: string | undefined;
  /* Composant Astro qui restitue le contenu de ce fichier */
	Content: AstroComponentFactory;
  /** (Markdown uniquement) Contenu du fichier Markdown brut, √† l'exclusion de la mise en page HTML et du frontmatter YAML/TOML */
	rawContent(): string;
  /** (Markdown uniquement) Fichier Markdown compil√© en HTML, √† l'exclusion de la mise en page HTML */
	compiledContent(): string;
  /* Fonction qui renvoie un tableau des √©l√©ments h1...h6 dans ce fichier */
	getHeadings(): Promise<{ depth: number; slug: string; text: string }[]>;
	default: AstroComponentFactory;
}
```

Vous pouvez √©ventuellement fournir un type pour la variable `frontmatter` √† l'aide d'un g√©n√©rique TypeScript.

```astro
---
interface Frontmatter {
  title: string;
  description?: string;
}
const posts = await Astro.glob<Frontmatter>('../pages/post/*.md');
---

<ul>
  {posts.map(post => <li>{post.frontmatter.title}</li>)}
</ul>
```

##### Fichiers Astro

Les fichiers Astro ont l'interface suivante¬†:

```ts
export interface AstroInstance {
  /* Le chemin d'acc√®s de ce fichier */
  file: string;
  /* L'URL de ce fichier (s'il se trouve dans le r√©pertoire des pages) */
	url: string | undefined;
	default: AstroComponentFactory;
}
```

##### Autres fichiers

D'autres fichiers peuvent avoir diff√©rentes interfaces, mais `Astro.glob()` accepte un g√©n√©rique TypeScript si vous savez exactement ce que contient un type de fichier non reconnu.

```ts
---
interface CustomDataFile {
  default: Record<string, any>;
}
const data = await Astro.glob<CustomDataFile>('../data/**/*.js');
---
```
