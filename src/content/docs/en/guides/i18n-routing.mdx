---
title: Internationalization routing (experimental)
description: Learn how to use i18n routing in Astro.
i18nReady: false
---

import FileTree from '~/components/FileTree.astro'

Astro internationalization (i18n) routing provides a set functionalities to help building localised websites. 

By default, internationalization routing functionalities are all turned off and the user needs to manually opt in them.

## Glossary

The current page will use some specific terminology related to internationalization:
- Locale: a code that represents a language.
- Localized folder: a folder/directory that is named after a locale.



## Basic Usage

1. Enable the routing via configuration

   ```js title="astro.config.mjs"
   import { defineConfig } from "astro/config"
   export default defineConfig({
     experimental: {
       i18n: {
         defaultLocale: "en",
         locales: ["es", "en", "fr"]
       }
     }
   })
   ```
2. Create the folders and pages will contain the translated pages
    <FileTree>
    - src/
      - pages/
        - en/
          - index.astro
        - es/
          - index.astro
        - fr/
          - index.astro
    </FileTree>

    :::note
    The localised folder doesn't need to be at the root of the `pages/` folder.
    :::

3. Use the virtual module [`astro:i18n`](#virtual-module-astroi18n) that will help you compute the correct localised URLs:

    ```astro title="src/pages/es/index.astro"
    ---
    import { getRelativeLocaleUrl } from "astro:i18n";
    
    const gettingStartedUrl = getRelativeLocaleUrl("es", "getting-started"); // /es/getting-started
    ---
  
    
    <a href={gettingStartedUrl}>Got to getting started</a>
    ```

## Virtual module `astro:i18n`

This module provides functions that can help you to create URLs using the locales.

All the functions below take into account the following options, so the returned paths will change based on their values:

- [`base`](http://localhost:4321/en/reference/configuration-reference/#base)
- [`trailingSlash`](http://localhost:4321/en/reference/configuration-reference/#trailingslash)
- [`build.format`](http://localhost:4321/en/reference/configuration-reference/#buildformat)
- [`site`](http://localhost:4321/en/reference/configuration-reference/#site)

### `getRelativeLocaleUrl()`


`getRelativeLocaleUrl(locale: string, path: string, options?: GetLocaleOptions): string`

Use this function to retrieve a relative path for a locale. If the locale doesn't exist, Astro throws an error. 

```astro title="src/pages/en/index.astro"
---
import {getRelativeLocaleUrl} from "astro:i18n";

getRelativeLocaleUrl("en", ""); // returns /en
getRelativeLocaleUrl("en", "getting-started"); // returns /en/getting-started
getRelativeLocaleUrl("en", "getting-started", {
  prependWith: "blog"
}); // returns /blog/en/getting-started

getRelativeLocaleUrl("en_US", "getting-started", {
  prependWith: "blog",
  normalizeLocale: true
}); // returns /blog/en-us/getting-started

---
```

### `getAbsoluteLocaleUrl()` 

`getAbsoluteLocaleUrl(locale: string, path: string, options?: GetLocaleOptions): string`


Use this function to retrieve an absolute path for a locale _if [`site`] has a value_. If [`site`] isn't, the function returns a relative URL. If the locale doesn't exist, Astro throws an error.


```astro title="src/pages/en/index.astro"
---
import {getAbsoluteLocaleUrl} from "astro:i18n";

// If `site` is set to be `https://example.com`

getAbsoluteLocaleUrl("en", ""); // returns https://example.com/en
getAbsoluteLocaleUrl("en", "getting-started"); // returns https://example.com/en/getting-started
getAbsoluteLocaleUrl("en", "getting-started", {
  prependWith: "blog"
}); // returns https://example.com/blog/en/getting-started

getAbsoluteLocaleUrl("en_US", "getting-started", {
  prependWith: "blog",
  normalizeLocale: true
}); // returns https://example.com/blog/en-us/getting-started

---
```

### `getRelativeLocaleUrlList()`

It works like [`getRelativeLocaleUrl`](#getrelativelocaleurl), so it returns a list of relative paths for all the locales.


`getRelativeLocaleUrlList(locale: string, options?: GetLocaleOptions): string[]`

### `getAbsoluteLocaleUrlList()`

`getAbsoluteLocaleUrlList(locale: string, options?: GetLocaleOptions): string[]`


It works like [`getAbsoluteLocaleUrl`](#getabsolutelocaleurl), so it returns a list of relative paths for all the locales.


## Routing strategy 

The option `i18n.routingStrategy` allows to change the behaviour of the Astro routes

### `'prefix-other-locales'`

```js title="astro.config.mjs" ins={7}
import { defineConfig } from "astro/config"
export default defineConfig({
  experimental: {
    i18n: {
      defaultLocale: "en",
      locales: ["es", "en", "fr"],
      routingStrategy: "prefix-other-locales"
    }
  }
})
```

This is the **default** value. With this option all the routes *without* locales belong to the default locale (`i18n.defaultLocale`), and the rest of the locales must have their locale code (prefix) in the URL.

- You want to have `example.come/content` for the default locale.
- You want to have `example.come/es/content` for the other locales.

### `'prefix-always'`

```js title="astro.config.mjs" ins={7}
import { defineConfig } from "astro/config"
export default defineConfig({
  experimental: {
    i18n: {
      defaultLocale: "en",
      locales: ["es", "en", "fr"],
      routingStrategy: "prefix-always"
    }
  }
})
```

With this option, all the routes must have their locale code (prefix) in URL.

- You want to have `example.com/[locale]/content` for all routes.
- You want `example.com/content` to return a 404 (not found) status code.


### Browser language detection

When i18n routing is enabled, two new properties are available via [`Astro` global object](/en/reference/api-reference/#astro-global). These values are only available when using SSR.

The values are calculated by deducing the languages supported by the browser - via the [`Accept-Language`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Language) header -  and the locales supported by the website using [`i18n.locales`].

- `Astro.preferredLocale`: it's the locale requested by the browser and supported by the website. The value is `undefined` if:
  - The browser/user didn't set any preference.
  - The languages of the browser aren't part of [`i18n.locales`].


- `Astro.preferredLocaleList`: it's the locales requested by the browser and supported by the website. The value is `[]` if the languages of the browser aren't part of [`i18n.locales`]. The value is [`i18n.locales`] if the browser/user didn't specify any preference.
  

### Fallback

The fallback is a feature that allows to redirect a user from one locale to another. This is useful when there are pages that haven't translated yet, but you want to still provide some content.

For example, we can tell Astro that when a route of the `pt` locale is missing, to redirect to the same route under the `es` locale:

```js title="astro.config.mjs" ins={6,7-9} ins=", \"pt\""
import { defineConfig } from "astro/config"
export default defineConfig({
  experimental: {
    i18n: {
      defaultLocale: "en",
      locales: ["es", "en", "fr", "pt"],
      fallback: {
        pt: "es"  
      }
    }
  }
})
```

[`site`]: http://localhost:4321/en/reference/configuration-reference/#site
[`i18n.locales`]: http://localhost:4321/en/reference/configuration-reference/#experimentali18nlocales
