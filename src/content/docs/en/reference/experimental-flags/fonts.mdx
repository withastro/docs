---
title: Experimental fonts API
sidebar:
  label: Fonts
i18nReady: true
tableOfContents:
  minHeadingLevel: 2
  maxHeadingLevel: 6
---

import Since from '~/components/Since.astro';
import ReadMore from '~/components/ReadMore.astro';
import { Steps, Tabs, TabItem } from '@astrojs/starlight/components';

<p>

**Type:** `FontFamily[]`<br />
<Since v="5.7.0" />
</p>

This experimental feature allows you to use fonts from your filesystem and various providers (eg. Google, Fontsource, Bunny...) through a unified, fully customizable and type-safe API.

Web fonts can impact page performance at both load time and rendering time. We're doing automatic [optimization](https://web.dev/learn/performance/optimize-web-fonts) by creating preload links and optimized fallbacks. We also have opiniated defaults to avoid downloading too many font files.

To enable this feature, configure an `experimental.fonts` object:

```js title="astro.config.mjs"
import { defineConfig, fontProviders } from "astro/config"

export default defineConfig({
    experimental: {
        fonts: [{
            provider: fontProviders.google(),
            name: "Roboto",
            cssVariable: "--font-roboto",
        }]
    }
})
```

Then, add a `<Font />` component and site-wide styling in your `<head>`:

```astro title="src/components/Head.astro"
---
import { Font } from 'astro:assets'
---

<Font cssVariable='--font-roboto' preload />

<style>
body {
    font-family: var(--font-roboto);
}
</style>
```

## Usage

<Steps>

1. `experimental.fonts` accepts an array of font objects. For each font, you must specify a `provider`, the family `name`, and define a `cssVariable` to refer to your font.

    - `provider`: You can choose from the list of [built-in remote providers](#available-remote-font-providers), build your own [custom font provider](#custom-font-providers), or use the [local provider](#local-font-properties) to register local font files.
    - `name`: Choose a font family supported by your provider.
    - `cssVariable`: Must be a valid [ident](https://developer.mozilla.org/en-US/docs/Web/CSS/ident) in the form of a CSS variable.

    The following example configures the ["Roboto" family from Google Fonts](https://fonts.google.com/specimen/Roboto):

    ```js title="astro.config.mjs" ins={4-8} ins="fontProviders"
    import { defineConfig, fontProviders } from "astro/config"

    export default defineConfig({
        experimental: {
            fonts: [{
                provider: fontProviders.google(),
            }]
        }
    })
    ```

    More configuration options, such as defining fallback font families, are available and some will depend on your provider. See the full [configuration reference](#font-configuration-reference) to learn more.

2. Apply styles using the `<Font />` component. It must be imported and added to your page `<head>` and `cssVariable` is required.

    ```astro title="src/components/Head.astro" ins={2, 5}
    ---
    import { Font } from 'astro:assets'
    ---

    <Font cssVariable="--font-roboto" preload />
    ```

    This is commonly done in a component such as `Head.astro` that is used in a common site layout.

    <ReadMore>See the full [`<Font>` component reference](#font--component-reference) for more information.</ReadMore>

    Since the `<Font />` component generates CSS with font declarations, you can reference the font family using the `cssVariable`:

    <Tabs>

    <TabItem label="CSS">

    ```css
    <style>
    body {
        font-family: var(--font-roboto);
    }
    </style>
    ```

    </TabItem>

    <TabItem label="Tailwind CSS 4.0">

    ```css title="src/styles/global.css" ins={4}
    @import 'tailwindcss';

    @theme {
        --font-sans: var(--font-roboto);
    }
    ```

    </TabItem>

    <TabItem label="Tailwind CSS 3.0">

    ```js title="tailwind.config.mjs" ins={6-8}
    /** @type {import("tailwindcss").Config} */
    export default {
    content: ["./src/**/*.{astro,html,js,jsx,md,mdx,svelte,ts,tsx,vue}"],
    theme: {
        extend: {},
        fontFamily: {
            sans: ["var(--font-roboto)"]
        }
    },
    plugins: [],
    };
    ```

    </TabItem>

    </Tabs>

</Steps>

## `<Font />` component reference

This component outputs style tags and preload links for a given font family.

It must be imported and added to your page `<head>`. This is commonly done in a component such as `Head.astro` that is used in a common site layout.

With this component, you have control over what font family is used on which page, and which one is preloaded.

### cssVariable

<p>

**Type:** `string`
</p>

The [`cssVariable`](#cssvariable) registered in your Astro configuration:

```astro title="src/components/Head.astro" "cssVariable"
---
import { Font } from 'astro:assets'
---

<Font cssVariable="--font-roboto" />
```

### preload

<p>

**Type:** `boolean`<br />
**Default:** `false`
</p>

Wether it should output [preload links](https://web.dev/learn/performance/optimize-web-fonts#preload) or not:

```astro title="src/components/Head.astro" "preload"
---
import { Font } from 'astro:assets'
---

<Font cssVariable="--font-roboto" preload />
```

---

You can then [use the CSS variable](#cssvariable).

## Font configuration reference

All properties of your fonts must be configured in the Astro config. Some properties are common to both remote and local fonts, and other properties are available depending on your chosen font provider.

### Common properties

The following properties are available for remote and local fonts. `provider`, `name`, and `cssVariable` are required.

```js title="astro.config.mjs"
import { defineConfig, fontProviders } from "astro/config"

export default defineConfig({
    experimental: {
        fonts: [{
            provider: fontProviders.google(),
            name: "Roboto",
            cssVariable: "--font-roboto",
            fallbacks: ["sans-serif"], // default
            optimizedFallbacks: true, // default
        }]
    }
})
```

#### provider

<p>

**Type:** `AstroFontProvider | "local"`
</p>

The source of your font files. You can use a [built-in provider](#available-remote-font-providers), write your own [custom provider](#custom-font-providers), or set to `"local"` to use local font files:

```js title="astro.config.mjs" {6}
import { defineConfig, fontProviders } from "astro/config"

export default defineConfig({
    experimental: {
        fonts: [{
            provider: fontProviders.google(),
            name: "Roboto",
            cssVariable: "--font-roboto"
        }]
    }
})
```

#### name

<p>

**Type:** `string`
</p>

The font family name, as identified by your font provider:

```js
name: "Roboto"
```

#### cssVariable

<p>

**Type:** `string`
</p>

A valid [ident](https://developer.mozilla.org/en-US/docs/Web/CSS/ident) in the form of a CSS variable:

```js
cssVariable: "--font-roboto"
```

#### fallbacks

<p>

**Type:** `string[]`<br />
**Default:** `["sans-serif"]`
</p>

An array of fonts to use when your chosen font is unavailable, or loading. Fallbacks are applied from left to right:

```js
fallbacks: ["CustomFont", "serif"]
```

If the last fallback is a [generic family name](https://developer.mozilla.org/en-US/docs/Web/CSS/font-family#generic-name), Astro will try to generate an [optimized fallback](https://developer.chrome.com/blog/font-fallbacks) using font metrics.

#### optimizedFallbacks

<p>

**Type:** `boolean`<br />
**Default:** `true`
</p>

Whether or not to enable automatic fallback font generation:

```js
optimizedFallbacks: false
```

### Remote font properties

Further configuration options are available for remote fonts. Set these to customize the data loaded from your font provider, for example to only download certain font weights or styles.

Under the hood, these options are handled by [unifont](https://github.com/unjs/unifont/).

#### weights

<p>

**Type:** `(number | string)[]`<br />
**Default:** `[400]`
</p>

An array of [font weights](https://developer.mozilla.org/en-US/docs/Web/CSS/font-weight). By defaults, defaults to weight `400` for performance reasons:

```js
weights: [200, "300", "bold"]
```

If the associated font is a [variable font](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_fonts/Variable_fonts_guide), you can specify a range of weights:

```js
weights: ["100 900"]
```

#### styles

<p>

**Type:** `string[]`<br />
**Default:** `["normal", "italic"]`
</p>

An array of [font styles](https://developer.mozilla.org/en-US/docs/Web/CSS/font-style):

```js
styles: ["normal", "oblique"]
```

#### subsets

<p>

**Type:** `string[]`<br />
**Default:** `["cyrillic-ext", "cyrillic", "greek-ext", "greek", "vietnamese", "latin-ext", "latin"]`
</p>

An array of [font subsets](https://fonts.google.com/knowledge/glossary/subsetting):

```js
subsets: ["latin"]
```

#### display

<p>

**Type:** `string`<br />
**Default:** `"swap"`
</p>

A [font display](https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/font-display):

```js
display: "block"
```

#### unicodeRange

<p>

**Type:** `string[]`<br />
**Default:** `undefined`
</p>

A [unicode range](https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/unicode-range):

```js
unicodeRange: ["U+26"]
```

#### stretch

<p>

**Type:** `string`<br />
**Default:** `undefined`
</p>

A [font stretch](https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/font-stretch):

```js
stretch: "condensed"
```

#### featureSettings

<p>

**Type:** `string`<br />
**Default:** `undefined`
</p>

Font [feature settings](https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/font-feature-settings):

```js
featureSettings: "'smcp' 2"
```

#### variationSettings

<p>

**Type:** `string`<br />
**Default:** `undefined`
</p>

Font [variation settings](https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/font-variation-settings):

```js
variationSettings: "'xhgt' 0.7"
```


### Local font properties

Further configuration options are available when using font files from the filesystem. Set these to describe the data to be loaded from your local files.

```js title="astro.config.mjs"
import { defineConfig } from "astro/config"

export default defineConfig({
    experimental: {
        fonts: [{
            provider: "local",
            name: "Roboto",
            cssVariable: "--font-roboto",
            variants: [
                {
                    weight: 300,
                    style: "normal",
                    src: ["./src/assets/fonts/roboto-300.woff2"]
                },
                {
                    weight: 500,
                    style: "normal",
                    src: ["./src/assets/fonts/roboto-500.woff2"]
                },
            ]
        }]
    }
})
```


#### Variants

Each variant represents a [`@font-face` declaration](https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/).

Set the `weight`, `style`, and `src` for each local font. Additionally, [other properties shared with remote fonts](#other-shared-properties) are available.

##### weight

<p>

**Type:** `number | string`
</p>

A [font weight](https://developer.mozilla.org/en-US/docs/Web/CSS/font-weight):

```js
weight: 200
```

If the associated font is a [variable font](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_fonts/Variable_fonts_guide), you can specify a range of weights:

```js
weight: "100 900"
```

##### style

<p>

**Type:** `string`
</p>

A [font style](https://developer.mozilla.org/en-US/docs/Web/CSS/font-style):

```js
style: "normal"
```

##### src

<p>

**Type:** `string | URL | { url: string | URL; tech?: string }`
</p>

Font [sources](https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/src). It can be a path relative to the root, a package import or a URL:

```js
src: [
    "./src/assets/fonts/MyFont.woff2",
    new URL("./custom.ttf", import.meta.url),
    "my-package/SomeFont.ttf"
]
```

URLs are particularly useful if you inject local fonts through an integration.

You can also specify a [tech](https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/src#tech) by providing objects:

```js
src: [{ url:"./src/assets/fonts/MyFont.woff2", tech: "color-COLRv1" }]
```

##### Other shared properties

The following options from remote font families are also available for local font families:

- [display](#display)
- [unicodeRange](#unicoderange)
- [stretch](#stretch)
- [featureSettings](#featuresettings)
- [variationSettings](#variationsettings)


## Available remote font providers

Astro re-exports most [unifont](https://github.com/unjs/unifont/) providers:

```js
import { fontProviders } from "astro/config"
```


The following are providers are built in and available to use. However, any unifont provider can be used to make a [custom Astro font provider](#custom-font-providers).

### adobe

```js title="astro.config.mjs"
provider: fontProviders.adobe({
    id: process.env.ADOBE_ID
})
```

### bunny

```js title="astro.config.mjs"
provider: fontProviders.bunny()
```

### fontshare

```js title="astro.config.mjs"
provider: fontProviders.fontshare()
```

### fontsource

```js title="astro.config.mjs"
provider: fontProviders.fontsource()
```

### google

```js title="astro.config.mjs"
provider: fontProviders.google()
```

## Custom font providers

You can build a custom font provider...

An Astro font provider is made of 2 parts: the config object and the actual implementation.

### Config object

You can use the `defineAstroFontProvider()` type helper:

```ts title="provider/config.ts"
import { defineAstroFontProvider } from 'astro/config'

interface Config {
    // ...
}

export function myProvider(config: Config) {
    return defineAstroFontProvider({
        name: 'my-provider',
        entrypoint: new URL('./implementation.js', import.meta.url),
        config
    })
}
```

:::note

1. The `entrypoint` can be a URL, a path relative to the root or a package import
3. The `config` is optional and must be serializable

:::

### Implementation

The file linked by the the `entrypoint` must contain a named `provider` export, which is a [unifont](https://github.com/unjs/unifont/) provider:

```ts
import { defineFontProvider } from "unifont"

export const provider = defineFontProvider("my-provider", async (options, ctx) => {
    // ...
})
```

:::note

We recommend you look at [unifont providers' source](https://github.com/unjs/unifont/blob/main/src/providers/) to learn more about how to create a unifont provider.

:::

## Caching

In order to avoid downloading files if not needed, caching has been implemented.

### Development

- If a font file is requested, it will first check if it has been downloaded locally and load it. Otherwise it will make a network request
- Font files are downloaded on demand. We only download them if they're requested by the browser
- They are not cached in the browser however, to avoid getting stale assets
- To clear the cache, remove the `.astro/fonts` directory

### Build

- All font files are requested. For each file, it will first check if it has been downloaded locally and load it. Otherwise it will make a network request
- Font files are copied to the `_astro/fonts` output directory, so they can benefit from HTTP caching of static assets
- To clear the cache, remove the `node_modules/.astro/font` directory

## Further reading

For full details and to give feedback on this experimental API, see [the Fonts RFC](https://github.com/withastro/roadmap/blob/rfc/fonts/proposals/0052-fonts.md).
