---
title: Config imports API Reference
sidebar:
  label: 'astro:config'
i18nReady: true
tableOfContents:
  minHeadingLevel: 2
  maxHeadingLevel: 6
---

import ReadMore from '~/components/ReadMore.astro';
import Since from '~/components/Since.astro';

<p><Since v="5.7.0" /></p>

This virtual module `astro:config` exposes a non-exhaustive, serializable, type-safe version of the Astro configuration. There are two submodules for accessing different subsets of your configuration values: [`/client`](#imports-from-astroconfigclient) and [`/server`](#imports-from-astroconfigserver).

All available config values can be accessed from `astro:config/server`. However, for code executed on the client, only those values exposed by `astro:config/client` will be available.  This protects your information by only making some data available to the client.

## Imports from `astro:config/client`

The following helpers are imported from the `client` directory of the virtual config module.

```js
import {
  i18n, 
  trailingSlash,
  base,
  build,
  site,
  compressHTML,
} from "astro:config/client";
```

Use this submodule for client-side code:

```js title="src/utils.js" ins={1} ins="trailingSlash"
import { trailingSlash } from "astro:config/client";

function addForwardSlash(path) {
  if (trailingSlash === "always") {
    return path.endsWith("/") ? path : path + "/"
  } else {
    return path
  }
}
```

See more about the configuration imports available from `astro:config/client`:

- [`i18n`](/en/reference/configuration-reference/#i18n)
- [`trailingSlash`](/en/reference/configuration-reference/#trailingslash)
- [`base`](/en/reference/configuration-reference/#base)
- [`build.format`](/en/reference/configuration-reference/#buildformat)
- [`site`](/en/reference/configuration-reference/#site)
- [`compressHTML`](/en/reference/configuration-reference/#compresshtml)



## Imports from `astro:config/server`

The following helpers are imported from the `server` directory of the virtual config module.

```js
import {
  i18n, 
  trailingSlash,
  base,
  build,
  site,
  srcDir,
  cacheDir,
  outDir,
  publicDir,
  root,
  compressHTML,
} from "astro:config/server";
```

These imports include everything available from `astro:config/client` as well as additional sensitive information about your file system configuration that is not safe to expose to the client.

Use this submodule for server side code:

```js title="astro.config.mjs"
import { integration } from "./integration.mjs";

export default defineConfig({
    integrations: [
      integration(),
    ]
});
```

```js title="integration.mjs" ins={1} ins="outDir"
import { outDir } from "astro:config/server";
import { writeFileSync } from "node:fs";
import { fileURLToPath } from "node:url";

export default function() {
  return {
    name: "internal-integration",
    hooks: {
      "astro:build:done": () => {
        let file = new URL("result.json", outDir);
        // generate data from some operation
        let data = JSON.stringify([]);
        writeFileSync(fileURLToPath(file), data, "utf-8");
      }
    }
  }
}
```

See more about the configuration imports available from `astro:config/server`:

- [`i18n`](/en/reference/configuration-reference/#i18n)
- [`trailingSlash`](/en/reference/configuration-reference/#trailingslash)
- [`base`](/en/reference/configuration-reference/#base)
- [`build.format`](/en/reference/configuration-reference/#buildformat)
- [`build.client`](/en/reference/configuration-reference/#buildclient)
- [`build.server`](/en/reference/configuration-reference/#buildserver)
- [`site`](/en/reference/configuration-reference/#site)
- [`srcDir`](/en/reference/configuration-reference/#srcdir)
- [`cacheDir`](/en/reference/configuration-reference/#cachedir)
- [`outDir`](/en/reference/configuration-reference/#outdir)
- [`publicDir`](/en/reference/configuration-reference/#publicdir)
- [`root`](/en/reference/configuration-reference/#root)
- [`compressHTML`](/en/reference/configuration-reference/#compresshtml)

## Imports from `astro/config`

The following helpers are imported from the regular config module:

```js
import {
  defineConfig,
  envField,
  fontProviders,
  getViteConfig,
  mergeConfig,
  passthroughImageService,
  sessionDrivers,
  sharpImageService,
  validateConfig,
} from "astro/config";
```

### `defineConfig()`

<p>

**Type:** <code>(config: <a href="/en/reference/configuration-reference/">AstroUserConfig</a>) => AstroUserConfig</code>
</p>

Configures your project with type safety [in a supported Astro configuration file](/en/guides/configuring-astro/#the-astro-config-file).

### `envField`

<p>

**Type:** `object`<br />
<Since v="5.0.0" />
</p>

Describes the supported data types when [defining environment variables](/en/reference/configuration-reference/#envschema). Each data type requires the `context` and `access` properties [defining the variable type](/en/guides/environment-variables/#variable-types) and accepts additional options specific to the data type.

<ReadMore>Learn more about [using type safe environment variables](/en/guides/environment-variables/#type-safe-environment-variables) in your Astro project.</ReadMore>

#### `envField.string()`

<p>

**Type:** `(options: StringFieldInput) => StringField`
</p>

Defines an environment variable of string type.

The following example defines the expected shape for an environment variable storing an API URL:

```js title="astro.config.mjs" "envField"
import { defineConfig, envField } from "astro/config";

export default defineConfig({
  env: {
    schema: {
      API_URL: envField.string({
        context: "client",
        access: "public",
        optional: false,
        default: "",
        max: 100,
        min: 12,
        length: 13,
        url: true,
        includes: "astro",
        startsWith: "https",
        endsWith: "/",
      }),
    }
  }
})
```

#### `envField.number()`

<p>

**Type:** `(options: NumberFieldInput) => NumberField`
</p>

Defines an environment variable of number type.

The following example defines the expected shape for an environment variable storing an API port:

```js title="astro.config.mjs" "envField"
import { defineConfig, envField } from "astro/config";

export default defineConfig({
  env: {
    schema: {
      API_PORT: envField.number({
        context: "server",
        access: "public",
        optional: true,
        default: 4321,
        gt: 2,
        min: 1,
        lt: 4,
        max: 4,
        int: true,
      }),
    }
  }
})
```

#### `envField.boolean()`

<p>

**Type:** `(options: BooleanFieldInput) => BooleanField`
</p>

Defines an environment variable of boolean type.

The following example defines the expected shape for an environment variable storing whether analytics are enabled:

```js title="astro.config.mjs" "envField"
import { defineConfig, envField } from "astro/config";

export default defineConfig({
  env: {
    schema: {
      ANALYTICS_ENABLED: envField.boolean({
        context: "client",
        access: "public",
        optional: true,
        default: true,
      }),
    }
  }
})
```

#### `envField.enum()`

<p>

**Type:** `(options: EnumFieldInput<T>) => EnumField`
</p>

Defines an environment variable of enum type.

The following example defines the expected shape for an environment variable storing the configured debug mode:

```js title="astro.config.mjs" "envField"
import { defineConfig, envField } from "astro/config";

export default defineConfig({
  env: {
    schema: {
      DEBUG_MODE: envField.enum({
        context: "server",
        access: "public",
        values: ['info', 'warnings', 'errors'], // required
        optional: true,
        default: 'errors',
      }),
    }
  }
})
```

### `fontProviders`

<p>

**Type:** `object`<br />
<Since v="6.0.0" />
</p>

Describes the [built-in provider](/en/reference/font-provider-reference/#built-in-providers) used [to retrieve the configured font](/en/reference/configuration-reference/#fontprovider).

### `getViteConfig()`

<p>

**Type:** <code>(userViteConfig: <a href="/en/reference/configuration-reference/#vite">ViteUserConfig</a>, inlineAstroConfig?: <a href="/en/reference/configuration-reference/">AstroInlineConfig</a>) => ViteUserConfigFn</code>
</p>

Retrieves the Vite configuration to use by merging a custom Vite configuration object and an optional Astro configuration object. This is useful [to set up Vitest for testing](/en/guides/testing/#vitest).

### `mergeConfig()`

<p>

**Type:** <code>(defaults: <a href="/en/reference/configuration-reference/">AstroConfig</a>, overrides: DeepPartial\<AstroConfig\>) => AstroConfig</code><br />
<Since v="5.4.0" />
</p>

Takes an Astro configuration object and a partial object containing any set of valid Astro configuration options, and returns a valid Astro configuration combining the two values such that:

- Arrays are concatenated (including integrations and remark plugins).
- Objects are merged recursively.
- Vite options are merged using [Vite's own `mergeConfig()` function](https://vite.dev/guide/api-javascript#mergeconfig) with the default `isRoot` flag.
- Options that can be provided as functions are wrapped into new functions that recursively merge the return values from both configurations with these same rules.
- All other options override the existing config.

```ts
import { mergeConfig } from "astro/config";

mergeConfig(
  {
    output: "static",
    site: "https://example.com",
    integrations: [partytown()],
    server: ({command}) => ({
      port: command === "dev" ? 4321 : 1234,
    }),
    build: {
      client: "./custom-client",
    },
  },
  {
    output: "server",
    base: "/astro",
    integrations: [mdx()],
    server: ({command}) => ({
      host: command === "dev" ? "localhost" : "site.localhost",
    }),
    build: {
      server: "./custom-server",
    },
  }
);

// Result is equivalent to:
{
  output: "server",
  site: "https://example.com",
  base: "/astro",
  integrations: [partytown(), mdx()],
  server: ({command}) => ({
    port: command === "dev" ? 4321 : 1234,
    host: command === "dev" ? "localhost" : "site.localhost",
  }),
  build: {
    client: "./custom-client",
    server: "./custom-server",
  },
}
```

### `passthroughImageService()`

<p>

**Type:** <code>() => <a href="/en/reference/modules/astro-assets/#imageserviceconfig">ImageServiceConfig</a></code>
</p>

Retrieves a no-op image service. This is useful when your adapter does not support Astro's built-in Sharp image optimization and you want to [use the `<Image />` and `<Picture />` components](/en/guides/images/#astro-components-for-images).

The following example defines `passthroughImageService()` as image service in the Astro configuration file to avoid Sharp image processing:

```js title="astro.config.mjs" "passthroughImageService"
import { defineConfig, passthroughImageService } from "astro/config";

export default defineConfig({
  image: {
    service: passthroughImageService()
  }
});
```

<ReadMore>Learn more about [configuring a no-op passthrough service](/en/guides/images/#configure-no-op-passthrough-service).</ReadMore>

### `sessionDrivers`

<p>

**Type:** `object`<br />
<Since v="5.7.0" />
</p>

Describes the [built-in driver](/en/reference/session-driver-reference/#built-in-drivers) used [for session storage](/en/reference/configuration-reference/#session-options).

The following example configures the Redis driver to enable sessions:

```js title="astro.config.mjs" "sessionDrivers"
import { defineConfig, sessionDrivers } from "astro/config";

export default defineConfig({
  session: {
    driver: sessionDrivers.redis({
      url: process.env.REDIS_URL
    }),
  }
})
```

<ReadMore>Learn more about [using sessions](/en/guides/sessions/) in your Astro project.</ReadMore>

### `sharpImageService()`

<p>

**Type:** <code>(config?: SharpImageServiceConfig) => <a href="/en/reference/modules/astro-assets/#imageserviceconfig">ImageServiceConfig</a></code><br />
<Since v="2.4.1" />
</p>

Retrieves the Sharp service used to process Astroâ€™s image assets. This takes an optional object describing the [configuration options for Sharp](/en/reference/configuration-reference/#imageservice).

### `validateConfig()`

<p>

**Type:** <code>(userConfig: any, root: string, cmd: string) => Promise\<<a href="/en/reference/configuration-reference/">AstroConfig</a>\></code><br />
<Since v="5.4.0" />
</p>

Validates an object as if it was exported from `astro.config.mjs` and imported by Astro. This takes the following arguments: 
- The configuration to be validated.
- The [root directory of the project](/en/reference/configuration-reference/#root).
- The [Astro command that is being executed](/en/reference/cli-reference/#astro-commands) (e.g. `build`, `dev`, `sync`)

The returned promise resolves to the validated configuration, filled with all default values appropriate for the given Astro command.

```ts
import { validateConfig } from "astro/config";

const config = await validateConfig({
  integrations: [partytown()],
}, "./my-project", "build");

// defaults are applied
await rm(config.outDir, { recursive: true, force: true });
```

<ReadMore>Learn more about [using Astro CLI programmatically](/en/reference/programmatic-reference/).</ReadMore>
