---
type: integration
title: '@astrojs/markdoc'
description: T√¨m hi·ªÉu c√°ch s·ª≠ d·ª•ng t√≠ch h·ª£p @astrojs/markdoc trong d·ª± √°n Astro c·ªßa b·∫°n.
sidebar:
  label: Markdoc
githubIntegrationURL: 'https://github.com/withastro/astro/tree/main/packages/integrations/markdoc/'
category: other
i18nReady: true
---
import { FileTree } from '@astrojs/starlight/components';
import PackageManagerTabs from '~/components/tabs/PackageManagerTabs.astro';
import { Steps } from '@astrojs/starlight/components';
import ReadMore from '~/components/ReadMore.astro';

**[T√≠ch h·ª£p Astro][astro-integration]** n√†y cho ph√©p s·ª≠ d·ª•ng [Markdoc](https://markdoc.dev/) ƒë·ªÉ t·∫°o components, pages, v√† content collection entries.

## T·∫°i sao Markdoc?

Markdoc cho ph√©p b·∫°n n√¢ng cao Markdown c·ªßa m√¨nh v·ªõi [Astro components][astro-components]. N·∫øu b·∫°n c√≥ n·ªôi dung hi·ªán c√≥ ƒë∆∞·ª£c vi·∫øt b·∫±ng Markdoc, t√≠ch h·ª£p n√†y cho ph√©p b·∫°n mang nh·ªØng t·ªáp ƒë√≥ v√†o d·ª± √°n Astro b·∫±ng content collections.

## C√†i ƒë·∫∑t

Astro bao g·ªìm l·ªánh `astro add` ƒë·ªÉ t·ª± ƒë·ªông h√≥a vi·ªác thi·∫øt l·∫≠p c√°c t√≠ch h·ª£p ch√≠nh th·ª©c. N·∫øu b·∫°n mu·ªën, b·∫°n c√≥ th·ªÉ [c√†i ƒë·∫∑t t√≠ch h·ª£p th·ªß c√¥ng](#manual-install) thay th·∫ø.

Ch·∫°y m·ªôt trong c√°c l·ªánh sau trong c·ª≠a s·ªï terminal m·ªõi.

<PackageManagerTabs>
  <Fragment slot="npm">
  ```sh
  npx astro add markdoc
  ```
  </Fragment>
  <Fragment slot="pnpm">
  ```sh
  pnpm astro add markdoc
  ```
  </Fragment>
  <Fragment slot="yarn">
  ```sh
  yarn astro add markdoc
  ```
  </Fragment>
</PackageManagerTabs>

N·∫øu b·∫°n g·∫∑p v·∫•n ƒë·ªÅ g√¨, [h√£y b√°o c√°o cho ch√∫ng t√¥i tr√™n GitHub](https://github.com/withastro/astro/issues) v√† th·ª≠ c√°c b∆∞·ªõc c√†i ƒë·∫∑t th·ªß c√¥ng b√™n d∆∞·ªõi.

### C√†i ƒë·∫∑t th·ªß c√¥ng

ƒê·∫ßu ti√™n, c√†i ƒë·∫∑t g√≥i `@astrojs/markdoc`:

<PackageManagerTabs>
  <Fragment slot="npm">
  ```sh
  npm install @astrojs/markdoc
  ```
  </Fragment>
  <Fragment slot="pnpm">
  ```sh
  pnpm add @astrojs/markdoc
  ```
  </Fragment>
  <Fragment slot="yarn">
  ```sh
  yarn add @astrojs/markdoc
  ```
  </Fragment>
</PackageManagerTabs>

Sau ƒë√≥, √°p d·ª•ng t√≠ch h·ª£p v√†o t·ªáp `astro.config.*` c·ªßa b·∫°n b·∫±ng thu·ªôc t√≠nh `integrations`:

```js ins="markdoc()" title="astro.config.mjs" ins={2}
import { defineConfig } from 'astro/config';
import markdoc from '@astrojs/markdoc';
export default defineConfig({
  // ...
  integrations: [markdoc()],
});
```

### T√≠ch h·ª£p VS Code Editor

N·∫øu b·∫°n ƒëang s·ª≠ d·ª•ng VS Code, c√≥ m·ªôt [extension ng√¥n ng·ªØ Markdoc ch√≠nh th·ª©c](https://marketplace.visualstudio.com/items?itemName=Stripe.markdoc-language-support) bao g·ªìm syntax highlighting v√† autocomplete cho c√°c tags ƒë√£ c·∫•u h√¨nh. [Xem language server tr√™n GitHub](https://github.com/markdoc/language-server.git) ƒë·ªÉ bi·∫øt th√™m th√¥ng tin.

ƒê·ªÉ thi·∫øt l·∫≠p extension, t·∫°o t·ªáp `markdoc.config.json` trong th∆∞ m·ª•c g·ªëc d·ª± √°n v·ªõi n·ªôi dung sau:

```json title="markdoc.config.json"
[
  {
    "id": "my-site",
    "path": "src/content",
    "schema": {
      "path": "markdoc.config.mjs",
      "type": "esm",
      "property": "default",
      "watch": true
    }
  }
]
```

ƒê·∫∑t `markdoc.config.mjs` l√†m t·ªáp c·∫•u h√¨nh c·ªßa b·∫°n v·ªõi ƒë·ªëi t∆∞·ª£ng `schema`, v√† ƒë·ªãnh nghƒ©a n∆°i l∆∞u tr·ªØ c√°c t·ªáp Markdoc c·ªßa b·∫°n b·∫±ng thu·ªôc t√≠nh `path`. V√¨ Markdoc d√†nh ri√™ng cho content collections, b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng `src/content`.

## S·ª≠ d·ª•ng

C√°c t·ªáp Markdoc ch·ªâ c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng trong content collections. Th√™m entries v√†o b·∫•t k·ª≥ content collection n√†o b·∫±ng extension `.mdoc`:

<FileTree>
- src/
  - content/
    - docs/
      - why-markdoc.mdoc
      - quick-start.mdoc
</FileTree>

Sau ƒë√≥, query collection c·ªßa b·∫°n b·∫±ng [Content Collection APIs](/vi/guides/content-collections/#querying-collections):

```astro title="src/pages/why-markdoc.astro"
---
import { getEntry, render } from 'astro:content';

const entry = await getEntry('docs', 'why-markdoc');
const { Content } = await render(entry);
---

<!--Truy c·∫≠p thu·ªôc t√≠nh frontmatter v·ªõi `data`-->
<h1>{entry.data.title}</h1>
<!--Render n·ªôi dung Markdoc v·ªõi component Content-->
<Content />
```

<ReadMore>Xem [t√†i li·ªáu Astro Content Collection][astro-content-collections] ƒë·ªÉ bi·∫øt th√™m th√¥ng tin.</ReadMore>

## Truy·ªÅn bi·∫øn Markdoc

B·∫°n c√≥ th·ªÉ c·∫ßn truy·ªÅn [variables][markdoc-variables] cho n·ªôi dung c·ªßa m√¨nh. ƒêi·ªÅu n√†y h·ªØu √≠ch khi truy·ªÅn tham s·ªë SSR nh∆∞ A/B tests.

Bi·∫øn c√≥ th·ªÉ ƒë∆∞·ª£c truy·ªÅn nh∆∞ props th√¥ng qua component `Content`:

```astro title="src/pages/why-markdoc.astro"
---
import { getEntry, render } from 'astro:content';

const entry = await getEntry('docs', 'why-markdoc');
const { Content } = await render(entry);
---

<!--Truy·ªÅn tham s·ªë `abTest` nh∆∞ m·ªôt bi·∫øn-->
<Content abTestGroup={Astro.params.abTestGroup} />
```

B√¢y gi·ªù, `abTestGroup` c√≥ s·∫µn nh∆∞ m·ªôt bi·∫øn trong `docs/why-markdoc.mdoc`:

```md title="src/content/docs/why-markdoc.mdoc"
{% if $abTestGroup === 'image-optimization-lover' %}

H√£y ƒë·ªÉ t√¥i k·ªÉ cho b·∫°n v·ªÅ t·ªëi ∆∞u h√≥a h√¨nh ·∫£nh...

{% /if %}
```

ƒê·ªÉ l√†m cho m·ªôt bi·∫øn tr·ªü th√†nh global cho t·∫•t c·∫£ c√°c t·ªáp Markdoc, b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng thu·ªôc t√≠nh `variables` t·ª´ `markdoc.config.mjs|ts` c·ªßa b·∫°n:

```js title="markdoc.config.mjs"
import { defineMarkdocConfig } from '@astrojs/markdoc/config';

export default defineMarkdocConfig({
  variables: {
    environment: process.env.IS_PROD ? 'prod' : 'dev',
  },
});
```

### Truy c·∫≠p frontmatter t·ª´ n·ªôi dung Markdoc c·ªßa b·∫°n

ƒê·ªÉ truy c·∫≠p frontmatter, b·∫°n c√≥ th·ªÉ truy·ªÅn thu·ªôc t√≠nh `data` c·ªßa entry nh∆∞ m·ªôt bi·∫øn t·∫°i n∆°i b·∫°n render n·ªôi dung:

```astro title="src/pages/why-markdoc.astro"
---
import { getEntry, render } from 'astro:content';

const entry = await getEntry('docs', 'why-markdoc');
const { Content } = await render(entry);
---

<Content frontmatter={entry.data} />
```

ƒêi·ªÅu n√†y b√¢y gi·ªù c√≥ th·ªÉ ƒë∆∞·ª£c truy c·∫≠p nh∆∞ `$frontmatter` trong Markdoc c·ªßa b·∫°n.

## Render components

`@astrojs/markdoc` cung c·∫•p c√°c t√πy ch·ªçn c·∫•u h√¨nh ƒë·ªÉ s·ª≠ d·ª•ng t·∫•t c·∫£ c√°c t√≠nh nƒÉng c·ªßa Markdoc v√† k·∫øt n·ªëi c√°c component UI v·ªõi n·ªôi dung c·ªßa b·∫°n.

### S·ª≠ d·ª•ng Astro components nh∆∞ Markdoc tags

B·∫°n c√≥ th·ªÉ c·∫•u h√¨nh [Markdoc tags][markdoc-tags] √°nh x·∫° ƒë·∫øn c√°c component `.astro`. B·∫°n c√≥ th·ªÉ th√™m tag m·ªõi b·∫±ng c√°ch t·∫°o t·ªáp `markdoc.config.mjs|ts` t·∫°i g·ªëc d·ª± √°n v√† c·∫•u h√¨nh thu·ªôc t√≠nh `tag`.

V√≠ d·ª• n√†y render component `Aside`, v√† cho ph√©p prop `type` ƒë∆∞·ª£c truy·ªÅn nh∆∞ m·ªôt string:

```js title="markdoc.config.mjs"
import { defineMarkdocConfig, component } from '@astrojs/markdoc/config';

export default defineMarkdocConfig({
  tags: {
    aside: {
      render: component('./src/components/Aside.astro'),
      attributes: {
        // Markdoc y√™u c·∫ßu type defs cho m·ªói attribute.
        // Nh·ªØng c√°i n√†y n√™n mirror type `Props` c·ªßa component
        // b·∫°n ƒëang rendering.
        // Xem t√†i li·ªáu Markdoc v·ªÅ defining attributes
        // https://markdoc.dev/docs/attributes#defining-attributes
        type: { type: String },
      },
    },
  },
});
```

Component n√†y b√¢y gi·ªù c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng trong c√°c t·ªáp Markdoc c·ªßa b·∫°n v·ªõi tag `{% aside %}`. Children s·∫Ω ƒë∆∞·ª£c truy·ªÅn ƒë·∫øn default slot c·ªßa component:

```md
# Ch√†o m·ª´ng ƒë·∫øn Markdoc üëã

{% aside type="tip" %}

S·ª≠ d·ª•ng c√°c tags nh∆∞ "aside" fancy n√†y ƒë·ªÉ th√™m m·ªôt ch√∫t _flair_ v√†o docs c·ªßa b·∫°n.

{% /aside %}
```

### S·ª≠ d·ª•ng client-side UI components

Tags v√† nodes b·ªã gi·ªõi h·∫°n ·ªü c√°c t·ªáp `.astro`. ƒê·ªÉ nh√∫ng client-side UI components trong Markdoc, [s·ª≠ d·ª•ng wrapper component `.astro` render framework component](/vi/guides/framework-components/#nesting-framework-components) v·ªõi directive `client:` mong mu·ªën c·ªßa b·∫°n.

V√≠ d·ª• n√†y wrap React component `Aside.tsx` v·ªõi component `ClientAside.astro`:

```astro title="src/components/ClientAside.astro"
---
import Aside from './Aside';
---

<Aside {...Astro.props} client:load />
```

Component Astro n√†y b√¢y gi·ªù c√≥ th·ªÉ ƒë∆∞·ª£c truy·ªÅn ƒë·∫øn prop `render` cho b·∫•t k·ª≥ [tag][markdoc-tags] ho·∫∑c [node][markdoc-nodes] n√†o trong c·∫•u h√¨nh c·ªßa b·∫°n:

```js title="markdoc.config.mjs"
import { defineMarkdocConfig, component } from '@astrojs/markdoc/config';

export default defineMarkdocConfig({
  tags: {
    aside: {
      render: component('./src/components/ClientAside.astro'),
      attributes: {
        type: { type: String },
      },
    },
  },
});
```

### S·ª≠ d·ª•ng Astro components t·ª´ npm packages v√† TypeScript files

B·∫°n c√≥ th·ªÉ c·∫ßn s·ª≠ d·ª•ng c√°c Astro component ƒë∆∞·ª£c export nh∆∞ named exports t·ª´ c√°c t·ªáp TypeScript ho·∫∑c JavaScript. ƒêi·ªÅu n√†y ph·ªï bi·∫øn khi s·ª≠ d·ª•ng c√°c npm packages v√† design systems.

B·∫°n c√≥ th·ªÉ truy·ªÅn t√™n import nh∆∞ ƒë·ªëi s·ªë th·ª© hai cho h√†m `component()`:

```js title="markdoc.config.mjs"
import { defineMarkdocConfig, component } from '@astrojs/markdoc/config';

export default defineMarkdocConfig({
  tags: {
    tabs: {
      render: component('@astrojs/starlight/components', 'Tabs'),
    },
  },
});
```

ƒêi·ªÅu n√†y t·∫°o ra c√¢u l·ªánh import sau b√™n trong:

```ts
import { Tabs } from '@astrojs/starlight/components';
```

## Markdoc Partials

Tag `{% partial /%}` cho ph√©p b·∫°n render c√°c t·ªáp `.mdoc` kh√°c b√™n trong n·ªôi dung Markdoc c·ªßa b·∫°n.

ƒêi·ªÅu n√†y h·ªØu √≠ch ƒë·ªÉ t√°i s·ª≠ d·ª•ng n·ªôi dung qua nhi·ªÅu t√†i li·ªáu, v√† cho ph√©p b·∫°n c√≥ c√°c t·ªáp n·ªôi dung `.mdoc` kh√¥ng tu√¢n theo schema collection c·ªßa b·∫°n.

:::tip
S·ª≠ d·ª•ng ti·ªÅn t·ªë underscore `_` cho c√°c t·ªáp ho·∫∑c th∆∞ m·ª•c partial. ƒêi·ªÅu n√†y lo·∫°i tr·ª´ partials kh·ªèi c√°c queries content collection.
:::

V√≠ d·ª• n√†y hi·ªÉn th·ªã partial Markdoc cho footer ƒë∆∞·ª£c s·ª≠ d·ª•ng b√™n trong c√°c entries c·ªßa blog collection:

```md title="src/content/blog/_footer.mdoc"
Li√™n k·∫øt x√£ h·ªôi:

- [Twitter / X](https://twitter.com/astrodotbuild)
- [Discord](https://astro.build/chat)
- [GitHub](https://github.com/withastro/astro)
```

S·ª≠ d·ª•ng tag `{% partial /%}` v·ªõi ƒë·ªÉ render footer ·ªü cu·ªëi entry blog post. √Åp d·ª•ng thu·ªôc t√≠nh `file` v·ªõi ƒë∆∞·ªùng d·∫´n ƒë·∫øn t·ªáp, s·ª≠ d·ª•ng ƒë∆∞·ªùng d·∫´n t∆∞∆°ng ƒë·ªëi ho·∫∑c import alias:

```md title="src/content/blog/post.mdoc" ins='file="_footer.mdoc"'
# My Blog Post

{% partial file="./_footer.mdoc" /%}
```

## Syntax highlighting

`@astrojs/markdoc` cung c·∫•p extensions [Shiki](https://shiki.style) v√† [Prism](https://github.com/PrismJS) ƒë·ªÉ highlight c√°c code blocks c·ªßa b·∫°n.

### Shiki

√Åp d·ª•ng extension `shiki()` v√†o c·∫•u h√¨nh Markdoc c·ªßa b·∫°n b·∫±ng thu·ªôc t√≠nh `extends`. B·∫°n c√≥ th·ªÉ t√πy ch·ªçn truy·ªÅn ƒë·ªëi t∆∞·ª£ng c·∫•u h√¨nh shiki:

```js title="markdoc.config.mjs"
import { defineMarkdocConfig } from '@astrojs/markdoc/config';
import shiki from '@astrojs/markdoc/shiki';

export default defineMarkdocConfig({
  extends: [
    shiki({
      // Ch·ªçn t·ª´ themes built-in c·ªßa Shiki (ho·∫∑c th√™m c·ªßa ri√™ng b·∫°n)
      // M·∫∑c ƒë·ªãnh: 'github-dark'
      // https://shiki.style/themes
      theme: 'dracula',
      // B·∫≠t word wrap ƒë·ªÉ ngƒÉn horizontal scrolling
      // M·∫∑c ƒë·ªãnh: false
      wrap: true,
      // Truy·ªÅn ng√¥n ng·ªØ t√πy ch·ªânh
      // L∆∞u √Ω: Shiki c√≥ v√¥ s·ªë langs built-in, bao g·ªìm `.astro`!
      // https://shiki.style/languages
      langs: [],
    }),
  ],
});
```

### Prism

√Åp d·ª•ng extension `prism()` v√†o c·∫•u h√¨nh Markdoc c·ªßa b·∫°n b·∫±ng thu·ªôc t√≠nh `extends`.

```js title="markdoc.config.mjs" ins={5}
import { defineMarkdocConfig } from '@astrojs/markdoc/config';
import prism from '@astrojs/markdoc/prism';

export default defineMarkdocConfig({
  extends: [prism()],
});
```

<ReadMore>ƒê·ªÉ t√¨m hi·ªÉu v·ªÅ c·∫•u h√¨nh Prism stylesheets, [xem h∆∞·ªõng d·∫´n syntax highlighting c·ªßa ch√∫ng t√¥i](/vi/guides/syntax-highlighting/#add-a-prism-stylesheet).</ReadMore>

## Custom Markdoc nodes / elements

B·∫°n c√≥ th·ªÉ mu·ªën render c√°c ph·∫ßn t·ª≠ Markdown ti√™u chu·∫©n, ch·∫≥ng h·∫°n nh∆∞ paragraphs v√† bolded text, nh∆∞ Astro components. ƒê·ªÉ l√†m ƒëi·ªÅu n√†y, b·∫°n c√≥ th·ªÉ c·∫•u h√¨nh [Markdoc node][markdoc-nodes]. N·∫øu m·ªôt node nh·∫≠n ƒë∆∞·ª£c attributes, ch√∫ng s·∫Ω c√≥ s·∫µn nh∆∞ component props.

V√≠ d·ª• n√†y render blockquotes v·ªõi component `Quote.astro` t√πy ch·ªânh:

```js title="markdoc.config.mjs"
import { defineMarkdocConfig, nodes, component } from '@astrojs/markdoc/config';

export default defineMarkdocConfig({
  nodes: {
    blockquote: {
      ...nodes.blockquote, // √Åp d·ª•ng defaults c·ªßa Markdoc cho c√°c t√πy ch·ªçn kh√°c
      render: component('./src/components/Quote.astro'),
    },
  },
});
```

<ReadMore>Xem [t√†i li·ªáu Markdoc nodes](https://markdoc.dev/docs/nodes#built-in-nodes) ƒë·ªÉ t√¨m hi·ªÉu v·ªÅ t·∫•t c·∫£ c√°c built-in nodes v√† attributes.</ReadMore>

### Custom headings

`@astrojs/markdoc` t·ª± ƒë·ªông th√™m anchor links v√†o headings c·ªßa b·∫°n, v√† [t·∫°o danh s√°ch `headings` qua content collections API](/vi/guides/content-collections/#rendering-body-content). ƒê·ªÉ t√πy ch·ªânh th√™m c√°ch headings ƒë∆∞·ª£c render, b·∫°n c√≥ th·ªÉ √°p d·ª•ng Astro component [nh∆∞ Markdoc node][markdoc-nodes].

V√≠ d·ª• n√†y render component `Heading.astro` b·∫±ng thu·ªôc t√≠nh `render`:

```js title="markdoc.config.mjs"
import { defineMarkdocConfig, nodes, component } from '@astrojs/markdoc/config';

export default defineMarkdocConfig({
  nodes: {
    heading: {
      ...nodes.heading, // Gi·ªØ nguy√™n vi·ªác t·∫°o anchor link m·∫∑c ƒë·ªãnh
      render: component('./src/components/Heading.astro'),
    },
  },
});
```

T·∫•t c·∫£ Markdown headings s·∫Ω render component `Heading.astro` v√† truy·ªÅn c√°c `attributes` sau nh∆∞ component props:

* `level: number` M·ª©c heading 1 - 6
* `id: string` M·ªôt `id` ƒë∆∞·ª£c t·∫°o t·ª´ n·ªôi dung vƒÉn b·∫£n c·ªßa heading. ƒêi·ªÅu n√†y t∆∞∆°ng ·ª©ng v·ªõi `slug` ƒë∆∞·ª£c t·∫°o b·ªüi [h√†m `render()` c·ªßa content](/vi/guides/content-collections/#rendering-body-content).

V√≠ d·ª•, heading `### Level 3 heading!` s·∫Ω truy·ªÅn `level: 3` v√† `id: 'level-3-heading'` nh∆∞ component props.

### Custom image components

Component `<Image />` c·ªßa Astro kh√¥ng th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng tr·ª±c ti·∫øp trong Markdoc. Tuy nhi√™n, b·∫°n c√≥ th·ªÉ c·∫•u h√¨nh Astro component ƒë·ªÉ ghi ƒë√® default image node m·ªói khi s·ª≠ d·ª•ng c√∫ ph√°p h√¨nh ·∫£nh `![]()` native, ho·∫∑c nh∆∞ Markdoc tag t√πy ch·ªânh ƒë·ªÉ cho ph√©p b·∫°n ch·ªâ ƒë·ªãnh c√°c thu·ªôc t√≠nh h√¨nh ·∫£nh b·ªï sung.

#### Ghi ƒë√® default image node c·ªßa Markdoc

ƒê·ªÉ ghi ƒë√® default image node, b·∫°n c√≥ th·ªÉ c·∫•u h√¨nh component `.astro` ƒë·ªÉ ƒë∆∞·ª£c render thay cho `<img>` ti√™u chu·∫©n.

<Steps>
1. X√¢y d·ª±ng component `MarkdocImage.astro` t√πy ch·ªânh ƒë·ªÉ truy·ªÅn c√°c thu·ªôc t√≠nh `src` v√† `alt` b·∫Øt bu·ªôc t·ª´ h√¨nh ·∫£nh c·ªßa b·∫°n ƒë·∫øn component `<Image />`:

    ```astro title="src/components/MarkdocImage.astro"
    ---
    import { Image } from "astro:assets";
    interface Props {
      src: ImageMetadata;
      alt: string;
    }
    const { src, alt } = Astro.props;
    ---
    <Image src={src} alt={alt} />
    ```

2. Component `<Image />` y√™u c·∫ßu `width` v√† `height` cho remote images kh√¥ng th·ªÉ ƒë∆∞·ª£c cung c·∫•p b·∫±ng c√∫ ph√°p `![]()`. ƒê·ªÉ tr√°nh l·ªói khi s·ª≠ d·ª•ng remote images, c·∫≠p nh·∫≠t component c·ªßa b·∫°n ƒë·ªÉ render tag HTML `<img>` ti√™u chu·∫©n khi t√¨m th·∫•y `src` URL remote:

    ```astro title="src/components/MarkdocImage.astro" ins="| string" del={9} ins={10-12}
    ---
    import { Image } from "astro:assets";
    interface Props {
      src: ImageMetadata | string;
      alt: string;
    }
    const { src, alt } = Astro.props;
    ---
    <Image src={src} alt={alt} />
    {
      typeof src === 'string' ? <img src={src} alt={alt} /> : <Image src={src} alt={alt} />
    }
    ```

3. C·∫•u h√¨nh Markdoc ƒë·ªÉ ghi ƒë√® default image node v√† render `MarkdocImage.astro`:

    ```js title="markdoc.config.mjs"
    import { defineMarkdocConfig, nodes, component } from '@astrojs/markdoc/config';

    export default defineMarkdocConfig({
      nodes: {
        image: {
          ...nodes.image, // √Åp d·ª•ng defaults c·ªßa Markdoc cho c√°c t√πy ch·ªçn kh√°c
          render: component('./src/components/MarkdocImage.astro'),
        },
      },
    });
    ```

4. C√∫ ph√°p h√¨nh ·∫£nh native trong b·∫•t k·ª≥ t·ªáp `.mdoc` n√†o b√¢y gi·ªù s·∫Ω s·ª≠ d·ª•ng component `<Image />` ƒë·ªÉ t·ªëi ∆∞u h√≥a h√¨nh ·∫£nh c·ª•c b·ªô c·ªßa b·∫°n. Remote images v·∫´n c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng, nh∆∞ng s·∫Ω kh√¥ng ƒë∆∞·ª£c render b·ªüi component `<Image />` c·ªßa Astro.

    ```md title="src/content/blog/post.mdoc"
    
    <!-- ƒê∆∞·ª£c t·ªëi ∆∞u h√≥a b·ªüi <Image /> -->
    ![A picture of a cat](/cat.jpg)

    <!-- <img> kh√¥ng t·ªëi ∆∞u h√≥a -->
    ![A picture of a dog](https://example.com/dog.jpg) 
    ```
</Steps>

#### T·∫°o Markdoc image tag t√πy ch·ªânh

Markdoc `image` tag cho ph√©p b·∫°n ƒë·∫∑t c√°c thu·ªôc t√≠nh b·ªï sung tr√™n h√¨nh ·∫£nh c·ªßa b·∫°n kh√¥ng th·ªÉ v·ªõi c√∫ ph√°p `![]()`. V√≠ d·ª•, image tags t√πy ch·ªânh cho ph√©p b·∫°n s·ª≠ d·ª•ng component `<Image />` c·ªßa Astro cho remote images y√™u c·∫ßu `width` v√† `height`.

C√°c b∆∞·ªõc sau s·∫Ω t·∫°o Markdoc image tag t√πy ch·ªânh ƒë·ªÉ hi·ªÉn th·ªã ph·∫ßn t·ª≠ `<figure>` v·ªõi caption, s·ª≠ d·ª•ng component `<Image />` c·ªßa Astro ƒë·ªÉ t·ªëi ∆∞u h√≥a h√¨nh ·∫£nh.

<Steps>
1. T·∫°o component `MarkdocFigure.astro` ƒë·ªÉ nh·∫≠n c√°c props c·∫ßn thi·∫øt v√† render h√¨nh ·∫£nh v·ªõi caption:

    ```astro title="src/components/MarkdocFigure.astro"
    ---
    // src/components/MarkdocFigure.astro
    import { Image } from "astro:assets";

    interface Props {
      src: ImageMetadata | string;
      alt: string;
      width: number;
      height: number;
      caption: string;
    }

    const { src, alt, width, height, caption } = Astro.props;
    ---
    <figure>
        <Image {src} {alt} {width} {height}  />
        {caption && <figcaption>{caption}</figcaption>}
    </figure>
    ```

2. C·∫•u h√¨nh image tag t√πy ch·ªânh c·ªßa b·∫°n ƒë·ªÉ render Astro component:

    ```ts title="markdoc.config.mjs"
    import { component, defineMarkdocConfig, nodes } from '@astrojs/markdoc/config';

    export default defineMarkdocConfig({
      tags: {
        image: {
          attributes: {
            width: {
              type: String,
            },
            height: {
              type: String,
            },
            caption: {
              type: String,
            },
            ...nodes.image.attributes
          },
          render: component('./src/components/MarkdocFigure.astro'),
        },
      },
    });
    ```

3. S·ª≠ d·ª•ng tag `image` trong c√°c t·ªáp Markdoc ƒë·ªÉ hi·ªÉn th·ªã figure v·ªõi caption, cung c·∫•p t·∫•t c·∫£ c√°c thu·ªôc t√≠nh c·∫ßn thi·∫øt cho component c·ªßa b·∫°n:

    ```md
    {% image src="./astro-logo.png" alt="Astro Logo" width="100" height="100" caption="a caption!" /%}
    ```
</Steps>

## C·∫•u h√¨nh Markdoc n√¢ng cao

T·ªáp `markdoc.config.mjs|ts` ch·∫•p nh·∫≠n [t·∫•t c·∫£ c√°c t√πy ch·ªçn c·∫•u h√¨nh Markdoc](https://markdoc.dev/docs/config), bao g·ªìm [tags](https://markdoc.dev/docs/tags) v√† [functions](https://markdoc.dev/docs/functions).

B·∫°n c√≥ th·ªÉ truy·ªÅn c√°c t√πy ch·ªçn n√†y t·ª´ default export trong t·ªáp `markdoc.config.mjs|ts` c·ªßa b·∫°n:

```js title="markdoc.config.mjs"
import { defineMarkdocConfig } from '@astrojs/markdoc/config';

export default defineMarkdocConfig({
  functions: {
    getCountryEmoji: {
      transform(parameters) {
        const [country] = Object.values(parameters);
        const countryToEmojiMap = {
          japan: 'üáØüáµ',
          spain: 'üá™üá∏',
          france: 'üá´üá∑',
        };
        return countryToEmojiMap[country] ?? 'üè≥';
      },
    },
  },
});
```

B√¢y gi·ªù, b·∫°n c√≥ th·ªÉ g·ªçi function n√†y t·ª´ b·∫•t k·ª≥ content entry Markdoc n√†o:

```md
¬°Hola {% getCountryEmoji("spain") %}!
```

<ReadMore>[Xem t√†i li·ªáu Markdoc](https://markdoc.dev/docs/functions#creating-a-custom-function) ƒë·ªÉ bi·∫øt th√™m v·ªÅ s·ª≠ d·ª•ng bi·∫øn ho·∫∑c functions trong n·ªôi dung c·ªßa b·∫°n.</ReadMore>

### ƒê·∫∑t root HTML element

Markdoc b·ªçc t√†i li·ªáu v·ªõi tag `<article>` theo m·∫∑c ƒë·ªãnh. ƒêi·ªÅu n√†y c√≥ th·ªÉ ƒë∆∞·ª£c thay ƒë·ªïi t·ª´ Markdoc node `document`. ƒêi·ªÅu n√†y ch·∫•p nh·∫≠n t√™n HTML element ho·∫∑c `null` n·∫øu b·∫°n mu·ªën lo·∫°i b·ªè wrapper element:

```js title="markdoc.config.mjs"
import { defineMarkdocConfig, nodes } from '@astrojs/markdoc/config';

export default defineMarkdocConfig({
  nodes: {
    document: {
      ...nodes.document, // √Åp d·ª•ng defaults cho c√°c t√πy ch·ªçn kh√°c
      render: null, // m·∫∑c ƒë·ªãnh 'article'
    },
  },
});
```

## T√πy ch·ªçn c·∫•u h√¨nh t√≠ch h·ª£p

T√≠ch h·ª£p Astro Markdoc x·ª≠ l√Ω vi·ªác c·∫•u h√¨nh c√°c t√πy ch·ªçn v√† kh·∫£ nƒÉng Markdoc kh√¥ng c√≥ s·∫µn th√¥ng qua t·ªáp `markdoc.config.js`.

### `allowHTML`

Cho ph√©p vi·∫øt HTML markup c√πng v·ªõi Markdoc tags v√† nodes.

Theo m·∫∑c ƒë·ªãnh, Markdoc s·∫Ω kh√¥ng nh·∫≠n di·ªán HTML markup nh∆∞ n·ªôi dung semantic.

ƒê·ªÉ ƒë·∫°t ƒë∆∞·ª£c tr·∫£i nghi·ªám gi·ªëng Markdown h∆°n, n∆°i HTML elements c√≥ th·ªÉ ƒë∆∞·ª£c bao g·ªìm c√πng v·ªõi n·ªôi dung c·ªßa b·∫°n, ƒë·∫∑t `allowHTML:true` nh∆∞ t√πy ch·ªçn t√≠ch h·ª£p `markdoc`. ƒêi·ªÅu n√†y s·∫Ω b·∫≠t HTML parsing trong Markdoc markup.

```js ins="allowHTML: true" title="astro.config.mjs" ins={6}
  import { defineConfig } from 'astro/config';
  import markdoc from '@astrojs/markdoc';

  export default defineConfig({
    // ...
    integrations: [markdoc({ allowHTML: true })],
  });
```

:::caution
Khi `allowHTML` ƒë∆∞·ª£c b·∫≠t, HTML markup b√™n trong t√†i li·ªáu Markdoc s·∫Ω ƒë∆∞·ª£c render nh∆∞ HTML elements th·ª±c t·∫ø (bao g·ªìm `<script>`), l√†m cho c√°c vector t·∫•n c√¥ng nh∆∞ XSS tr·ªü n√™n kh·∫£ thi. ƒê·∫£m b·∫£o r·∫±ng b·∫•t k·ª≥ HTML markup n√†o ƒë·ªÅu ƒë·∫øn t·ª´ ngu·ªìn ƒë√°ng tin c·∫≠y.
:::

### `ignoreIndentation`

Theo m·∫∑c ƒë·ªãnh, b·∫•t k·ª≥ n·ªôi dung n√†o ƒë∆∞·ª£c th·ª•t l·ªÅ b·ªën spaces ƒë·ªÅu ƒë∆∞·ª£c coi nh∆∞ code block. Th·∫≠t kh√¥ng may, h√†nh vi n√†y l√†m cho vi·ªác s·ª≠ d·ª•ng c√°c m·ª©c th·ª•t l·ªÅ t√πy √Ω ƒë·ªÉ c·∫£i thi·ªán kh·∫£ nƒÉng ƒë·ªçc c·ªßa t√†i li·ªáu c√≥ c·∫•u tr√∫c ph·ª©c t·∫°p tr·ªü n√™n kh√≥ khƒÉn.

Khi s·ª≠ d·ª•ng nested tags trong Markdoc, c√≥ th·ªÉ h·ªØu √≠ch khi th·ª•t l·ªÅ n·ªôi dung b√™n trong tags ƒë·ªÉ m·ª©c ƒë·ªô s√¢u tr·ªü n√™n r√µ r√†ng. ƒê·ªÉ h·ªó tr·ª£ th·ª•t l·ªÅ t√πy √Ω, ch√∫ng ta ph·∫£i t·∫Øt c√°c code blocks d·ª±a tr√™n th·ª•t l·ªÅ v√† s·ª≠a ƒë·ªïi m·ªôt s·ªë quy t·∫Øc parsing markdown-it kh√°c t√≠nh ƒë·∫øn c√°c code blocks d·ª±a tr√™n th·ª•t l·ªÅ. Nh·ªØng thay ƒë·ªïi n√†y c√≥ th·ªÉ ƒë∆∞·ª£c √°p d·ª•ng b·∫±ng c√°ch b·∫≠t t√πy ch·ªçn ignoreIndentation.

```js "ignoreIndentation: true" title="astro.config.mjs" ins={6}
  import { defineConfig } from 'astro/config';
  import markdoc from '@astrojs/markdoc';

  export default defineConfig({
    // ...
    integrations: [markdoc({ ignoreIndentation: true })],
  });
```

```md
# Ch√†o m·ª´ng ƒë·∫øn Markdoc v·ªõi indented tags üëã

# L∆∞u √Ω: C√≥ th·ªÉ s·ª≠ d·ª•ng spaces ho·∫∑c tabs ƒë·ªÉ th·ª•t l·ªÅ

{% custom-tag %}
{% custom-tag %} ### Tags c√≥ th·ªÉ ƒë∆∞·ª£c th·ª•t l·ªÅ ƒë·ªÉ d·ªÖ ƒë·ªçc h∆°n

    {% another-custom-tag %}
      ƒêi·ªÅu n√†y d·ªÖ theo d√µi h∆°n khi c√≥ nhi·ªÅu nesting
    {% /another-custom-tag %}

{% /custom-tag %}
{% /custom-tag %}
```

## V√≠ d·ª•

* [Template starter Astro Markdoc](https://github.com/withastro/astro/tree/latest/examples/with-markdoc) cho th·∫•y c√°ch s·ª≠ d·ª•ng c√°c t·ªáp Markdoc trong d·ª± √°n Astro c·ªßa b·∫°n.

[astro-integration]: /vi/guides/integrations-guide/

[astro-components]: /vi/basics/astro-components/

[astro-content-collections]: /vi/guides/content-collections/

[markdoc-tags]: https://markdoc.dev/docs/tags

[markdoc-nodes]: https://markdoc.dev/docs/nodes

[markdoc-variables]: https://markdoc.dev/docs/variables