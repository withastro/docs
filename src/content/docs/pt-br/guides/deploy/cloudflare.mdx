---
title: Fa√ßa deploy do seu site Astro com Cloudflare Pages
description: Como fazer o deploy do seu site Astro para web utilizando Cloudflare Pages.
type: deploy
i18nReady: true
---

Voc√™ pode fazer o deploy do seu projeto Astro na [Cloudflare Pages](https://pages.cloudflare.com/), uma plataforma para desenvolvedores frontend colaborarem e fazerem deploy de websites est√°ticos (JAMstack) e SSR.

Este guia inclui:

- [Como fazer o deploy atrav√©s do painel de controle da Cloudflare Pages](#como-fazer-deploy-de-um-site-utilizando-git)
- [Como fazer o deploy utilizando Wrangler, a CLI da Cloudflare](#como-fazer-deploy-de-um-site-utilizando-wrangler)
- [Como fazer o deploy de um site SSR utilizando `@astrojs/cloudflare`](#como-fazer-deploy-de-um-site-ssr)

## Pr√©-requisitos

Para come√ßar, voc√™ vai precisar de:

- Uma conta da Cloudflare. Se voc√™ j√° n√£o tem uma, voc√™ pode criar uma conta gratuita da Cloudflare durante o processo.
- O c√≥digo da sua aplica√ß√£o em um reposit√≥rio do [GitHub](https://github.com/) ou [GitLab](https://about.gitlab.com/).

## Como fazer deploy de um site utilizando Git

1. Configure um novo projeto na Cloudflare Pages.
2. Fa√ßa push do seu c√≥digo para seu reposit√≥rio git (GitHub, GitLab).
3. Inicie a sess√£o no painel de controle da Cloudflare e selecione sua conta em **Account Home** > **Pages**.
4. Selecione **Create a new Project** e a op√ß√£o **Connect Git**.
5. Selecione o projeto git que voc√™ quer fazer deploy e clique **Begin setup**.
6. Use as seguintes configura√ß√µes de build:

    - **Framework preset**: `Astro`
    - **Build command:** `npm run build`
    - **Build output directory:** `dist`

7. Clique no bot√£o **Save and Deploy**.

## Como fazer deploy de um site utilizando Wrangler

1. Instale a [CLI Wrangler](https://developers.cloudflare.com/workers/wrangler/get-started/).
2. Autentique Wrangler com sua conta da Cloudflare utilizando `wrangler login`.
3. Execute seu comando de build.
4. Fa√ßa o deploy utilizando `npx wrangler pages publish dist`.

```bash
# Instale a CLI Wrangler
npm install -g wrangler
# Fa√ßa login com a conta da Cloudflare pela CLI
wrangler login
# Execute seu comando de build
npm run build
# Crie um novo deploy
npx wrangler pages publish dist
```

Depois dos seus assets serem enviados, Wrangler ir√° te dar uma URL de pr√©-visualiza√ß√£o para inspecionar seu site. Quando voc√™ entrar no painel de controle da Cloudflare Pages, voc√™ ver√° o seu novo projeto.

### Habilitando Pr√©-visualiza√ß√£o local com Wrangler

Para a pr√©-visualiza√ß√£o funcionar, voc√™ precisa instalar `wrangler`

```bash
pnpm install wrangler --save-dev
```

Ap√≥s, √© poss√≠vel atualizar o script "preview" para executar `wrangler` ao inv√©s do comando "preview" integrado do Astro:


```json title="package.json"
"preview": "wrangler pages dev ./dist"
```

## Como fazer deploy de um site SSR

Voc√™ pode fazer build de um site Astro SSR para deploy na Cloudflare Pages utilizando o [adaptador `@astrojs/cloudflare`](/pt-br/guides/integrations-guide/cloudflare/).

Siga os passos abaixo para configurar o adaptador. Voc√™ pode ent√£o fazer o deploy utilizando qualquer uma das abordagens documentadas acima.

### Instala√ß√£o R√°pida

Adicione o adaptador para Cloudflare para habilitar SSR no seu projeto Astro com o seguinte comando `astro add`. Ele ir√° instalar o adaptador e fazer as mudan√ßas apropriadas ao seu arquivo `astro.config.mjs` em uma etapa.

```bash
npx astro add cloudflare
```

### Instala√ß√£o Manual

Se voc√™ prefere instalar o adaptador manualmente, complete as duas seguintes etapas:

1. Adicione o adaptador `@astrojs/cloudflare` nas depend√™ncias do seu projeto utilizando seu gerenciador de pacotes de prefer√™ncia. Se voc√™ estiver utilizando npm ou n√£o tem certeza, execute isso no terminal:

    ```bash
    npm install @astrojs/cloudflare
    ```

2. Adicione o seguinte no seu arquivo `astro.config.mjs`:

    ```js title="astro.config.mjs" ins={2, 5-6}
    import { defineConfig } from 'astro/config';
    import cloudflare from '@astrojs/cloudflare';

    export default defineConfig({
      output: 'server',
      adapter: cloudflare()
    });
    ```

### Modos

H√° atualmente dois modos suportados ao utilizar Pages Functions com o adaptador [`@astrojs/cloudflare`](https://github.com/withastro/astro/tree/main/packages/integrations/cloudflare#readme).

1. Modo **Advanced**: Este modo √© utilizado quando voc√™ quer executar sua fun√ß√£o no modo `advanced` que pega o `_worker.js` em `dist`, ou um modo diret√≥rio onde as p√°ginas ir√£o compilar o worker para fora de um diret√≥rio functions na raiz do projeto.

    Se nenhum modo for definido, o padr√£o √© `"advanced"`.

2. Modo **directory**: Este modo √© utilizado quando voc√™ quer executar sua fun√ß√£o no modo `directory`, que significa que o adaptador ir√° compilar a parte do cliente da sua aplica√ß√£o da mesma forma, por√©m ele ir√° mover o script do worker para um diret√≥rio `functions` na raiz do projeto. O adaptador ir√° colocar apenas uma `[[path]].js` naquele diret√≥rio, te permitindo adicionar plugins e middleware de p√°ginas que podem ser verificados em controle de vers√£o.

    ```ts title="astro.config.mjs" "directory"
    export default defineConfig({
      adapter: cloudflare({ mode: "directory" }),
    });
    ```

### Utilizando Pages Functions

[Pages Functions](https://developers.cloudflare.com/pages/platform/functions/) te permitem executar c√≥digo server-side para habilitar funcionalidade din√¢mica sem executar um servidor dedicado.

Para come√ßar, crie um diret√≥rio `/functions` na raiz do seu projeto. Escrevendo seus arquivos Functions nesse diret√≥rio automaticamente gera um Worker com funcionalidade customizada nas rotas pr√©-designadas. Para aprender mais sobre como escrever Functions, veja a [documenta√ß√£o de Pages Functions](https://developers.cloudflare.com/pages/platform/functions/).

üìö Leia mais sobre [SSR no Astro](/pt-br/guides/server-side-rendering/).

## Solu√ß√£o de Problemas

Se voc√™ estiver encontrando erros, verifique novamente se a vers√£o do `node` que voc√™ est√° utilizando localmente (`node -v`) √© igual a vers√£o que voc√™ est√° especificando na vari√°vel de ambiente.

Cloudflare requer [Node v16.13](https://miniflare.dev/get-started/cli#installation), que √© uma vers√£o mais recente que o m√≠nimo por padr√£o do Astro, ent√£o verifique novamente que voc√™ est√° utilizando pelo menos a v16.13.

Hidrata√ß√£o no lado do cliente pode falhar como resultado da op√ß√£o Auto Minify da Cloudflare. Se voc√™ ver `Hydration completed but contains mismatches` no console, certifique-se de desabilitar Auto Minify nas configura√ß√µes da Cloudflare.
