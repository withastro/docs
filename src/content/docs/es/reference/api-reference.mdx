---
title: Contexto de renderizado en Astro
sidebar:
  label: Contexto de renderizado
i18nReady: true
tableOfContents:
  minHeadingLevel: 2
  maxHeadingLevel: 4
---
import Since from '~/components/Since.astro';
import { Tabs, TabItem } from '@astrojs/starlight/components';
import ReadMore from '~/components/ReadMore.astro';

Al renderizar una página, Astro proporciona una API de tiempo de ejecución específico para el renderizado actual. Esto incluye información útil, como la URL de la página actual, así como una API para realizar acciones como redirigir a otra página.

En los componentes `.astro`, este contexto está disponible desde el objeto global `Astro`. Las funciones de endpoints también se invocan con este mismo objeto de contexto como primer argumento, cuyas propiedades reflejan las propiedades globales de Astro.

Algunas propiedades solo están disponibles para rutas renderizadas bajo demanda o pueden tener una funcionalidad limitada en páginas prerenderizadas.

El objeto global `Astro` está disponible para todos los archivos `.astro`. Utiliza el objeto `context` en [funciones de endpoint](/es/guides/endpoints/) para servir endpoints de servidor estáticos o en vivo y en [middleware](/es/guides/middleware/) para inyectar comportamiento cuando una página o un endpoint está a punto de renderizarse.
## The context object

Las siguientes propiedades están disponibles en el global `Astro` (por ejemplo, `Astro.props`, `Astro.redirect()`) y también están disponibles en el objeto de contexto (por ejemplo, `context.props`, `context.redirect()`) pasado a las funciones de endpoints y al middleware.

### `props`

`props` es un objeto que contiene cualquier valor que se haya pasado como [atributos de componente](/es/basics/astro-components/#props-de-componentes).

```astro {3}
---
// src/components/Heading.astro
const { title, date } = Astro.props;
---
<div>
  <h1>{title}</h1>
  <p>{date}</p>
</div>
```

```astro "title=" "date="
---
// src/pages/index.astro
import Heading from '../components/Heading.astro';
---
<Heading title="Mi primer post" date="09 Ago 2022" />
```

<ReadMore>Más información sobre cómo [los diseños Markdown y MDX](/es/guides/markdown-content/#frontmatter-layout-property) gestionan los props.</ReadMore>


El objeto `props` también contiene cualquier `props` pasado desde `getStaticPaths()` al renderizar rutas estáticas.

<Tabs>
  <TabItem label="Astro.props">
    ```astro title="src/pages/posts/[id].astro" "props:" {11}
    ---
    export function getStaticPaths() {
      return [
        { params: { id: '1' }, props: { author: 'Blu' } },
        { params: { id: '2' }, props: { author: 'Erika' } },
        { params: { id: '3' }, props: { author: 'Matthew' } }
      ];
    }

    const { id } = Astro.params;
    const { author } = Astro.props;
    ---
    ```
  </TabItem>
  <TabItem label="context.props">
    ```ts title="src/pages/posts/[id].json.ts" "props:" {11-15}
    import type { APIContext } from 'astro';

    export function getStaticPaths() {
      return [
        { params: { id: '1' }, props: { author: 'Blu' } },
        { params: { id: '2' }, props: { author: 'Erika' } },
        { params: { id: '3' }, props: { author: 'Matthew' } }
      ];
    }

    export function GET({ props }: APIContext) {
      return new Response(
        JSON.stringify({ author: props.author }),
      );
    }
    ```
  </TabItem>
</Tabs>

Ver también: [Transmisión de datos con `props`](/es/reference/routing-reference/#transmisión-de-datos-con-props)

### `params`

`params` es un objeto que contiene los valores de los segmentos de ruta dinámicos que coinciden con una solicitud. Sus claves deben coincidir con los [parámetros](/es/guides/routing/#rutas-dinámicas) de la ruta del archivo de la página o del punto final.

En compilaciones estáticas, esto será el `params` devuelto por `getStaticPaths()` utilizado para el prerenderizado [rutas dinámicas](/es/guides/routing/#rutas-dinámicas):

<Tabs>
  <TabItem label="Astro.params">
    ```astro title="src/pages/posts/[id].astro" {9} "params:"
    ---
    export function getStaticPaths() {
      return [
        { params: { id: '1' } },
        { params: { id: '2' } },
        { params: { id: '3' } }
      ];
    }
    const { id } = Astro.params;
    ---
    <h1>{id}</h1>
    ```
  </TabItem>
  <TabItem label="context.params">
    ```ts title="src/pages/posts/[id].json.ts" "params:" {11-15}
    import type { APIContext } from 'astro';

    export function getStaticPaths() {
      return [
        { params: { id: '1' } },
        { params: { id: '2' } },
        { params: { id: '3' } }
      ];
    }

    export function GET({ params }: APIContext) {
      return new Response(
        JSON.stringify({ id: params.id }),
      );
    }
    ```
  </TabItem>
</Tabs>


Cuando las rutas se representan bajo demanda, `params` puede ser cualquier valor que coincida con los segmentos de ruta en el patrón de ruta dinámica.

```astro title="src/pages/posts/[id].astro" "Astro.params"
---
import { getPost } from '../api';

const post = await getPost(Astro.params.id);

// No se han encontrado publicaciones con este ID
if (!post) {
  return Astro.redirect("/404")
}
---
<html>
  <h1>{post.name}</h1>
</html>
```

Ver también: [`params`](/es/reference/routing-reference/#params)

### `url`

<p>

**Tipo:** `URL`<br />
<Since v="1.0.0" />
</p>

`url` es un objeto [URL](https://developer.mozilla.org/es/docs/Web/API/URL) construido a partir del valor actual de `request.url`. Es útil para interactuar con propiedades individuales de la URL de la solicitud, como el nombre de ruta y el origen.

`Astro.url` es equivalente a hacer `new URL(Astro.request.url)`.

`url` será una URL `localhost` en modo de desarrollo. Al crear un sitio, las rutas prerenderizadas recibirán una URL basada en las opciones [`site`](/es/reference/configuration-reference/#site) y [`base`](/es/reference/configuration-reference/#base). Si `site` no está configurado, las páginas prerenderizadas también recibirán una URL `localhost` durante la creación.

```astro title="src/pages/index.astro" "Astro.url"
<h1>La URL actual es: {Astro.url} </h1>
<h1>El nombre de ruta de la URL actual es: {Astro.url.pathname}</h1>
<h1>El origen de la URL actual es: {Astro.url.origin}</h1>
```

También puedes usar `url` para crear nuevas URL pasándola como argumento a [`new URL()`](https://developer.mozilla.org/es/docs/Web/API/URL/URL).

```astro title="src/pages/index.astro" "Astro.url"
---
// Ejemplo: Construir una URL canónica utilizando tu dominio de producción
const canonicalURL = new URL(Astro.url.pathname, Astro.site);
// Ejemplo: Construir una URL para metaetiquetas SEO utilizando tu dominio actual.
const socialImageURL = new URL('/images/preview.png', Astro.url);
---
<link rel="canonical" href={canonicalURL} />
<meta property="og:image" content={socialImageURL} />
```

### `site`

<p>

**Tipo:** `URL | undefined`
</p>

`site` devuelve una `URL` creada a partir de `site` en tu configuración de Astro. Devuelve `undefined` si no has establecido un valor para [`site`](/es/reference/configuration-reference/#site) en tu configuración de Astro.

```astro title="src/pages/index.astro" "Astro.site"
<link
  rel="alternate"
  type="application/rss+xml"
  title="El título de tu sitio"
  href={new URL("rss.xml", Astro.site)}
/>
```

### `clientAddress`

<p>

**Tipo:** `string`<br />
<Since v="1.0.0" />
</p>

`clientAddress` especifica la [dirección IP](https://es.wikipedia.org/wiki/Direcci%C3%B3n_IP) de la solicitud. Esta propiedad solo está disponible para rutas renderizadas bajo demanda y no se puede utilizar en páginas prerenderizadas.

<Tabs>
  <TabItem label="Astro.clientAddress">
    ```astro title="src/pages/ip-address.astro" "Astro.clientAddress"
    ---
    export const prerender = false; // Innecesatio en modo 'server'
    ---

    <div>Your IP address is: <span class="address">{Astro.clientAddress}</span></div>
    ```
  </TabItem>
  <TabItem label="context.clientAddress">
    ```ts title="src/pages/ip-address.ts" "clientAddress"
    export const prerender = false; // Innecesatio en modo 'server'
    import type { APIContext } from 'astro';

    export function GET({ clientAddress }: APIContext) {
      return new Response(`Your IP address is: ${clientAddress}`);
    }
    ```
  </TabItem>
</Tabs>


### `isPrerendered`

<p>

**Tipo**: `boolean`<br />
<Since v="5.0.0" />
</p>

Un valor booleano que indica si la página actual está prerenderizada o no.

Puedes usar esta propiedad para ejecutar lógica condicional en el middleware, por ejemplo, para evitar acceder a los encabezados en páginas prerenderizadas.

### `generator`

<p>

**Tipo:** `string`<br />
<Since v="1.0.0" />
</p>

`generator` proporciona la versión actual de Astro que está ejecutando tu proyecto. Es una forma cómoda de añadir una etiqueta [`<meta name="generator">`](https://html.spec.whatwg.org/multipage/semantics.html#meta-generator) con tu versión actual de Astro. Sigue el formato `"Astro v5.x.x"`.

<Tabs>
  <TabItem label="Astro.generator">
    ```astro title="src/pages/site-info.astro" "Astro.generator"
    <html>
      <head>
        <meta name="generator" content={Astro.generator} />
      </head>
      <body>
        <footer>
          <p>Construido con <a href="https://astro.build">{Astro.generator}</a></p>
        </footer>
      </body>
    </html>
    ```
  </TabItem>
  <TabItem label="context.generator">
    ```ts title="src/pages/site-info.json.ts" "generator"
    import type { APIContext } from 'astro';

    export function GET({ generator, site }: APIContext) {
      const body = JSON.stringify({ generator, site });
      return new Response(body);
    }
    ```
  </TabItem>
</Tabs>

### `request`

<p>

**Tipo:** `Request`
</p>

`request` es un objeto [Request](https://developer.mozilla.org/es/docs/Web/API/Request) estándar. Se puede utilizar para obtener la `url`, los `headers`, el `method` e incluso el cuerpo de la solicitud. 

<Tabs>
  <TabItem label="Astro.request">
    ```astro wrap title="src/pages/index.astro" "Astro.request"
    <p>Se ha recibido una solicitud {Astro.request.method} a "{Astro.request.url}".</p>
    <p>Encabezados de solicitud recibidos:</p>
    <p><code>{JSON.stringify(Object.fromEntries(Astro.request.headers))}</code></p>
    ```
  </TabItem>
  <TabItem label="context.request">
    ```ts "request"
    import type { APIContext } from 'astro';

    export function GET({ request }: APIContext) {
      return new Response(`Hello ${request.url}`);
    }
    ```
  </TabItem>
</Tabs>

:::note
En las páginas prerenderizadas, `request.url` no contiene parámetros de búsqueda, como `?type=new`, ya que no es posible determinarlos con antelación durante las compilaciones estáticas. Sin embargo, `request.url` sí contiene parámetros de búsqueda para las páginas renderizadas bajo demanda, ya que pueden determinarse a partir de una solicitud del servidor.
:::

### `response`

<p>

**Tipo:** `ResponseInit & { readonly headers: Headers }`
</p>

`response` es un objeto `ResponseInit` estándar. Tiene la siguiente estructura.

 - `status`: El código de estado numérico de la respuesta, por ejemplo, `200`.
 - `statusText`: El mensaje de estado asociado con el código de estado, por ejemplo, `'OK'`.
 - `headers`: Una instancia [`Headers`](https://developer.mozilla.org/es/docs/Web/API/Headers) que puedes utilizar para establecer los encabezados HTTP de la respuesta.

`Astro.response` se utiliza para establecer el `status`, `statusText` y `headers` de la respuesta de una página.

```astro "Astro.response"
---
if (condition) {
  Astro.response.status = 404;
  Astro.response.statusText = 'No encontrado';
}
---
```

O para establecer un encabezado:

```astro "Astro.response"
---
Astro.response.headers.set('Set-Cookie', 'a=b; Path=/;');
---
```

### `redirect()`

<p>

**Tipo:** `(path: string, status?: number) => Response`
<Since v="1.5.0" />
</p>

`redirect()` devuelve un objeto [Response](https://developer.mozilla.org/es/docs/Web/API/Response) que permite redirigir a otra página y, opcionalmente, proporcionar un [código de estado de respuesta HTTP](https://developer.mozilla.org/es/docs/Web/HTTP/Status#redirection_messages) como segundo parámetro.

Una página (y no un componente hijo) debe `devolver` el resultado de `Astro.redirect()` para que se produzca la redirección.

Para rutas generadas estáticamente, esto producirá una redirección del cliente utilizando una etiqueta [`<meta http-equiv="refresh">`](https://developer.mozilla.org/es/docs/Web/HTML/Element/meta#http-equiv) y no admite códigos de estado.

Para las rutas renderizadas bajo demanda, se admite la configuración de un código de estado personalizado al redirigir. Si no se especifica, las redirecciones se servirán con un código de estado `302`.

El siguiente ejemplo redirige a un usuario a una página de inicio de sesión:

<Tabs>
  <TabItem label="Astro.redirect()">
    ```astro title="src/pages/account.astro" {8} "Astro.redirect"
    ---
    import { isLoggedIn } from '../utils';

    const cookie = Astro.request.headers.get('cookie');

    // Si el usuario no ha iniciado sesión, rediríjalo a la página de inicio de sesión.
    if (!isLoggedIn(cookie)) {
      return Astro.redirect('/login');
    }
    ---
    
    <p>Información del usuario</p>
    ```
  </TabItem>
  <TabItem label="context.redirect()">
    ```ts "redirect"
    import type { APIContext } from 'astro';

    export function GET({ redirect, request }: APIContext) {
      const cookie = request.headers.get('cookie');
      if (!isLoggedIn(cookie)) {
        return redirect('/login', 302);
      } else {
        // devuelve información del usuario
      }
    }
    ```
  </TabItem>
</Tabs>


### `rewrite()`

<p>

**Tipo:** `(rewritePayload: string | URL | Request) => Promise<Response>`<br />
<Since v="4.13.0" />
</p>

`rewrite()` te permite servir contenido desde una URL o ruta diferente sin redirigir el navegador a una nueva página.

El método acepta una cadena de texto, una `URL` o una `Request` para la ubicación de la ruta.

Usa una cadena de texto para proporcionar una ruta explícita:

<Tabs syncKey="rewrite">
  <TabItem label="Astro.rewrite()">
    ```astro title="src/pages/index.astro" "Astro.rewrite"
    ---
    return Astro.rewrite("/login")
    ---
    ```
  </TabItem>
  <TabItem label="context.rewrite()">
    ```ts "rewrite"
    import type { APIContext } from 'astro';

    export function GET({ rewrite }: APIContext) {
      return rewrite('/login');
    }
    ```
  </TabItem>
</Tabs>

Usa un tipo `URL` cuando necesites construir la ruta URL para la reescritura. El siguiente ejemplo muestra la ruta principal de una página creando una nueva URL a partir de la ruta relativa  `"../"`:

<Tabs syncKey="rewrite">
  <TabItem label="Astro.rewrite()">
    ```astro title="src/pages/blog/index.astro"
    ---
    return Astro.rewrite(new URL("../", Astro.url))
    ---
    ```
  </TabItem>
  <TabItem label="context.rewrite()">
    ```ts
    import type { APIContext } from 'astro';

    export function GET({ rewrite }: APIContext) {
      return rewrite(new URL("../", Astro.url));
    }
    ```
  </TabItem>
</Tabs>

Usa un tipo `Request` para tener control total sobre la `Request` que se envía al servidor para la nueva ruta. El siguiente ejemplo envía una solicitud para renderizar la página principal y también proporciona encabezados:

<Tabs syncKey="rewrite">
  <TabItem label="Astro.rewrite()">
    ```astro title="src/pages/blog/index.astro"
    ---
    return Astro.rewrite(new Request(new URL("../", Astro.url), {
      headers: {
        "x-custom-header": JSON.stringify(Astro.locals.someValue)
      }
    }))
    ---
    ```
  </TabItem>
  <TabItem label="context.rewrite()">
    ```ts
    import type { APIContext } from 'astro';

    export function GET({ rewrite }: APIContext) {
      return rewrite(new Request(new URL("../", Astro.url), {
        headers: {
          "x-custom-header": JSON.stringify(Astro.locals.someValue)
        }
      }));
    }
    ```
  </TabItem>
</Tabs>

### `originPathname`

<p>

**Tipo:** `string`<br />
<Since v="5.0.0" />
</p>

`originPathname` define la ruta original de la solicitud, antes de que se aplicaran las reescrituras.

<Tabs>
  <TabItem label="Astro.originPathname">
  	```astro title="src/pages/404.astro"
    <p>La ruta original es {Astro.originPathname} </p>
    <p>La ruta reescrita es {Astro.url.pathname} </p>
    ```
  </TabItem>
  <TabItem label="context.originPathname">
    ```ts title="src/middleware.ts"
    import { defineMiddleware } from 'astro:middleware';

    export const onRequest = defineMiddleware(async (context, next) => {
      // Registra la ruta original antes de cualquier reescritura.
      recordPageVisit(context.originPathname);
      return next();
    });
  ```
  </TabItem>
</Tabs>

### `locals`

<p>

<Since v="2.4.0" />
</p>

`locals` es un objeto que se utiliza para almacenar y acceder a información arbitraria durante el ciclo de vida de una solicitud. `Astro.locals` es un objeto que contiene cualquier valor del objeto `context.locals` establecido por el middleware. Úsalo para acceder a los datos devueltos por el middleware en tus archivos `.astro`.

Las funciones del middleware pueden leer y escribir los valores de `context.locals`:

```ts title="src/middleware.ts" "locals"
import type { MiddlewareHandler } from 'astro';

export const onRequest: MiddlewareHandler = ({ locals }, next) => {
  if (!locals.title) {
    locals.title = "Título por defecto";
  }
  return next();
}
```

Los componentes de Astro y los endpoints de la API pueden leer valores de `locals` cuando se renderizan:

<Tabs>
  <TabItem label="Astro.locals">
    ```astro title="src/pages/Orders.astro" "Astro.locals"
    ---
    const title = Astro.locals.title;
    ---
    <h1>{title}</h1>
    ```
  </TabItem>
  <TabItem label="context.locals">
    ```ts title="src/pages/hello.ts" "locals"
    import type { APIContext } from 'astro';

    export function GET({ locals }: APIContext) {
      return new Response(locals.title); // "Título por defecto"
    }
    ```
  </TabItem>
</Tabs>

### `preferredLocale`

<p>

**Tipo:** `string | undefined`<br />
<Since v="3.5.0" />
</p>

`preferredLocale` es un valor computado para encontrar la mejor coincidencia entre las preferencias de idioma del navegador de tu visitante y las configuraciones regionales compatibles con tu sitio.

Se calcula comprobando las configuraciones regionales configuradas en su lista [`i18n.locales`](/es/reference/configuration-reference/#i18nlocales) y las configuraciones regionales compatibles con el navegador del usuario a través del encabezado `Accept-Language`. Este valor es `indefinido` si no existe ninguna coincidencia.

Esta propiedad solo está disponible para rutas renderizadas bajo demanda y no se puede utilizar en páginas estáticas prerenderizadas.

### `preferredLocaleList`

<p>

**Tipo:** `string[] | undefined`<br />
<Since v="3.5.0" />
</p>

`preferredLocaleList` representa la lista de todas las configuraciones regionales solicitadas por el navegador y compatibles con tu sitio web. Esto genera una lista de todos los idiomas compatibles entre tu sitio y tu visitante.

Si ninguno de los idiomas solicitados por el navegador se encuentra en tu lista de configuraciones regionales, el valor será `[]`. Esto ocurre cuando no admites ninguna de las configuraciones regionales preferidas de tus visitantes.

Si el navegador no especifica ningún idioma preferido, este valor será [`i18n.locales`](/es/reference/configuration-reference/#i18nlocales): todas las configuraciones regionales compatibles se considerarán igualmente preferidas por un visitante sin preferencias. 

Esta propiedad solo está disponible para rutas renderizadas bajo demanda y no se puede utilizar en páginas estáticas prerenderizadas.

### `currentLocale`

<p>

**Tipo:** `string | undefined`<br />
<Since v="3.5.6" />
</p>

La configuración regional computada a partir de la URL actual, utilizando la sintaxis especificada en tu configuración `locales`. Si la URL no contiene el prefijo `/[locale]/`, el valor predeterminado será [`i18n.defaultLocale`](/es/reference/configuration-reference/#i18ndefaultlocale).

### `getActionResult()`

<p>
**Tipo:** `(action: TAction) => ActionReturnType<TAction> | undefined`<br />
<Since v="4.15.0" />
</p>

`getActionResult()` es una función que devuelve el resultado de un envío de una [Acción](/es/guides/actions/). Acepta una función de acción como argumento (por ejemplo, `actions.logout`) y devuelve un objeto `data` o `error` cuando se recibe un envío. De lo contrario, devolverá `undefined`.

```astro title="src/pages/index.astro" "Astro.getActionResult"
---
import { actions } from 'astro:actions';

const result = Astro.getActionResult(actions.logout);
---

<form action={actions.logout}>
  <button type="submit">Cerrar sesión</button>
</form>
{result?.error && <p>No se pudo cerrar la sesión. Por favor, inténtalo de nuevo.</p>}
```

### `callAction()`

<p>
<Since v="4.15.0" />
</p>

`callAction()` es una función que se utiliza para llamar a un controlador de acción directamente desde tu componente de Astro. Esta función acepta una función de acción como primer argumento (por ejemplo, `actions.logout`) y cualquier entrada que reciba la acción como segundo argumento. Devuelve el resultado de la acción como una promesa.

```astro title="src/pages/index.astro" "Astro.callAction"
---
import { actions } from 'astro:actions';

const { data, error } = await Astro.callAction(actions.logout, { userId: '123' });
---
```

### `routePattern`

<p>

**Tipo**: `string`<br />
<Since v="5.0.0" />
</p>

El patrón de ruta responsable de generar la página o ruta actual. En el enrutamiento basado en archivos, esto se asemeja a la ruta de archivo de tu proyecto utilizada para crear la ruta. Cuando las integraciones crean rutas para tu proyecto, `context.routePattern` es idéntico al valor de `injectRoute.pattern`.

El valor comenzará con una barra inclinada y se parecerá a la ruta de un componente de página relativa a tu carpeta `src/pages/` sin extensión de archivo.

Por ejemplo, el archivo `src/pages/en/blog/[slug].astro` devolverá `/en/blog/[slug]` para `routePattern`. Cada página en tu sitio generada por ese archivo (por ejemplo, `/en/blog/post-1/`, `/en/blog/post-2/`, etc.) comparte el mismo valor para `routePattern`. En el caso de las rutas `index.*`, el patrón de ruta no incluirá la palabra "index." Por ejemplo, `src/pages/index.astro` devolverá `/`.

Puedes usar esta propiedad para entender qué ruta está renderizando tu componente. Esto te permite dirigir o analizar junto con las URL de página generadas similarmente. Por ejemplo, puedes utilizarlo para renderizar condicionalmente cierta información o recopilar métricas sobre las rutas más lentas.

### `cookies`

<p>

**Tipo:** `AstroCookies`<br />
<Since v="1.4.0" />
</p>

`cookies` contiene utilidades para leer y manipular cookies para [rutas renderizadas bajo demanda](/es/guides/on-demand-rendering/).

#### Utilidades de cookies

##### `cookies.get()`

<p>

**Tipo:** <code>(key: string, options?: <a href="#astrocookiegetoptions">AstroCookieGetOptions</a>) => <a href="#astrocookie-type">AstroCookie</a> | undefined</code>
</p>

Obtiene el cookie como un objeto [`AstroCookie`](#tipo-astrocookie), que contiene el valor `value` y funciones de utilidad para convertir el cookie a tipos no cadena.

##### `cookies.has()`

<p>

**Tipo:** <code>(key: string, options?: <a href="#astrocookiegetoptions">AstroCookieGetOptions</a>) => boolean</code>
</p>

Si esta cookie existe o no. Si la cookie se ha establecido mediante `Astro.cookies.set()`, devolverá verdadero; de lo contrario, comprobará las cookies en `Astro.request`.

##### `cookies.set()`

<p>

**Tipo:** <code>(key: string, value: string | object, options?: <a href="#astrocookiesetoptions">AstroCookieSetOptions</a>) => void</code>
</p>

Establece la cookie `key` con el valor dado. Esto intentará convertir el valor de la cookie en una cadena de texto. Las opciones proporcionan formas de establecer [características de las cookies](https://www.npmjs.com/package/cookie#options-1), como `maxAge` o `httpOnly`.

##### `cookies.delete()`

<p>

**Tipo:** `(key: string, options?: AstroCookieDeleteOptions) => void`
</p>

Invalida una cookie estableciendo la fecha de caducidad en el pasado (0 en tiempo Unix).

Una vez que una cookie se "elimina" (caduca), `Astro.cookies.has()` devolverá `false` y `Astro.cookies.get()` devolverá una [`AstroCookie`](#tipo-astrocookie) con un `valor` de `indefinido`. Las opciones disponibles al eliminar una cookie son: `domain`, `path`, `httpOnly`, `sameSite` y `secure`.

##### `cookies.merge()`

<p>

**Tipo:** `(cookies: AstroCookies) => void`
</p>

Fusiona una nueva instancia de `AstroCookies` con la instancia actual. Cualquier nueva cookie se añadirá a la instancia actual y cualquier cookie con el mismo nombre sobrescribirá los valores existentes.

##### `cookies.headers()`

<p>

**Tipo:** `() => Iterator<string>`
</p>

Obtiene los valores de encabezado para `Set-Cookie` que se enviarán con la respuesta.

#### Tipo `AstroCookie`

El tipo devuelto al obtener una cookie mediante `Astro.cookies.get()`. Tiene las siguientes propiedades:

##### `value`

<p>

**Tipo:** `string`
</p>

El valor de cadena de texto sin formato de la cookie.

##### `json`

<p>

**Tipo:** `() => Record<string, any>`
</p>

Parsea el valor de la cookie mediante `JSON.parse()` y devuelve un objeto. Lanza una excepción si el valor de la cookie no es JSON válido.

##### `number`

<p>

**Tipo:** `() => number`
</p>

Parsea el valor de la cookie como un número. Devuelve NaN si no es un número válido.

##### `boolean`

<p>

**Tipo:** `() => boolean`
</p>

Convierte el valor de la cookie a un booleano.

#### `AstroCookieGetOptions`

<p><Since v="4.1.0"/></p>

La interfaz `AstroCookieGetOption` te permite especificar opciones al obtener una cookie.

##### `decode`

<p>
**Tipo:** `(value: string) => string`
</p>

Permite personalizar cómo se deserializa una cookie en un valor.

#### `AstroCookieSetOptions`

<p><Since v="4.1.0"/></p>

`AstroCookieSetOptions` es un objeto que se puede pasar a `Astro.cookies.set()` al configurar una cookie para personalizar cómo se serializa la cookie.

##### `domain`

<p>

**Tipo:** `string`
</p>

Especifica el dominio. Si no se establece ningún dominio, la mayoría de los clientes interpretarán que se aplica al dominio actual.

##### `expires`

<p>

**Tipo:** `Date`
</p>

Especifica la fecha en la que caducará la cookie.

##### `httpOnly`

<p>

**Tipo:** `boolean`
</p>

Si es verdadero, la cookie no será accesible del lado del cliente.

##### `maxAge`

<p>

**Tipo:** `number`
</p>

Especifica un número, en segundos, para el cual la cookie es válida.

##### `path`

<p>

**Tipo:** `string`
</p>

Especifica un sub directorio del dominio en el que se aplica la cookie.

##### `sameSite`

<p>

**Tipo:** `boolean | 'lax' | 'none' | 'strict'`
</p>

Especifica el valor del encabezado [SameSite](https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-rfc6265bis-09#section-5.4.7) de la cookie.

##### `secure`

<p>

**Tipo:** `boolean`
</p>

Si es verdadero, la cookie solo se establece en sitios https.

##### `encode`

<p>

**Tipo:** `(value: string) => string`
</p>

Permite personalizar cómo se serializa la cookie.

### `session`

<p>

**Tipo:** `AstroSession`

<Since v="5.7.0" />

</p>

`session` es un objeto que permite almacenar datos entre solicitudes para [rutas renderizadas bajo demanda](/es/guides/on-demand-rendering/). Está asociado a una cookie que solo contiene el ID de sesión: los datos en sí no se almacenan en la cookie.

La sesión se crea cuando se utiliza por primera vez y la cookie de sesión se establece automáticamente. El objeto `session` es `undefined` si no se ha configurado ningún almacenamiento de sesión o si la ruta actual está prerenderizada, y registrará un error si intentas utilizarlo.

Consulta [la guía de sesiones](/es/guides/sessions/) para obtener más información sobre cómo utilizar las sesiones en tu proyecto de Astro.

#### `get()`

<p>

**Tipo**: `(key: string) => Promise<any>`

</p>

Devuelve el valor de la clave dada en la sesión. Si la clave no existe, devuelve `undefined`.

<Tabs>
  <TabItem label="Astro.session">
    ```astro title="src/components/Cart.astro" "Astro.session?.get('cart')"
    ---
    const cart = await Astro.session?.get('cart');
    ---
    <button>🛒 {cart?.length}</button>
    ```
  </TabItem>
  <TabItem label="context.session">
    ```ts title="src/pages/api/cart.ts" "session.get('cart')"
    import type { APIContext } from 'astro';

    export async function GET({ session }: APIContext) {
      const cart = await session.get('cart');
      return Response.json({ cart });
    }
    ```
  </TabItem>
</Tabs>

#### `set()`

<p>

**Tipo**: `(key: string, value: any, options?: { ttl: number }) => void`

</p>

Establece el valor de la clave dada en la sesión. El valor puede ser cualquier tipo serializable. Este método es síncrono y el valor está disponible inmediatamente para su recuperación, pero no se guarda en el backend hasta el final de la solicitud.

<Tabs>
  <TabItem label="Astro.session">
    ```astro title="src/pages/products/[slug].astro" "Astro.session?.set('lastViewedProduct', slug)"
    ---
    const { slug } = Astro.params;
    Astro.session?.set('lastViewedProduct', slug);
    ---
    ```
  </TabItem>
  <TabItem label="context.session">
    ```ts title="src/pages/api/add-to-cart.ts" "session.set('cart', cart)"
    import type { APIContext } from 'astro';

    export async function POST({ session, request }: APIContext) {
      const cart = await session.get('cart');
      const newItem = await request.json();
      cart.push(newItem);
      // Guarda el carrito actualizado en la sesión
      session.set('cart', cart);
      return Response.json({ cart });
    }
    ```

  </TabItem>
</Tabs>

#### `regenerate()`

<p>

**Tipo**: `() => void`

</p>

Regenera el ID de sesión. Llama a esto cuando un usuario inicia sesión o aumenta sus privilegios para evitar ataques de fijación de sesión.

<Tabs>
  <TabItem label="Astro.session">
    ```astro title="src/pages/welcome.astro" "Astro.session?.regenerate()"
    ---
    Astro.session?.regenerate();
    ---
    ```
  </TabItem>
  <TabItem label="context.session">
    ```ts title="src/pages/api/login.ts" "session.regenerate()"
    import type { APIContext } from 'astro';

    export async function POST({ session }: APIContext) {
      // Autenticar al usuario...
      doLogin();
      // Regenera el ID de sesión para evitar ataques de fijación de sesión
      session.regenerate();
      return Response.json({ success: true });
    }
    ```

  </TabItem>
</Tabs>

#### `destroy()`

<p>

**Tipo**: `() => void`

</p>

Destruye la sesión, eliminando la cookie y el objeto del backend. Llama a esto cuando un usuario cierra sesión o su sesión se invalida de alguna otra manera.

<Tabs>
  <TabItem label="Astro.session">
    ```astro title="src/pages/logout.astro" "Astro.session?.destroy()"
    ---
    Astro.session?.destroy();
    return Astro.redirect('/login');
    ---
    ```
  </TabItem>
  <TabItem label="context.session">
    ```ts title="src/pages/api/logout.ts" "session.destroy()"
    import type { APIContext } from 'astro';

    export async function POST({ session }: APIContext) {
      session.destroy();
      return Response.json({ success: true });
    }
    ```

  </TabItem>
</Tabs>

#### `load()`

<p>

**Tipo**: `(id: string) => Promise<void>`
</p>

Carga una sesión por ID. En condiciones normales, una sesión se carga automáticamente desde la cookie de solicitud. Usa este método para cargar una sesión desde un ID diferente. Esto es útil si gestionas tú mismo el ID de sesión o si quieres hacer un seguimiento de una sesión sin usar cookies.

<Tabs>
  <TabItem label="Astro.session">
    ```astro title="src/pages/cart.astro" "Astro.session?.load('session-id')"
    ---
    // Carga la sesión desde un encabezado en lugar desde las cookies
    const sessionId = Astro.request.headers.get('x-session-id');
    await Astro.session?.load(sessionId);
    const cart = await Astro.session?.get('cart');
    ---
    <h1>Your cart</h1>
    <ul>
      {cart?.map((item) => (
        <li>{item.name}</li>
      ))}
    </ul>
    ```
  </TabItem>
  <TabItem label="context.session">
    ```ts title="src/pages/api/load-session.ts" "session.load('session-id')"
    import type { APIRoute } from 'astro';

    export const GET: APIRoute = async ({ session, request }) => {
      // Carga la sesión desde un encabezado en lugar desde las cookies
      const sessionId = request.headers.get('x-session-id');
      await session.load(sessionId);
      const cart = await session.get('cart');
      return Response.json({ cart });
    };
    ```

  </TabItem>

</Tabs>


### Propiedades de objeto obsoletas

#### `Astro.glob()`

:::caution[Deprecated in v5.0]
Usa [Vite's `import.meta.glob`](https://vite.dev/guide/features.html#glob-import) para consultar archivos del proyecto.

`Astro.glob('../pages/post/*.md')` puede reemplazarse con:

`Object.values(import.meta.glob('../pages/post/*.md', { eager: true }));`

Consulta la [guía de importaciones](/es/guides/imports/#importmetaglob) para obtener más información y uso.
:::

`Astro.glob()` es una forma de cargar muchos archivos locales en tu configuración de tu sitio estático.

```astro
---
// src/components/my-component.astro
const posts = await Astro.glob('../pages/post/*.md'); // devuelve una lista de publicaciones que viven en ./src/pages/post/*.md
---

<div>
{posts.slice(0, 3).map((post) => (
  <article>
    <h2>{post.frontmatter.title}</h2>
    <p>{post.frontmatter.description}</p>
    <a href={post.url}>Leer más</a>
  </article>
))}
</div>
```

`.glob()` solo admite un parámetro: una URL global relativa de los archivos locales que deseas importar. Es asíncrono y devuelve una matriz con las exportaciones de los archivos coincidentes.

`.glob()` no puede aceptar variables ni cadenas que las interpalen, ya que no se pueden analizar de forma estática. Consulta [la guía de importaciones](/es/guides/imports/#supported-values) para obtener una solución alternativa). Esto se debe a que `Astro.glob()` es un envoltorio de [`import.meta.glob()`](https://vite.dev/guide/features.html#glob-import) de Vite.

:::note
También puedes usar `import.meta.glob()` en tu proyecto de Astro. Puedes hacerlo cuando:
- Necesitas esta característica en un archivo que no es `.astro`, como una ruta de API. `Astro.glob()` solo está disponible en archivos `.astro`, mientras que `import.meta.glob()` está disponible en cualquier lugar del proyecto.
- No quieres cargar cada archivo inmediatamente. `import.meta.glob()` puede devolver funciones que importen el contenido del archivo, en lugar de devolver el contenido en sí mismo. Ten en cuenta que esta importación incluye todos los estilos y scripts para cualquier archivo importado. Estos se agruparán y se agregarán a la página, independientemente de si el archivo se utiliza o no, ya que esto se decide por análisis estático, no en tiempo de ejecución.
- Quieres acceder a cada archivo `src/pages/post/*.md`. `import.meta.glob()` no puede acceder a archivos que coincidan con una ruta de archivo especificada, como `src/pages/index.astro`.
- Quieres pasar varios patrones; por ejemplo, quieres agregar un "negación" de patrones que filtre por nombres. `import.meta.glob()` no puede permitirlo, ya que no es posible determinar si un archivo coincide con un patrón determinado.

Consulta la [documentación de Vite](https://vite.dev/guide/features.html#glob-import).
:::

##### Archivos Markdown

Los archivos Markdown cargados con `Astro.glob()` devuelven la siguiente interfaz `MarkdownInstance`:

```ts
export interface MarkdownInstance<T extends Record<string, any>> {
  /* Cualquier dato especificado en el encabezado YAML/TOML de este archivo */
	frontmatter: T;
  /* La ruta absoluta del archivo */
	file: string;
  /* La ruta renderizada de este archivo */
	url: string | undefined;
  /* Componente de Astro que representa el contenido de este archivo */
	Content: AstroComponentFactory;
  /** (Solo Markdown) Contenido del archivo Markdown sin formato, excluyendo el diseño HTML y el frontmatter YAML/TOML */
	rawContent(): string;
  /** (Solo Markdown) Archivo Markdown compilado a HTML, excluyendo el HTML de diseño */
	compiledContent(): string;
  /* Función que devuelve una lista de los elementos h1...h6 de este archivo */
	getHeadings(): Promise<{ depth: number; slug: string; text: string }[]>;
	default: AstroComponentFactory;
}
```

Puedes proporcionar un tipo para la variable `frontmatter` usando un tipo genérico de TypeScript.

```astro
---
interface Frontmatter {
  title: string;
  description?: string;
}
const posts = await Astro.glob<Frontmatter>('../pages/post/*.md');
---

<ul>
  {posts.map(post => <li>{post.frontmatter.title}</li>)}
</ul>
```

##### Archivos de Astro

Los archivos de Astro tienen la siguiente interfaz:

```ts
export interface AstroInstance {
  /* La ruta del archivo */
  file: string;
  /* La URL para este archivo (si está en la carpeta pages) */
	url: string | undefined;
	default: AstroComponentFactory;
}
```

##### Otros archivos

Otros archivos pueden tener diferentes interfaces, pero `Astro.glob()` acepta un genérico TypeScript si sabes exactamente qué contiene un tipo de archivo no reconocido.

```ts
---
interface CustomDataFile {
  default: Record<string, any>;
}
const data = await Astro.glob<CustomDataFile>('../data/**/*.js');
---
```
