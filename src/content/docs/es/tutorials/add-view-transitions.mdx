---
title: Tutorial - Ampliar con View Transitions
description: >-
  A침ade View Transitions al c칩digo del tutorial Crear un Blog
i18nReady: true
---
import PackageManagerTabs from '~/components/tabs/PackageManagerTabs.astro';
import Box from '~/components/tutorial/Box.astro';
import MultipleChoice from '~/components/tutorial/MultipleChoice.astro';
import Option from '~/components/tutorial/Option.astro';
import Spoiler from '~/components/Spoiler.astro';
import PreCheck from '~/components/tutorial/PreCheck.astro';

Las **View transitions** son una forma de controlar lo que sucede cuando los visitantes navegan entre p치ginas en tu sitio. La API de View Transitions de Astro te permite agregar funciones opcionales de navegaci칩n, como transiciones suaves entre p치ginas y animaciones, controlar la pila de historial del navegador de las p치ginas visitadas y evitar actualizaciones completas de la p치gina para persistir algunos elementos y el estado de la p치gina mientras se actualiza el contenido mostrado.

<PreCheck>
  - Importar y a침adir el enrutador `<ViewTransitions />` a un elemento `head` com칰n
  - Agregar listeners de eventos durante el proceso de navegaci칩n para activar `<script>` seg칰n sea necesario
  - A침adir animaciones de transici칩n de p치gina utilizando directivas de transici칩n
  - Excluir la navegaci칩n del lado del cliente para un enlace de p치gina individual
</PreCheck>

## Prerrequisitos

Necesitar치s **un proyecto de Astro existente con una plantilla de base com칰n o un componente `<Head />`**.

Este tutorial utiliza el [proyecto terminado del tutorial Crear un Blog](https://github.com/withastro/blog-tutorial-demo) para demostrar c칩mo agregar view transitions (navegaci칩n del lado del cliente) a un proyecto de Astro existente. Puedes hacer un fork y usar esa base de c칩digo localmente, o completar el tutorial en el navegador [editando el c칩digo del tutorial del blog en StackBlitz](https://stackblitz.com/github/withastro/blog-tutorial-demo/tree/complete?file=src%2Fpages%2Findex.astro).

En su lugar, puedes seguir estos pasos con tu propio proyecto de Astro, pero deber치s ajustar las instrucciones para tu base de c칩digo.

Recomendamos utilizar nuestro proyecto de ejemplo para completar este breve tutorial primero. Luego, puedes aplicar lo que has aprendido para crear view transitions en tu propio proyecto.

## C칩digo del Tutorial Crear un Blog

En el [tutorial introductorio Crear un Blog](/es/tutorial/0-introduction/), aprendiste sobre la [navegaci칩n incorporada basada en archivos](/es/core-concepts/routing/#rutas-est치ticas) de Astro: cualquier archivo `.astro`, `.md` o `.mdx` en cualquier lugar dentro de la carpeta `src/pages/` se convert칤a autom치ticamente en una nueva p치gina en tu sitio.

Para navegar entre estas p치ginas, utilizaste el elemento HTML est치ndar `<a>`. Por ejemplo, para crear un enlace a tu p치gina "Acerca de", agregaste `<a href="/about/">Acerca de</a>` en la cabecera de tu p치gina. Cuando un visitante de tu sitio hac칤a clic en ese enlace, el navegador se actualizaba y cargaba una nueva p치gina con contenido completamente nuevo.

## Navegaci칩n de p치gina completa vs. enrutamiento del lado del cliente (modo SPA)

Cuando un navegador se actualiza y carga una nueva p치gina, no hay continuidad entre la p치gina antigua y la nueva. Durante el enrutamiento del lado del cliente, se muestra una nueva p치gina sin una actualizaci칩n completa del navegador.

El enrutamiento del lado del cliente es una caracter칤stica de los sitios de aplicaciones de una sola p치gina (SPA), donde todo el sitio o aplicaci칩n es "una p치gina" de JavaScript cuyo contenido se actualiza en funci칩n de la interacci칩n del visitante.

Debido a que cada nueva p치gina no requiere una actualizaci칩n completa del navegador, el enrutamiento del lado del cliente te permite controlar las transiciones de p치gina de varias maneras. Los **elementos persistentes**, como un encabezado com칰n de la p치gina, no tienen que ser completamente vuelto a renderizar en la pantalla. La transici칩n de una p치gina a otra puede parecer mucho m치s fluida. Adem치s, el estado puede conservarse, 춰lo que te permite transferir valores de una p치gina a la siguiente o incluso mantener un video reproduci칠ndose mientras tus visitantes navegan por las p치ginas!
 
Hay momentos en los que querr치s o necesitar치s una actualizaci칩n completa del navegador. Por ejemplo, cuando un enlace lleva a un visitante a un documento `.pdf`, necesitar치s que el navegador cargue esa nueva p치gina desde el servidor. Incluso con las view transitions habilitadas en tu proyecto de Astro, podr치s especificar c칩mo deber칤a navegar el navegador tanto de forma predeterminada como de forma espec칤fica para cada enlace, incluso eligiendo no utilizar enrutamiento del lado del cliente en absoluto.

Lee m치s sobre las [view transitions de Astro](/es/guides/view-transitions/) en nuestra gu칤a, o comienza con las instrucciones a continuaci칩n para convertir un blog b치sico de `src/pages/posts/` a `src/content/posts/`.

<Box icon="question-mark">
### Pon a prueba tus conocimientos

1. A침adiendo view transitions a mi sitio de Astro...

    <MultipleChoice>
      <Option>
        Requiere m치s de 2 l칤neas de c칩digo para implementarse en todo el sitio de forma predeterminada
      </Option>
      <Option isCorrect>
        Cambia el tipo predeterminado de navegaci칩n de p치gina en una p치gina que contiene el enrutador `<ViewTransitions />` en su `<head>`
      </Option>
      <Option>
        No agrega de vuelta las caracter칤sticas de accesibilidad normalmente proporcionadas por el navegador, como el anuncio de ruta y el respeto a `prefers-reduced-motion`
      </Option>
    </MultipleChoice>

2. 쮺u치l **no** es un beneficio de las view transitions de Astro?

    <MultipleChoice>
      <Option isCorrect>
         Enviar un poco de JavaScript adicional al navegador para el enrutamiento del lado del cliente
      </Option>
      <Option>
        La opci칩n de persistir elementos y componentes individuales mientras un visitante accede a una nueva p치gina
      </Option>
      <Option>
        Controlar qu칠 tipo de navegaci칩n utilizar de manera espec칤fica para cada enlace
      </Option>
    </MultipleChoice>

3. El enrutador de las view transitions...
    <MultipleChoice>
      <Option>
        Requiere que utilice un framework UI como React
      </Option>
      <Option>
        No est치 listo para sitios de producci칩n
      </Option>
      <Option isCorrect>
        Incluye un comportamiento de respaldo para navegadores que a칰n no admiten completamente las view transitions
      </Option>
    </MultipleChoice>

</Box>

## Ampliando el tutorial del blog con view transitions

Los pasos a continuaci칩n te muestran c칩mo ampliar el producto final del tutorial "Crear un Blog" al agregar enrutamiento del lado del cliente para mejorar las view transitions.

### Actualizar dependencias

1. Actualiza a la 칰ltima versi칩n de Astro y todas las integraciones a sus versiones m치s recientes ejecutando los siguientes comandos en tu terminal:

    <PackageManagerTabs>
      <Fragment slot="npm">
      ```shell
      # Actualizar a Astro v3.x
      npm install astro@latest

      # Ejemplo: actualizar la integraci칩n de Preact en el tutorial del blog
      npm install @astrojs/preact@latest
      ```
      </Fragment>
      <Fragment slot="pnpm">
      ```shell
      # Actualizar a Astro v3.x
      pnpm install astro@latest

     # Ejemplo: actualizar la integraci칩n de Preact en el tutorial del blog
      pnpm install @astrojs/preact@latest
      ```
      </Fragment>
      <Fragment slot="yarn">
      ```shell
      # Actualizar a Astro v3.x
      yarn add astro@latest

      # Ejemplo: actualizar la integraci칩n de Preact en el tutorial del blog
      yarn add @astrojs/preact@latest
      ```
      </Fragment>
    </PackageManagerTabs>

    :::tip
    Si est치s utilizando tu propio proyecto, aseg칰rate de actualizar cualquier dependencia que hayas instalado. La base de c칩digo del tutorial de ejemplo del blog solo utiliza la integraci칩n de Preact.
    :::

### A침ade el enrutador `<ViewTransitions />`

2. Importa y a침ade el componente `<ViewTransitions />` al `<head>` de la plantilla de tu p치gina.

    En el ejemplo del tutorial del blog, el elemento `<head>` se encuentra en `src/layouts/BaseLayout.astro`. Primero, el enrutador `ViewTransitions` debe importarse en el frontmatter del componente. Luego, agrega el componente de enrutamiento dentro del elemento `<head>`.

    ```astro title="src/layouts/BaseLayout.astro" ins={2,15}
    ---
    import { ViewTransitions } from 'astro:transitions';
    import Header from "../components/Header.astro";
    import Footer from "../components/Footer.astro";
    import "../styles/global.css";
    const { pageTitle } = Astro.props;
    ---
    <html lang="en">
      <head>
        <meta charset="utf-8" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <meta name="viewport" content="width=device-width" />
        <meta name="generator" content={Astro.generator} />
        <title>{pageTitle}</title>
        <ViewTransitions />
      </head>
      <body>
        <Header />
        <h1>{pageTitle}</h1>
        <slot />
        <Footer />
        <script>
          import "../scripts/menu.js";
        </script>
      </body>
    </html>
    ```

    춰No es necesaria ninguna otra configuraci칩n para habilitar la navegaci칩n predeterminada del lado del cliente de Astro! Astro crear치 animaciones de p치gina predeterminadas basadas en las similitudes entre la p치gina antigua y la nueva, y tambi칠n proporcionar치 un comportamiento de respaldo para navegadores no compatibles.

3. Navega entre p치ginas en la vista previa de tu sitio.

    Mira la vista previa de tu sitio **en una pantalla grande, como en modo escritorio**. Mientras te desplazas entre p치ginas en tu sitio, observa que el contenido de la p치gina anterior parece desvanecerse a medida que el contenido de la nueva p치gina se desvanece. Utiliza la [gu칤a de view transitions](/es/guides/view-transitions/) para agregar un comportamiento personalizado si no est치s satisfecho con las configuraciones predeterminadas.

    Mira la vista previa de tu sitio **en una pantalla m치s peque침a** y trata de utilizar el men칰 desplegable para navegar entre p치ginas. Observa que el men칰 dejar치 de funcionar despu칠s de cargar la primera p치gina.

### Actualiza los scripts

Con las view transitions, algunos scripts pueden dejar de ejecutarse despu칠s de la navegaci칩n de p치gina, a diferencia de lo que ocurre con las actualizaciones completas del navegador. Hay dos eventos durante la navegaci칩n del lado del cliente a los que puedes escuchar y disparar eventos cuando ocurren: [`astro:page-load`](/es/guides/view-transitions/#astropage-load) y [`astro:after-swap`](/es/guides/view-transitions/#astroafter-swap).

4. Haz que el script que controla el componente del men칰 m칩vil `<Hamburger />` est칠 disponible despu칠s de navegar a una nueva p치gina.

     Para hacer que tu men칰 m칩vil sea interactivo despu칠s de navegar a una nueva p치gina, agrega el siguiente c칩digo que escucha el evento `astro:page-load`, el cual se ejecuta al finalizar la navegaci칩n de la p치gina, y en respuesta, ejecuta el script existente para que el men칰 desplegable funcione al hacer clic:

    ```js title="src/scripts/menu.js" ins={1,5}
    document.addEventListener('astro:page-load', () => {
      document.querySelector('.hamburger').addEventListener('click', () => {
        document.querySelector('.nav-links').classList.toggle('expanded');
      });
    });
    ```

5. Haz que el script que controla la alternancia de temas est칠 disponible despu칠s de la navegaci칩n de la p치gina.

    El `<script>` que controla la alternancia de tema claro/oscuro se encuentra en el componente `<ThemeIcon />`. Para que la alternancia de tema siga funcionando en todas las p치ginas, elimina el atributo `is:inline` del script y agrega el mismo escuchador de eventos que en el ejemplo anterior, de modo que el evento `astro:page-load` pueda activar tu funci칩n existente.

    Actualiza la etiqueta de script existente para que tu funci칩n se ejecute en respuesta al evento `astro:page-load`, haciendo que la alternancia de tu tema sea interactiva despu칠s de que la nueva p치gina est칠 completamente cargada y visible para el usuario.

    ```astro title="src/components/ThemeIcon.astro" ins={8,38} del="is:inline"
    ---
    ---
    <button id="themeToggle"> /* ... */ </button>

    <style> /* ... */ </style>

    <script is:inline>
      document.addEventListener('astro:page-load', () => {
        const theme = (() => {
          if (typeof localStorage !== "undefined" && localStorage.getItem("theme")) {
            return localStorage.getItem("theme");
          }
          if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
            return "dark";
          }
          return "light";
        })();

        if (theme === "light") {
          document.documentElement.classList.remove("dark");
        } else {
          document.documentElement.classList.add("dark");
        }

        window.localStorage.setItem("theme", theme);

        const handleToggleClick = () => {
          const element = document.documentElement;
          element.classList.toggle("dark");

          const isDark = element.classList.contains("dark");
          localStorage.setItem("theme", isDark ? "dark" : "light");
        };

        document
          .getElementById("themeToggle")
          .addEventListener("click", handleToggleClick);
      });
    </script>
    ```
    Ahora, el alternador de temas es interactivo en cada p치gina al utilizar el enrutador `<ViewTransitions />`, despu칠s de que la p치gina ha terminado de cargarse.

6. Verifica el tema antes para evitar destellos en el modo oscuro.

    La alternancia de temas funciona en cada p치gina, pero su script se carga al final del proceso de navegaci칩n, **despu칠s de que la nueva p치gina se ha cargado completamente en el navegador**. Puede ocurrir un destello de la versi칩n de tema claro del sitio antes de que se ejecute este script de alternancia de temas y verifique qu칠 tema debe usar en la p치gina.

    Para verificar y, si es necesario, establecer el modo oscuro m치s temprano en el proceso de navegaci칩n, crea una funci칩n que se ejecutar치 en respuesta al evento `astro:after-swap`. La siguiente funci칩n para verificar el tema oscuro en el `localStorage` del navegador se ejecutar치 **inmediatamente despu칠s de que la nueva p치gina haya reemplazado a la antigua**, antes de que los elementos del DOM se pinten en la pantalla.

    A침ade este nuevo script al componente `<ThemeIcon />`, adem치s del script que controla la alternancia de temas.

    ```astro title="src/components/ThemeIcon.astro" ins={3-9}
    <script> ... <script>

    <script>
      document.addEventListener('astro:after-swap', () => {
        localStorage.theme === 'dark' 
        ? document.documentElement.classList.add("dark")
        : document.documentElement.classList.add("light");
      }); 
    </script>
    ```

    Ahora, cada cambio de p치gina **que utilice el enrutador `<ViewTransitions />` para la navegaci칩n del lado del cliente** (y por lo tanto, tenga acceso al evento `astro:after-swap`) podr치 detectar `theme: dark` desde el `localStorage` del navegador y actualizar la p치gina actual en consecuencia antes de que se renderice para el espectador.

    <Box icon="question-mark">
      ### Pon a prueba tus conocimientos

      쮺u치l es el orden correcto de los eventos despu칠s de que un visitante hace clic en un enlace para ir a una nueva p치gina durante la navegaci칩n del lado del cliente?

          <MultipleChoice>
            <Option>
              1. `astro:after-swap`
              2. `astro:page-load`
              3. la nueva p치gina es visible
            </Option>
            <Option isCorrect>
              1. `astro:after-swap`
              2. la nueva p치gina es visible
              3. `astro:page-load`
            </Option>
            <Option>
              1. `astro:page-load`
              2. la nueva p치gina es visible
              3. `astro:after-swap`
            </Option>
          </MultipleChoice>


      </Box>

### Personaliza las animaciones de transici칩n

7. Cambia la animaci칩n predeterminada de `fade` a `slide` para el t칤tulo de la p치gina.

    Con las view transitions habilitadas, actualmente tienes una peque침a transici칩n de desvanecimiento configurada para todas las animaciones de transici칩n de p치gina. Astro tambi칠n proporciona una animaci칩n incorporada llamada `slide`. Para cambiar el tipo de animaci칩n para un solo elemento, agrega la directiva `transition:animation=""`.

    Por ejemplo, para hacer que los t칤tulos de las p치ginas se deslicen en lugar de desvanecerse, agrega `transition:animate="slide"` al elemento `<h1>` en el BaseLayout:

    ```astro title="src/layouts/BaseLayout.astro" ins='transition:animate="slide"'
    ---
    import Header from "../components/Header.astro";
    import Footer from "../components/Footer.astro";
    import "../styles/global.css";
    import { ViewTransitions } from 'astro:transitions';
    const { pageTitle } = Astro.props;
    ---

    <html lang="en">
      <head>
        <meta charset="utf-8" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <meta name="viewport" content="width=device-width" />
        <meta name="generator" content={Astro.generator} />
        <title>{pageTitle}</title>
        <ViewTransitions />
      </head>
      <body>
        <Header />
        <h1 transition:animate="slide">{pageTitle}</h1>
        <slot />
        <Footer />
        <script>
          import "../scripts/menu.js";
        </script>
      </body>
    </html>
    ```

    En la vista previa de tu navegador, ahora ver치s que los t칤tulos de las p치ginas se deslizan en la pantalla, mientras que otros elementos como el texto del cuerpo contin칰an desvaneci칠ndose.

    <Box icon="puzzle-piece">
      ### Int칠ntalo t칰 mismo: Haz que los enlaces de navegaci칩n se deslicen.

      A침ade una directiva de animaci칩n para que el `<div>` en `Navigation.astro`, que contiene todos los enlaces del encabezado, se deslice al navegar por la p치gina, siguiendo los [mismos pasos mencionados anteriormente](#personaliza-las-animaciones-de-transici칩n).

      <details>
      <summary>Mu칠strame el c칩digo.</summary>
      ```astro title="src/components/Navigation.astro" ins='transition:animate="slide"'
      ---
      ---
      <div transition:animate="slide" class="nav-links">
        <a href="/">Inicio</a>
        <a href="/about/">Acerca de</a>
        <a href="/blog/">Blog</a>
        <a href="/tags/" >Etiquetas</a>
      </div>
      ```
      </details>
    </Box>

    Verifica la vista previa de tu navegador y ahora tanto el t칤tulo de la p치gina como los enlaces del encabezado se deslizar치n en cada navegaci칩n de p치gina.

8. A침ade una transici칩n de desvanecimiento m치s larga a las descripciones de tus publicaciones en el blog.

    Tambi칠n puedes personalizar las animaciones integradas en Astro import치ndolas y luego proporcionando cualquier propiedad de animaci칩n CSS.

    Por ejemplo, para hacer que la descripci칩n aparezca lentamente cuando navegas a una entrada de blog, importa la animaci칩n `fade` en tu plantilla para las entradas de blog en formato Markdown. Luego, agrega la directiva de transici칩n para el `fade` de Astro con una duraci칩n de `2s`:

    ```astro title="src/layouts/MarkdownPostLayout.astro" ins={3} ins="transition:animate={fade({ duration: '2s' })}"
    ---
    import BaseLayout from "./BaseLayout.astro";
    import { fade } from 'astro:transitions';
    const { frontmatter } = Astro.props;
    ---

    <BaseLayout pageTitle={frontmatter.title}>
      <p>{frontmatter.pubDate.slice(0, 10)}</p>
      <p transition:animate={fade({ duration: '2s' })} ><em>{frontmatter.description}</em></p>
      <p>Escrito por: {frontmatter.author}</p>
      <img src={frontmatter.image.url} width="300" alt={frontmatter.image.alt} />
      <slot />
    </BaseLayout>
    ```
    Navega a cualquier entrada de blog en la vista previa de tu navegador y ver치s que la descripci칩n aparece con una transici칩n m치s lenta que el resto del texto.

    游닄 Lee m치s acerca de las diferentes [directivas de transici칩n](/es/guides/view-transitions/#directivas-de-transici칩n) y la [personalizaci칩n de animaciones](/es/guides/view-transitions/#personalizando-animaciones).

### Fuerza una recarga completa del navegador para algunos enlaces

9. Evita el enrutamiento del lado del cliente y en su lugar exige al navegador que recargue cuando navegue a tu p치gina Acerca de.

    En ocasiones, querr치s que se realice una recarga completa del navegador cuando los visitantes hagan clic en ciertos enlaces. Por ejemplo, puede que est칠s vinculando a una p치gina que no utiliza el enrutador `<ViewTransitions />`, o a un archivo directamente, como un archivo `.pdf`.

    Para lograr que tu navegador se actualice cada vez que hagas clic en el enlace de navegaci칩n para ir a tu p치gina Acerca de, agrega el atributo `data-astro-reload` a la etiqueta `<a>` en tu componente `<Navigation/>`. Esto anular치 completamente el enrutador `<ViewTransitions />` y cualquier animaci칩n de las view transitions para este enlace en particular.

     ```astro title="src/components/Navigation.astro" ins='data-astro-reload'
      ---
      ---
      <div transition:animate="slide" class="nav-links">
        <a href="/">Inicio</a>
        <a href="/about/" data-astro-reload >Acerca de</a>
        <a href="/blog/">Blog</a>
        <a href="/tags/">Etiquetas</a>
      </div>
      ```

    Ahora, cuando hagas clic en el enlace de navegaci칩n hacia tu p치gina Acerca de, no se producir치n animaciones. Los enlaces y el t칤tulo de la p치gina no se deslizar치n y el contenido de la p치gina no se desvanecer치 al navegar a tu p치gina Acerca de **usando este enlace**.

10. A침ade un enlace a tu p치gina Acerca de desde tu nombre de autor en tu plantilla Markdown para las entradas del blog.

    `data-astro-reload` solo provoca una actualizaci칩n completa del navegador al ir a una nueva p치gina **desde el enlace al que se ha a침adido**. No controla todas las instancias de navegaci칩n a tu p치gina Acerca de.

    En tu compoente `<MarkdownPostLayout />`, agrega un enlace a tu p치gina Acerca de en tu nombre de autor:

    ```astro title="src/layouts/MarkdownPostLayout.astro" ins='<a href="/about/">' ins="</a>"
    ---
    import BaseLayout from "./BaseLayout.astro";
    import { fade } from 'astro:transitions';
    const { frontmatter } = Astro.props;
    ---

    <BaseLayout pageTitle={frontmatter.title}>
      <p>{frontmatter.pubDate.slice(0, 10)}</p>
      <p transition:animate={fade({ duration: '2s' })} ><em>{frontmatter.description}</em></p>
      <p>Escrito por: <a href="/about/">{frontmatter.author}</a></p>
      <img src={frontmatter.image.url} width="300" alt={frontmatter.image.alt} />
      <slot />
    </BaseLayout>
    ```

    Si visitas cualquier entrada de blog en la vista previa del navegador y luego haces clic en el nombre del autor vinculado para ir a la p치gina Acerca de, 쯖칩mo se ve la navegaci칩n de la p치gina?

    <p>
      Cuando un visitante hace clic en un enlace a la p치gina Acerca de desde una entrada de blog individual, el t칤tulo de la p치gina y los enlaces de navegaci칩n en la cabecera <Spoiler>se deslizan en la pantalla</Spoiler> porque <Spoiler>el atributo `data-astro-reload` no est치 configurado en estos enlaces</Spoiler>
    </p>

춰Todav칤a hay mucho m치s por explorar! Consulta nuestra [Gu칤a completa de View Transitions](/es/guides/view-transitions/) para descubrir m치s cosas que puedes hacer con las view transitions.

Para ver el ejemplo completo del tutorial de blog que utiliza view transitions, visita la [rama View Transitions](https://github.com/withastro/blog-tutorial-demo/tree/view-transitions) en el repositorio del tutorial.