---
title: Umbraco & Astro
description: A침ade contenido a tu proyecto Astro usando Umbraco como CMS
sidebar:
  label: Umbraco
type: cms
stub: false
service: Umbraco
i18nReady: true
---
import { FileTree, Steps } from '@astrojs/starlight/components';
import ReadMore from '~/components/ReadMore.astro'; 


[Umbraco CMS](https://umbraco.com/) es un CMS de c칩digo abierto basado en ASP.NET Core. Por defecto, Umbraco utiliza p치ginas Razor para su front-end, pero puede usarse como un CMS headless.

## Integraci칩n con Astro

En esta secci칩n usar치s la [API de Entrega de Contenido](https://docs.umbraco.com/umbraco-cms/reference/content-delivery-api) nativa de Umbraco para proporcionar contenido a tu proyecto Astro.

### Prerrequisitos

Para empezar, necesitar치s tener lo siguiente:

1. **Un proyecto Astro** - Si a칰n no tienes un proyecto Astro, nuestra [gu칤a de instalaci칩n](/es/install-and-setup/) te ayudar치 a comenzar en poco tiempo.
2. **Un proyecto Umbraco (v12+)** - Si a칰n no tienes un proyecto Umbraco, consulta esta [gu칤a de instalaci칩n](https://docs.umbraco.com/umbraco-cms/fundamentals/setup/install/).

### Configuraci칩n de la API de Entrega de Contenido

Para habilitar la API de Entrega de Contenido, actualiza el archivo `appsettings.json` de tu proyecto Umbraco:

```json title="appsettings.json"
{
  "Umbraco": {
    "CMS": {
      "DeliveryApi": {
        "Enabled": true,
        "PublicAccess": true
      }
    }
  }
}
```

Puedes configurar opciones adicionales seg칰n sea necesario, como acceso p칰blico, claves API, tipos de contenido permitidos, autorizaci칩n de membres칤a y m치s. Consulta la [documentaci칩n de la API de Entrega de Contenido de Umbraco](https://docs.umbraco.com/umbraco-cms/reference/content-delivery-api) para m치s informaci칩n.

### Obtenci칩n de Datos

Usa una llamada `fetch()` a la API de Entrega de Contenido para acceder a tu contenido y hacerlo disponible para tus componentes Astro.

El siguiente ejemplo muestra una lista de art칤culos obtenidos, incluyendo propiedades como la fecha del art칤culo y el contenido.

```astro title="src/pages/index.astro"
---
const res = await fetch('http://localhost/umbraco/delivery/api/v2/content?filter=contentType:article');
const articles = await res.json();
---
<h1>Astro + Umbraco 游</h1>
{
  articles.items.map((article) => (
      <h1>{article.name}</h1>
      <p>{article.properties.articleDate}</p>
      <div set:html={article.properties.content?.markup}></div>
  ))
}
```


<ReadMore>Lee m치s sobre [obtenci칩n de datos en Astro](/es/guides/data-fetching/).</ReadMore>

## Creaci칩n de un blog con Umbraco y Astro

### Prerrequisitos

- **Un proyecto Astro** - Si a칰n no tienes un proyecto Astro, nuestra [gu칤a de instalaci칩n](/es/install-and-setup/) te ayudar치 a comenzar en poco tiempo.

- **Un proyecto Umbraco (v12+)** con la API de Entrega de Contenido habilitada - Sigue esta [gu칤a de instalaci칩n](https://docs.umbraco.com/umbraco-cms/fundamentals/setup/install/) para crear un nuevo proyecto.

### Creaci칩n de entradas de blog en Umbraco

Desde el [backoffice de Umbraco](https://docs.umbraco.com/umbraco-cms/fundamentals/backoffice), crea un Tipo de Documento para un art칤culo de blog simple llamado 'Article'.

<Steps>
1. Configura tu Tipo de Documento 'Article' con las siguientes propiedades:

		- Title (Tipo de Datos: Textstring)
		- Article Date (Tipo de Datos: Date Picker)
		- Content (Tipo de Datos: Richtext Editor)

2. Activa "Allow as root" a `true` en el tipo de documento 'Article'.

3. Desde la secci칩n "Content" en el backoffice de Umbraco, [crea y publica tu primera entrada de blog](https://docs.umbraco.com/umbraco-cms/fundamentals/data/defining-content). Repite el proceso tantas veces como quieras.

</Steps>

Para m치s informaci칩n, mira una [gu칤a en video sobre c칩mo crear Tipos de Documento](https://www.youtube.com/watch?v=otRuIkN80qM).

### Mostrar una lista de entradas de blog en Astro

Crea una carpeta `src/layouts/`, luego a침ade un nuevo archivo `Layout.astro` con el siguiente c칩digo:

```astro title="src/layouts/Layout.astro"
---
---
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Mi Blog con Astro y Umbraco</title>
</head>
<body>
    <main>
        <slot />
    </main>
</body>
</html>
```

Tu proyecto ahora deber칤a contener los siguientes archivos:

<FileTree>
- src/
  - **layouts/**
    - **Layout.astro**
  - pages/
    - index.astro
</FileTree>

Para crear una lista de entradas de blog, primero usa `fetch` para llamar al endpoint `content` de la API de Entrega de Contenido y filtrar por contentType 'article'. Los objetos de art칤culo incluir치n las propiedades y el contenido establecidos en el CMS. Luego puedes recorrer los art칤culos y mostrar cada t칤tulo con un enlace a su art칤culo.

Reemplaza el contenido predeterminado de `index.astro` con el siguiente c칩digo:

```astro title="src/pages/index.astro"
---
import Layout from '../layouts/Layout.astro';
const res = await fetch('http://localhost/umbraco/delivery/api/v2/content?filter=contentType:article');
const articles = await res.json();
---
<Layout>
	<h2>Art칤culos del Blog</h2>
	{
        articles.items.map((article: any) => (
            <div>
                <h3>{article.properties.title}</h3>
                <p>{article.properties.articleDate}</p>
                <a href={article.route.path}>Leer m치s</a>
            </div>
        ))
    }
</Layout>
```

### Generaci칩n de entradas de blog individuales

Crea el archivo `[...slug].astro` en la ra칤z del directorio `/pages/`. Este archivo se utilizar치 para [generar las p치ginas de blog individuales din치micamente](/es/guides/routing/#rutas-din치micas).

Ten en cuenta que la propiedad `params`, que genera la ruta URL de la p치gina, contiene `article.route.path` de la obtenci칩n de la API. De manera similar, la propiedad `props` debe incluir el `article` completo para que puedas acceder a toda la informaci칩n en tu entrada del CMS.

A침ade el siguiente c칩digo a `[...slug].astro` que crear치 tus p치ginas de entradas de blog individuales:

```astro title="[...slug].astro"
---
import Layout from '../layouts/Layout.astro';

export async function getStaticPaths() {
    let data = await fetch("http://localhost/umbraco/delivery/api/v2/content?filter=contentType:article");
    let articles = await data.json();
    
    return articles.items.map((article: any) => ({
        params: { slug: article.route.path },
        props: { article: article },
    }));
}

const { article } = Astro.props;
---

<Layout>
  <h1>{article.properties.title}</h1>
  <p>{article.properties.articleDate}</p>
  <div set:html={article.properties.content?.markup}></div>
</Layout>
```

Tu proyecto ahora deber칤a contener los siguientes archivos:

<FileTree>
- src/
  - layouts/
    - Layout.astro
  - pages/
    - index.astro
    - **[...slug].astro**
</FileTree>

Con el servidor de desarrollo en ejecuci칩n, ahora deber칤as poder ver tu contenido creado en Umbraco en la vista previa de tu navegador de tu proyecto Astro. 춰Felicidades! 游


## Publicaci칩n de tu sitio

Para desplegar tu sitio, visita nuestras [gu칤as de despliegue](/es/guides/deploy/) y sigue las instrucciones para tu proveedor de alojamiento preferido.

## Desarrollo local, HTTPS y certificados SSL autofirmados

Si est치s utilizando el endpoint HTTPS de Umbraco localmente, cualquier consulta `fetch` resultar치 en `fetch failed` con el c칩digo `DEPTH_ZERO_SELF_SIGNED_CERT`. Esto se debe a que Node (sobre el cual est치 construido Astro) no aceptar치 certificados autofirmados por defecto. Para evitar esto, usa el endpoint HTTP de Umbraco para desarrollo local.

Alternativamente, puedes establecer `NODE_TLS_REJECT_UNAUTHORIZED=0` en un archivo `env.development` y actualizar `astro.config.js` como se muestra:

```sh title=".env.development"
NODE_TLS_REJECT_UNAUTHORIZED=0
```

```astro title="astro.config.mjs"
import { defineConfig } from 'astro/config';
import { loadEnv } from "vite";

const { NODE_TLS_REJECT_UNAUTHORIZED } = loadEnv(process.env.NODE_ENV, process.cwd(), "");
process.env.NODE_TLS_REJECT_UNAUTHORIZED = NODE_TLS_REJECT_UNAUTHORIZED;
// https://astro.build/config
export default defineConfig({});
```

Este m칠todo se describe con m치s detalle en esta [publicaci칩n de blog que muestra c칩mo configurar tu proyecto para certificados autofirmados](https://kjac.dev/posts/jamstack-for-free-with-azure-and-cloudflare/), con un [repositorio adjunto](https://github.com/kjac/UmbracoAzureCloudflare).

## Documentaci칩n Oficial
- [API de Entrega de Contenido - Documentaci칩n de Umbraco](https://docs.umbraco.com/umbraco-cms/reference/content-delivery-api)

## Recursos de la Comunidad

- [Sitios web Astro-n칩micamente Eficientes usando la API de Entrega de Contenido - Louis Richardson](https://24days.in/umbraco-cms/2023/sustainable-performant/astronomically-performant/)
- [Generando un cliente OpenAPI TypeScript desde la API de Entrega de Contenido de Umbraco - Rick Butterfield](https://rickbutterfield.dev/blog/typescript-openapi-umbraco-content-delivery/)
- [Jamstack Gratis Con Azure Y CloudFlare - Kenn Jacobsen](https://kjac.dev/posts/jamstack-for-free-with-azure-and-cloudflare/)
- [Blog r치pido y sencillo con Astro y Umbraco - Kenn Jacobsen](https://kjac.dev/posts/quick-n-dirty-blog-with-astro-and-umbraco/)
- [Charla: Hornear, No Fre칤r - Astro y La API de Entrega de Contenido - Adam Prendergast](https://www.youtube.com/watch?v=zNxqI25dtx4)
