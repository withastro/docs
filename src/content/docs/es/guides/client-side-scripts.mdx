---
title: Scripts y manejo de eventos
description: C√≥mo agregar interactividad del lado del cliente a los componentes de Astro usando las API de JavaScript nativas del navegador.
i18nReady: true
---
import ReadMore from '~/components/ReadMore.astro'

Puedes enviar JavaScript al navegador y a√±adir funcionalidad a tus componentes de Astro utilizando etiquetas `<script>` en la plantilla del componente.

Los scripts a√±aden interactividad a tu sitio web, como la gesti√≥n de eventos o la actualizaci√≥n din√°mica de contenidos, sin necesidad de utilizar un [framework de UI](/es/guides/framework-components/) como React, Svelte o Vue. Esto evita la sobrecarga que supone enviar el JavaScript del framework y no requiere que conozcas ning√∫n framework adicional para crear un sitio web o una aplicaci√≥n con todas las funciones.

## Scripts del lado del cliente

Los scripts pueden ser usados para agregar event listeners, enviar datos de anal√≠tica, reproducir animaciones y todo lo que JavaScript puede hacer en la web.

Astro mejora autom√°ticamente la etiqueta est√°ndar HTML `<script>` con empaquetado, TypeScript y mucho m√°s. Consulta [c√≥mo procesa Astro los scripts](#procesamiento-de-scripts) para obtener m√°s detalles.

```astro title="src/components/ConfettiButton.astro"
<!-- src/components/ConfettiButton.astro -->
<button data-confetti-button>¬°Celebrar!</button>

<script>
  // Importa desde el paquete de npm.
  import confetti from 'canvas-confetti';

  // Encuentra nuestro componente en la p√°gina.
  const buttons = document.querySelectorAll('[data-confetti-button]');

  // Agrega event listeners para disparar confetti cuando un bot√≥n es clickeado.
  buttons.forEach((button) => {
    button.addEventListener('click', () => confetti());
  });
</script>
```

<ReadMore>Consulta [cu√°ndo no se procesar√°n tus scripts](#scripts-no-procesados) para solucionar problemas relacionados con el comportamiento de los scripts o para aprender a desactivar este procesamiento de forma intencionada.</ReadMore>

## Procesamiento de scripts

De forma predeterminada, Astro procesa las etiquetas `<script>` que no contienen atributos (aparte de `src`) de las siguientes maneras:

- **Compatibilidad con TypeScript:** Todos los scripts son TypeScript de forma predeterminada.
- **Empaquetado de importaciones:** Importa archivos locales o m√≥dulos de npm, que se empaquetaran juntos.
- **Tipo de m√≥dulo:** Los scripts procesados se convierten autom√°ticamente en [`type="module"`](https://developer.mozilla.org/es/docs/Web/JavaScript/Guide/Modules).
- **Deduplicaci√≥n:** Si un componente que contiene un `<script>` se utiliza varias veces en una p√°gina, el script solo se incluir√° una vez.
- **Inline autom√°tico:** Si el script es lo suficientemente peque√±o, Astro lo insertar√° directamente en el HTML para reducir el n√∫mero de solicitudes.

```astro title="src/components/Example.astro"
<script>
  // ¬°Procesado! ¬°Empaquetado! ¬°TypeScript!
  // La importaci√≥n de scripts locales y paquetes de npm funciona.
</script>
```

### Scripts no procesados

Astro no procesar√° una etiqueta `<script>` si tiene alg√∫n atributo distinto de `src`.

Puedes a√±adir la directiva [`is:inline`](/es/reference/directives-reference/#isinline) para excluir intencionadamente el procesamiento de un script.

```astro title="src/components/InlineScript.astro" "is:inline"
<script is:inline>
  // Sin transformar: sin TypeScript y sin resoluci√≥n de importaciones por parte de Astro.
  // Si se utiliza dentro de un componente, este c√≥digo se duplica para cada instancia.
</script>
```

### Incluye archivos de JavaScript en tu p√°gina

Es posible que quieras escribir tus scripts como archivos separados `.js`/`.ts` o necesites referenciar un script externo. Puedes hacerlo referenci√°ndolos en una etiqueta `<script>` con el atributo `src`.

#### Importando scripts locales

**Cu√°ndo usar esto:** Cuando tu script se encuentra dentro de `src/`.

Astro procesar√° estos scripts de acuerdo con las [reglas de procesamiento de scripts](#procesamiento-de-scripts).

```astro title="src/components/LocalScripts.astro"
<!-- ruta relativa al script en `src/scripts/local.js` -->
<script src="../scripts/local.js"></script>

<!-- tambi√©n funciona para archivos TypeScript locales -->
<script src="./script-with-types.ts"></script>
```

#### Cargando scripts externos

**Cuando usar esto:** Cuando tu archivo JavaScript se encuentra dentro de `public/` o en un CDN.

Para cargar scripts fuera del directorio `src/` de tu proyecto, incluye la directiva `is:inline`. Este enfoque omite el procesamiento, agrupaci√≥n y optimizaci√≥n de JavaScript que proporciona Astro cuando importa scripts como se describe anteriormente.

```astro title="src/components/ExternalScripts.astro" "is:inline"
<!-- ruta absoluta a un script en `public/my-script.js` -->
<script is:inline src="/my-script.js"></script>

<!-- URL completa a un script en un servidor remoto -->
<script is:inline src="https://my-analytics.com/script.js"></script>
```

## Patrones comunes de script

### Manejar `onclick` y otros eventos

Algunos frameworks usan una sintaxis especial para manejar eventos como `onClick={...}` (React/Preact) o `@click="..."` (Vue). Astro sigue m√°s de cerca el est√°ndar HTML y no usa una sintaxis especial para eventos.

En su lugar, puedes usar [`addEventListener`](https://developer.mozilla.org/es/docs/Web/API/EventTarget/addEventListener) en una etiqueta `<script>` para manejar interaciones de usuario.

```astro title="src/components/AlertButton.astro"
<button class="alert">¬°Haz Click!</button>

<script>
  // Encuentra todos los botones con la clase `alert` en la p√°gina.
  const buttons = document.querySelectorAll('button.alert');

  // Maneja los clics en cada bot√≥n.
  buttons.forEach((button) => {
    button.addEventListener('click', () => {
      alert('¬°El bot√≥n ha sido clickeado!');
    });
  });
</script>
```

Si tienes m√∫ltiples componentes `<AlertButton />` en una p√°gina, Astro no ejecutar√° el script m√∫ltiples veces. Los scripts son empaquetados y solo incluidos una vez en la p√°gina. Usando `querySelectorAll` asegura que este script agregue el event listener a cada bot√≥n con la clase `alert` en la p√°gina.

### Componentes Web con elementos personalizados

Puedes crear tus propios elementos HTML con comportamiento personalizado usando el est√°ndar de componentes Web. Definir un [elemento personalizado](https://developer.mozilla.org/es/docs/Web/Web_Components/Using_custom_elements) en un componente `.astro` te permite crear componentes interactivos sin necesidad de un framework.

En este ejemplo, definimos un nuevo elemento HTML `<astro-heart>` que rastrea cu√°ntas veces se hace clic en el bot√≥n del coraz√≥n y actualiza el `<span>` con el √∫ltimo conteo.

```astro title="src/components/AstroHeart.astro"
<!-- Envuelve los elementos del componente en nuestro elemento personalizado ‚Äúastro-heart‚Äù. -->
<astro-heart>
  <button aria-label="Heart">üíú</button> √ó <span>0</span>
</astro-heart>

<script>
  // Define el comportamiento para nuestro nuevo tipo de elemento HTML.
  class AstroHeart extends HTMLElement {
    connectedCallback() {
      let count = 0;

      const heartButton = this.querySelector('button');
      const countSpan = this.querySelector('span');

      // Cada vez que el button es clickeado, actualiza el contador.
			heartButton.addEventListener('click', () => {
        count++;
        countSpan.textContent = count.toString();
      });
		}
  }

  // Dile al navegador que use nuestra clase AstroHeart para elementos <astro-heart>.
  customElements.define('astro-heart', AstroHeart);
</script>
```

Hay dos ventajas de usar un elemento personalizado aqui:

1. En lugar de buscar en toda la p√°gina usando `document.querySelector()`, puedes usar `this.querySelector()`, el cual solo busca dentro de la instancia del elemento personalizado. Esto facilita el trabajo solo con los hijos de una instancia del componente a la vez.

2. Aunque un `<script>` solo se ejecuta una vez, el navegador ejecutar√° m√©todo `connectedCallback()` de nuestro elemento cada vez que encuentre `<astro-heart>` en la p√°gina. Esto significa que puedes escribir forma segura c√≥digo para un componente a la vez, incluso si tienes la intenci√≥n de utilizar este componente varias veces en una p√°gina.

<ReadMore>Puedes aprender m√°s sobre elementos personalizaods en [la gu√≠a de Componentes Web Reusables de web.dev](https://web.dev/custom-elements-v1/) y en [la introducci√≥n de MDN a elementos personalizados](https://developer.mozilla.org/es/docs/Web/Web_Components/Using_custom_elements).</ReadMore>

### Pasando variables frontmatter a scripts

En componentes de Astro, el codigo en [el frontmatter](/es/basics/astro-components/#script-de-un-componente) (entre los cercos `---`) se ejecuta en el servidor y no esta disponible en el navegador.

Para pasar variables del lado del servidor a scripts del lado del cliente, gu√°rdalas en [atributos `data-*`](https://developer.mozilla.org/es/docs/Learn/HTML/Howto/Use_data_attributes) en elementos HTML. Los scripts pueden acceder a estos valores utilizando la propiedad `dataset`.

En este componente ejemplo, una propiedad `message` es guardada en un atributo `data-message`, para que el elemento personalizado pueda leer `this.dataset.message` y obtener el valor de la propiedad en el navegador.

```astro title="src/components/AstroGreet.astro" {2} /data-message={.+}/ "this.dataset.message"
---
const { message = '¬°Bienvenido, mundo!' } = Astro.props;
---

<!-- Guarda la propiedad message como un atributo data. -->
<astro-greet data-message={message}>
  <button>¬°Saluda!</button>
</astro-greet>

<script>
  class AstroGreet extends HTMLElement {
    connectedCallback() {
      // Lee el mensaje del atributo data.
      const message = this.dataset.message;
      const button = this.querySelector('button');
      button.addEventListener('click', () => {
        alert(message);
      });
		}
  }

  customElements.define('astro-greet', AstroGreet);
</script>
```
Ahora podemos usar nuestro componente m√∫ltiples veces y ser saludados con un mensaje diferente por cada uno.

```astro title="src/pages/example.astro"
---
import AstroGreet from '../components/AstroGreet.astro';
---

<!-- Usa el mensaje por defecto: ‚Äú¬°Bienvenido, mundo!‚Äù -->
<AstroGreet />

<!-- Usa mensajes personalizados pasados como propiedades. -->
<AstroGreet message="¬°Es un lindo d√≠a para dise√±ar componentes!" />
<AstroGreet message="¬°Me alegro de que lo lograras! üëã" />
```

:::tip[¬øSab√≠as que?]
¬°Esto es lo que realmente hace Astro detr√°s de escenas cuando pasas propiedades a un componente escrito usando un framework de UI como React! Para componentes con una directiva `client:*`, Astro crea un elemento personalizado `<astro-island>` con un atributo `props` que guarda tus propiedades del servidor en la salida HTML.
:::

### Combinando scripts y frameworks de UI

Es posible que los elementos renderizados por un framework de UI a√∫n no est√©n disponibles cuando se ejecuta una etiqueta `<script>`. Si tu script tambi√©n necesita gestionar [componentes de un framework de UI](/es/guides/framework-components/), se recomienda utilizar un elemento personalizado.
